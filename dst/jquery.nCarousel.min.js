/*!
  
  jquery.nCarousel.js
  
  Version: 0.1.0
  Author: Nunifuchisaka(nunifuchisaka@gmail.com)
  Website: http://nunifuchisaka.com/w/n-carousel/demo
  Repository: https://github.com/Nunifuchisaka/nCarousel
  
*/
!function(t,i,s,e){"use strict";function h(t){var i=t.pageX?t.pageX:t.originalEvent.touches[0].pageX,s=t.pageY?t.pageY:t.originalEvent.touches[0].pageY;return i=Math.floor(i),s=Math.floor(s),{x:i,y:s}}function r(s){var e=this;this.opts=t.extend({duration:400,easing:"swing",thumbnail:!1,surplus:1,interval:0,swipe:!0,draggable:!0,touchThresholdMagnification:10},s),this.backup={},this.lock=!1,this.activeResponsive=!1,this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1,this.touchThreshold=0,this.$window=t(i),this.$el=t(s.el),this.backup.html=this.$el.html(),this.$el.empty(),this.$parent=this.$el.parent(),this.$el.on("click",".nCarousel__prev",function(){return e.animation(e.current-1),!1}).on("click",".nCarousel__next",function(){return e.animation(e.current+1),!1}),this.maxWidth=parseInt(this.$el.css("max-width")),this.init(),this.windowResize(),this.resizeTimer=!1,this.$window.resize(function(){e.resizeTimer!==!1&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(t.proxy(e.windowResize,e),100)}),0<this.opts.interval&&(this.ticker=setInterval(function(){e.animation(e.current+1)},this.opts.interval))}t.fn.nCarousel=function(i){return this.each(function(s,e){var h=t.extend({i:s,el:e},i);new r(h)})},r.prototype.setTouchThreshold=function(){return this.opts.swipe||this.opts.draggable?void(this.touchThreshold=this.$item.outerWidth(!1)*(this.opts.touchThresholdMagnification/100)):!1},r.prototype.windowResize=function(){if(this.windowWidth=this.$window.width(),this.maxWidth<this.$window.width())return void(this.activeResponsive&&(this.activeResponsive=!1,this.resetItemWidth("auto")));this.activeResponsive=!0,this.resetItemWidth(this.$viewport.width())},r.prototype.resetItemWidth=function(t){this.$_item.width(t),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.$items.css({marginLeft:-1*this.opts.surplus*this.itemWidth*this.current+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth}),this.setTouchThreshold()},r.prototype.init=function(){var t=this;this.$el.addClass("nCarousel"),this.$el.html('<div class="nCarousel__viewport">'+this.backup.html+"</div>"),this.$viewport=this.$el.children(".nCarousel__viewport"),this.$items=this.$viewport.children(),this.$item=this.$items.children(),this.$item.addClass("nCarousel__item"),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.marginCorrect=-1*parseInt(this.$item.css("margin-left")),this.$items.css({marginLeft:-1*this.opts.surplus*this.itemsWidth+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth});for(var i=0;i<2*this.opts.surplus;i++)this.$items.append(this.$item.clone());this.$_item=this.$items.children(),this.current=this.$item.length*this.opts.surplus,this.$el.addClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),this.$viewport.append('<div class="nCarousel__arrow nCarousel__prev"></div><div class="nCarousel__arrow nCarousel__next"></div>'),this.$prev=this.$viewport.children(".nCarousel__prev"),this.$next=this.$viewport.children(".nCarousel__next"),this.arrowVisibilities();for(var s='<div class="nCarousel__pointers">',i=0;i<this.$item.length;i++)s+=this.opts.thumbnail?'<div class="nCarousel__pointer is-thumbnail">'+this.$item.eq(i).html()+"</div>":'<div class="nCarousel__pointer"></div>';s+="</div>",this.$el.append(s),this.$pointer=this.$el.find(".nCarousel__pointer"),this.$pointer.eq(0).addClass("is-active"),this.$el.on("click",".nCarousel__pointer",function(i){var s=t.$pointer.index(this),e=s+t.$item.length*t.opts.surplus;return t.animation(e),!1}),this.setTouchThreshold(),this.setSwipeEvent()},r.prototype.animation=function(t){if(this.lock)return!1;var i=this,s=!0,e=this.opts.duration,h=this.opts.easing;return this.lock=!0,0===this.opts.surplus&&(0>t||this.$item.length-1<t)&&(s=!1),this.$el.removeClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),s?(this.current=t,i.current<i.$item.length*i.opts.surplus?i.current+=i.$item.length:i.current>=i.$item.length*(i.opts.surplus+1)&&(i.current-=i.$item.length)):(0>t?t=0:this.$item.length-1<t&&(t=this.$item.length-1),h="linear"),this.$el.addClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),i.pointerActive(),this.$items.stop(!0,!1).animate({marginLeft:i.itemWidth*t*-1+this.marginCorrect},e,h,function(){i.$items.css("marginLeft",i.itemWidth*i.current*-1+i.marginCorrect),i.lock=!1}),this.arrowVisibilities(),s},r.prototype.arrowVisibilities=function(){0===this.opts.surplus&&(0==this.current?this.$prev.css("display","none"):this.$prev.css("display","block"),this.current==this.$item.length-1?this.$next.css("display","none"):this.$next.css("display","block"))},r.prototype.pointerActive=function(){this.$pointer.filter(".is-active").removeClass("is-active"),this.$pointer.eq(this.current-this.$item.length*this.opts.surplus).addClass("is-active")},r.prototype.setSwipeEvent=function(){this.$items.find("a").click(function(){return!1}),this.opts.swipe&&this.$items.on("touchstart.ncarousel",t.proxy(this.swipeStart,this)),this.opts.draggable&&this.$items.on("mousedown.ncarousel",t.proxy(this.swipeStart,this))},r.prototype.swipeStart=function(i){if(i.preventDefault(),this.lock)return!1;var s=h(i);this.touchStartX=s.x,this.touchMoveX=s.x,this.touchStartItemsMarginLeft=parseInt(this.$items.css("marginLeft")),this.opts.swipe&&(this.$items.on("touchmove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("touchend.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("touchcancel.ncarousel",t.proxy(this.swipeEnd,this))),this.opts.draggable&&(this.$items.on("mousemove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("mouseup.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("mouseleave.ncarousel",t.proxy(this.swipeEnd,this)))},r.prototype.swipeMove=function(t){t.preventDefault();var i=h(t);this.touchMoveX=i.x;var s=this.touchMoveX-this.touchStartX;this.$items.css("marginLeft",this.touchStartItemsMarginLeft+s)},r.prototype.swipeEnd=function(s){this.opts.swipe&&(this.$items.off("touchmove.ncarousel"),this.$items.off("touchend.ncarousel"),this.$items.off("touchcancel.ncarousel")),this.opts.draggable&&(this.$items.off("mousemove.ncarousel"),this.$items.off("mouseup.ncarousel"),this.$items.off("mouseleave.ncarousel"));var h=this.current;if(this.touchMoveX-this.touchThreshold>this.touchStartX)h=this.current-1;else if(this.touchMoveX+this.touchThreshold<this.touchStartX)h=this.current+1;else{var r=t(s.target).closest("a").attr("href");r!=e&&(i.location.href=r)}this.animation(h),this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1}}(jQuery,this,this.document);