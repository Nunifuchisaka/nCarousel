/*!
  
  jquery.nCarousel.js
  
  Version: 0.1.0
  Author: Nunifuchisaka(nunifuchisaka@gmail.com)
  Website: http://nunifuchisaka.com/w/n-carousel/demo
  Repository: https://github.com/Nunifuchisaka/nCarousel
  
*/
!function(t,i,s,e){"use strict";function h(t){var i=t.pageX?t.pageX:t.originalEvent.touches[0].pageX,s=t.pageY?t.pageY:t.originalEvent.touches[0].pageY;return i=Math.floor(i),s=Math.floor(s),{x:i,y:s}}function r(s){var e=this;this.opts=t.extend({duration:400,easing:"swing",thumbnail:!1,surplus:1,interval:0,swipe:!0,draggable:!0,touchThresholdMagnification:10},s),this.backup={},this.lock=!1,this.activeResponsive=!1,this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1,this.touchThreshold=0,this.$window=t(i),this.$el=t(s.el),this.backup.html=this.$el.html(),this.$el.empty(),this.$parent=this.$el.parent(),this.$el.on("click",".nCarousel__prev",function(){return e.animation(e.current-1),!1}).on("click",".nCarousel__next",function(){return e.animation(e.current+1),!1}),this.maxWidth=parseInt(this.$el.css("max-width")),this.init(),this.windowResize(),this.resizeTimer=!1,this.$window.resize(function(){e.resizeTimer!==!1&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(t.proxy(e.windowResize,e),100)}),0<this.opts.interval&&(this.ticker=setInterval(function(){e.animation(e.current+1)},this.opts.interval))}t.fn.nCarousel=function(i){return this.each(function(s,e){var h=t.extend({i:s,el:e},i);new r(h)})},r.prototype.setTouchThreshold=function(){return this.opts.swipe||this.opts.draggable?void(this.touchThreshold=this.$item.outerWidth(!1)*(this.opts.touchThresholdMagnification/100)):!1},r.prototype.windowResize=function(){if(this.windowWidth=this.$window.width(),this.maxWidth<this.$window.width())return void(this.activeResponsive&&(this.activeResponsive=!1,this.resetItemWidth("auto")));this.activeResponsive=!0,this.resetItemWidth(this.$viewport.width())},r.prototype.resetItemWidth=function(t){this.$_item.width(t),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.$items.css({marginLeft:-1*this.opts.surplus*this.itemWidth*this.current+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth}),this.setTouchThreshold()},r.prototype.init=function(){var t=this;this.$el.addClass("nCarousel"),this.$el.html('<div class="nCarousel__viewport">'+this.backup.html+"</div>"),this.$viewport=this.$el.children(".nCarousel__viewport"),this.$items=this.$viewport.children(),this.$item=this.$items.children(),this.$item.addClass("nCarousel__item"),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.marginCorrect=-1*parseInt(this.$item.css("margin-left")),this.$items.css({marginLeft:-1*this.opts.surplus*this.itemsWidth+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth});for(var i=0;i<2*this.opts.surplus;i++)this.$items.append(this.$item.clone());this.$_item=this.$items.children(),this.current=this.$item.length*this.opts.surplus,this.$el.addClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),this.$viewport.append('<div class="nCarousel__arrow nCarousel__prev"></div><div class="nCarousel__arrow nCarousel__next"></div>'),this.$prev=this.$viewport.children(".nCarousel__prev"),this.$next=this.$viewport.children(".nCarousel__next"),this.arrowVisibilities();for(var s='<div class="nCarousel__pointers">',i=0;i<this.$item.length;i++)s+=this.opts.thumbnail?'<div class="nCarousel__pointer is-thumbnail">'+this.$item.eq(i).html()+"</div>":'<div class="nCarousel__pointer"></div>';s+="</div>",this.$el.append(s),this.$pointer=this.$el.find(".nCarousel__pointer"),this.$pointer.eq(0).addClass("is-active"),this.$el.on("click",".nCarousel__pointer",function(i){var s=t.$pointer.index(this),e=s+t.$item.length*t.opts.surplus;return t.animation(e),!1}),this.setTouchThreshold(),this.setSwipeEvent()},r.prototype.animation=function(t){if(this.lock)return!1;var i=this,s=!0,e=this.opts.duration,h=this.opts.easing;return this.lock=!0,0===this.opts.surplus&&(0>t||this.$item.length-1<t)&&(s=!1),this.$el.removeClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),s?(this.current=t,i.current<i.$item.length*i.opts.surplus?i.current+=i.$item.length:i.current>=i.$item.length*(i.opts.surplus+1)&&(i.current-=i.$item.length)):(0>t?t=0:this.$item.length-1<t&&(t=this.$item.length-1),h="linear"),this.$el.addClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),i.pointerActive(),this.$items.stop(!0,!1).animate({marginLeft:i.itemWidth*t*-1+this.marginCorrect},e,h,function(){i.$items.css("marginLeft",i.itemWidth*i.current*-1+i.marginCorrect),i.lock=!1}),this.arrowVisibilities(),s},r.prototype.arrowVisibilities=function(){0===this.opts.surplus&&(0==this.current?this.$prev.css("display","none"):this.$prev.css("display","block"),this.current==this.$item.length-1?this.$next.css("display","none"):this.$next.css("display","block"))},r.prototype.pointerActive=function(){this.$pointer.filter(".is-active").removeClass("is-active"),this.$pointer.eq(this.current-this.$item.length*this.opts.surplus).addClass("is-active")},r.prototype.setSwipeEvent=function(){this.$items.find("a").click(function(){return!1}),this.opts.swipe&&this.$items.on("touchstart.ncarousel",t.proxy(this.swipeStart,this)),this.opts.draggable&&this.$items.on("mousedown.ncarousel",t.proxy(this.swipeStart,this))},r.prototype.swipeStart=function(i){if(i.preventDefault(),this.lock)return!1;var s=h(i);this.touchStartX=s.x,this.touchMoveX=s.x,this.touchStartItemsMarginLeft=parseInt(this.$items.css("marginLeft")),this.opts.swipe&&(this.$items.on("touchmove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("touchend.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("touchcancel.ncarousel",t.proxy(this.swipeEnd,this))),this.opts.draggable&&(this.$items.on("mousemove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("mouseup.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("mouseleave.ncarousel",t.proxy(this.swipeEnd,this)))},r.prototype.swipeMove=function(t){t.preventDefault();var i=h(t);this.touchMoveX=i.x;var s=this.touchMoveX-this.touchStartX;this.$items.css("marginLeft",this.touchStartItemsMarginLeft+s)},r.prototype.swipeEnd=function(s){this.opts.swipe&&(this.$items.off("touchmove.ncarousel"),this.$items.off("touchend.ncarousel"),this.$items.off("touchcancel.ncarousel")),this.opts.draggable&&(this.$items.off("mousemove.ncarousel"),this.$items.off("mouseup.ncarousel"),this.$items.off("mouseleave.ncarousel"));var h=this.current;if(this.touchMoveX-this.touchThreshold>this.touchStartX)h=this.current-1;else if(this.touchMoveX+this.touchThreshold<this.touchStartX)h=this.current+1;else{var r=t(s.target).closest("a").attr("href");r!=e&&(i.location.href=r)}this.animation(h),this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1}}(jQuery,this,this.document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjExMF9oZWFkZXIuanMiLCI0MTBfVmlldy5qcyIsIjk5MF9mb290ZXIuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiUG9zaXRpb24iLCJlIiwieCIsInBhZ2VYIiwib3JpZ2luYWxFdmVudCIsInRvdWNoZXMiLCJ5IiwicGFnZVkiLCJNYXRoIiwiZmxvb3IiLCJuQ2Fyb3VzZWwiLCJvcHRzIiwic2VsZiIsInRoaXMiLCJleHRlbmQiLCJkdXJhdGlvbiIsImVhc2luZyIsInRodW1ibmFpbCIsInN1cnBsdXMiLCJpbnRlcnZhbCIsInN3aXBlIiwiZHJhZ2dhYmxlIiwidG91Y2hUaHJlc2hvbGRNYWduaWZpY2F0aW9uIiwiYmFja3VwIiwibG9jayIsImFjdGl2ZVJlc3BvbnNpdmUiLCJ0b3VjaFN0YXJ0WCIsInRvdWNoTW92ZVgiLCJ0b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0IiwidG91Y2hUaHJlc2hvbGQiLCIkd2luZG93IiwiJGVsIiwiZWwiLCJodG1sIiwiZW1wdHkiLCIkcGFyZW50IiwicGFyZW50Iiwib24iLCJhbmltYXRpb24iLCJjdXJyZW50IiwibWF4V2lkdGgiLCJwYXJzZUludCIsImNzcyIsImluaXQiLCJ3aW5kb3dSZXNpemUiLCJyZXNpemVUaW1lciIsInJlc2l6ZSIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJwcm94eSIsInRpY2tlciIsInNldEludGVydmFsIiwiZm4iLCJlYWNoIiwiaSIsIl9vcHRzIiwicHJvdG90eXBlIiwic2V0VG91Y2hUaHJlc2hvbGQiLCIkaXRlbSIsIm91dGVyV2lkdGgiLCJ3aW5kb3dXaWR0aCIsIndpZHRoIiwicmVzZXRJdGVtV2lkdGgiLCIkdmlld3BvcnQiLCIkX2l0ZW0iLCJpdGVtV2lkdGgiLCJpdGVtc1dpZHRoIiwibGVuZ3RoIiwiJGl0ZW1zIiwibWFyZ2luTGVmdCIsIm1hcmdpbkNvcnJlY3QiLCJhZGRDbGFzcyIsImNoaWxkcmVuIiwiYXBwZW5kIiwiY2xvbmUiLCIkcHJldiIsIiRuZXh0IiwiYXJyb3dWaXNpYmlsaXRpZXMiLCJwb2ludGVyc0hUTUwiLCJlcSIsIiRwb2ludGVyIiwiZmluZCIsImluZGV4IiwibmV4dCIsInNldFN3aXBlRXZlbnQiLCJyZXN1bHQiLCJyZW1vdmVDbGFzcyIsInBvaW50ZXJBY3RpdmUiLCJzdG9wIiwiYW5pbWF0ZSIsImZpbHRlciIsImNsaWNrIiwic3dpcGVTdGFydCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJwb3MiLCJzd2lwZU1vdmUiLCJzd2lwZUVuZCIsImRpZmZYIiwib2ZmIiwiaHJlZiIsInRhcmdldCIsImNsb3Nlc3QiLCJhdHRyIiwibG9jYXRpb24iLCJqUXVlcnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Q0FVQSxTQUFBQSxFQUFBQyxFQUFBQyxFQUFBQyxHQUNBLFlDTUEsU0FBQUMsR0FBQUMsR0FDQSxHQUFBQyxHQUFBRCxFQUFBLE1BQUFBLEVBQUFFLE1BQUFGLEVBQUFHLGNBQUFDLFFBQUEsR0FBQUYsTUFDQUcsRUFBQUwsRUFBQSxNQUFBQSxFQUFBTSxNQUFBTixFQUFBRyxjQUFBQyxRQUFBLEdBQUFFLEtBR0EsT0FGQUwsR0FBQU0sS0FBQUMsTUFBQVAsR0FDQUksRUFBQUUsS0FBQUMsTUFBQUgsSUFDQUosRUFBQUEsRUFBQUksRUFBQUEsR0FTQSxRQUFBSSxHQUFBQyxHQUNBLEdBQUFDLEdBQUFDLElBQ0FBLE1BQUFGLEtBQUFmLEVBQUFrQixRQUNBQyxTQUFBLElBQ0FDLE9BQUEsUUFDQUMsV0FBQSxFQUNBQyxRQUFBLEVBQ0FDLFNBQUEsRUFDQUMsT0FBQSxFQUNBQyxXQUFBLEVBQ0FDLDRCQUFBLElBQ0FYLEdBRUFFLEtBQUFVLFVBQ0FWLEtBQUFXLE1BQUEsRUFDQVgsS0FBQVksa0JBQUEsRUFFQVosS0FBQWEsWUFBQSxHQUNBYixLQUFBYyxXQUFBLEdBQ0FkLEtBQUFlLDBCQUFBLEdBQ0FmLEtBQUFnQixlQUFBLEVBRUFoQixLQUFBaUIsUUFBQWxDLEVBQUFDLEdBQ0FnQixL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aEIsS0FBQWEsWUFDQTJELEVBQUF4RSxLQUFBMEIsUUFBQSxNQUNBLENBQ0EsR0FBQTZELEdBQUF4RyxFQUFBaUcsRUFBQVEsUUFBQUMsUUFBQSxLQUFBQyxLQUFBLE9BQ0FILElBQUFyRyxJQUNBRixFQUFBMkcsU0FBQUosS0FBQUEsR0FHQXZGLEtBQUF5QixVQUFBK0MsR0FHQXhFLEtBQUFhLFlBQUEsR0FDQWIsS0FBQWMsV0FBQSxHQUNBZCxLQUFBZSwwQkFBQSxLQ2haQTZFLE9BQUE1RixLQUFBQSxLQUFBZiIsImZpbGUiOiJqcXVlcnkubkNhcm91c2VsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICBcbiAganF1ZXJ5Lm5DYXJvdXNlbC5qc1xuICBcbiAgVmVyc2lvbjogMC4xLjBcbiAgQXV0aG9yOiBOdW5pZnVjaGlzYWthKG51bmlmdWNoaXNha2FAZ21haWwuY29tKVxuICBXZWJzaXRlOiBodHRwOi8vbnVuaWZ1Y2hpc2FrYS5jb20vdy9uLWNhcm91c2VsL2RlbW9cbiAgUmVwb3NpdG9yeTogaHR0cHM6Ly9naXRodWIuY29tL051bmlmdWNoaXNha2EvbkNhcm91c2VsXG4gIFxuKi9cbjsoZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKXtcbid1c2Ugc3RyaWN0JztcbiIsIi8vXG4kLmZuLm5DYXJvdXNlbCA9IGZ1bmN0aW9uKCBvcHRzICl7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSwgZWwgKXtcbiAgICB2YXIgX29wdHMgPSAkLmV4dGVuZCh7XG4gICAgICBpOiBpLFxuICAgICAgZWw6IGVsXG4gICAgfSwgb3B0cyk7XG4gICAgbmV3IG5DYXJvdXNlbChfb3B0cyk7XG4gIH0pO1xufVxuXG5cbi8qXG4jIyBmdW5jdGlvbnNcbiovXG5cbmZ1bmN0aW9uIFBvc2l0aW9uKGUpe1xuICB2YXIgeCA9IChlLnBhZ2VYKT9lLnBhZ2VYOmUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VYO1xuICB2YXIgeSA9IChlLnBhZ2VZKT9lLnBhZ2VZOmUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VZO1xuICB4ID0gTWF0aC5mbG9vcih4KTtcbiAgeSA9IE1hdGguZmxvb3IoeSk7XG4gIHJldHVybiB7J3gnOnggLCAneSc6eX07XG59XG5cblxuXG4vKlxuIyMgbkNhcm91c2VsXG4qL1xuXG5mdW5jdGlvbiBuQ2Fyb3VzZWwoIG9wdHMgKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5vcHRzID0gJC5leHRlbmQoe1xuICAgIGR1cmF0aW9uOiA0MDAsXG4gICAgZWFzaW5nOiBcInN3aW5nXCIsXG4gICAgdGh1bWJuYWlsOiBmYWxzZSxcbiAgICBzdXJwbHVzOiAxLFxuICAgIGludGVydmFsOiAwLFxuICAgIHN3aXBlOiB0cnVlLFxuICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICB0b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb246IDEwXG4gIH0sIG9wdHMpO1xuICBcbiAgdGhpcy5iYWNrdXAgPSB7fTtcbiAgdGhpcy5sb2NrID0gZmFsc2U7XG4gIHRoaXMuYWN0aXZlUmVzcG9uc2l2ZSA9IGZhbHNlO1xuICBcbiAgdGhpcy50b3VjaFN0YXJ0WCA9IC0xO1xuICB0aGlzLnRvdWNoTW92ZVggPSAtMTtcbiAgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ID0gLTE7XG4gIHRoaXMudG91Y2hUaHJlc2hvbGQgPSAwO1xuICBcbiAgdGhpcy4kd2luZG93ID0gJCh3aW5kb3cpO1xuICB0aGlzLiRlbCA9ICQob3B0cy5lbCk7XG4gIHRoaXMuYmFja3VwLmh0bWwgPSB0aGlzLiRlbC5odG1sKCk7XG4gIHRoaXMuJGVsLmVtcHR5KCk7XG4gIFxuICB0aGlzLiRwYXJlbnQgPSB0aGlzLiRlbC5wYXJlbnQoKTtcbiAgXG4gIHRoaXMuJGVsXG4gICAgLm9uKCdjbGljaycsICcubkNhcm91c2VsX19wcmV2JywgZnVuY3Rpb24oKXtcbiAgICAgIHNlbGYuYW5pbWF0aW9uKCBzZWxmLmN1cnJlbnQgLSAxICk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSlcbiAgICAub24oJ2NsaWNrJywgJy5uQ2Fyb3VzZWxfX25leHQnLCBmdW5jdGlvbigpe1xuICAgICAgc2VsZi5hbmltYXRpb24oIHNlbGYuY3VycmVudCArIDEgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgXG4gIHRoaXMubWF4V2lkdGggPSBwYXJzZUludCggdGhpcy4kZWwuY3NzKCdtYXgtd2lkdGgnKSApO1xuICBcbiAgdGhpcy5pbml0KCk7XG4gIFxuICAvL3Jlc2l6ZVxuICB0aGlzLndpbmRvd1Jlc2l6ZSgpO1xuICB0aGlzLnJlc2l6ZVRpbWVyID0gZmFsc2U7XG4gIHRoaXMuJHdpbmRvdy5yZXNpemUoZnVuY3Rpb24oKXtcbiAgICBpZiggc2VsZi5yZXNpemVUaW1lciAhPT0gZmFsc2UgKSB7XG4gICAgICBjbGVhclRpbWVvdXQoc2VsZi5yZXNpemVUaW1lcik7XG4gICAgfVxuICAgIHNlbGYucmVzaXplVGltZXIgPSBzZXRUaW1lb3V0KCQucHJveHkoc2VsZi53aW5kb3dSZXNpemUsIHNlbGYpLCAxMDApO1xuICB9KTtcbiAgXG4gIC8vYXV0b3BsYXlcbiAgaWYoIDAgPCB0aGlzLm9wdHMuaW50ZXJ2YWwgKSB7XG4gICAgdGhpcy50aWNrZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xuICAgICAgc2VsZi5hbmltYXRpb24oIHNlbGYuY3VycmVudCArIDEgKTtcbiAgICB9LCB0aGlzLm9wdHMuaW50ZXJ2YWwpO1xuICB9XG59XG5cblxubkNhcm91c2VsLnByb3RvdHlwZS5zZXRUb3VjaFRocmVzaG9sZCA9IGZ1bmN0aW9uKCl7XG4gIGlmKCAhdGhpcy5vcHRzLnN3aXBlICYmICF0aGlzLm9wdHMuZHJhZ2dhYmxlICkgcmV0dXJuIGZhbHNlO1xuICBcbiAgdGhpcy50b3VjaFRocmVzaG9sZCA9IHRoaXMuJGl0ZW0ub3V0ZXJXaWR0aChmYWxzZSkgKiAodGhpcy5vcHRzLnRvdWNoVGhyZXNob2xkTWFnbmlmaWNhdGlvbiAvIDEwMCk7XG59XG5cblxuXG4vKlxuIyMjIHdpbmRvdyByZXNpemVcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUud2luZG93UmVzaXplID0gZnVuY3Rpb24oKXtcbiAgdGhpcy53aW5kb3dXaWR0aCA9IHRoaXMuJHdpbmRvdy53aWR0aCgpO1xuICBpZiggdGhpcy5tYXhXaWR0aCA8IHRoaXMuJHdpbmRvdy53aWR0aCgpICl7XG4gICAgaWYoIHRoaXMuYWN0aXZlUmVzcG9uc2l2ZSApIHtcbiAgICAgIHRoaXMuYWN0aXZlUmVzcG9uc2l2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5yZXNldEl0ZW1XaWR0aCgnYXV0bycpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLmFjdGl2ZVJlc3BvbnNpdmUgPSB0cnVlO1xuICB0aGlzLnJlc2V0SXRlbVdpZHRoKCB0aGlzLiR2aWV3cG9ydC53aWR0aCgpICk7XG4gIC8vdGhpcy5yZXNldEl0ZW1XaWR0aCggdGhpcy4kcGFyZW50LndpZHRoKCkgKTtcbn1cblxuXG5cbi8qXG4jIyMgcmVzZXRJdGVtV2lkdGhcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUucmVzZXRJdGVtV2lkdGggPSBmdW5jdGlvbiggd2lkdGggKXtcbiAgdGhpcy4kX2l0ZW0ud2lkdGgod2lkdGgpO1xuICB0aGlzLml0ZW1XaWR0aCA9IHRoaXMuJGl0ZW0ub3V0ZXJXaWR0aCh0cnVlKTtcbiAgdGhpcy5pdGVtc1dpZHRoID0gdGhpcy5pdGVtV2lkdGggKiB0aGlzLiRpdGVtLmxlbmd0aDtcbiAgXG4gIHRoaXMuJGl0ZW1zXG4gICAgLmNzcyh7XG4gICAgICBtYXJnaW5MZWZ0OiAodGhpcy5vcHRzLnN1cnBsdXMgKiAtMSAqIHRoaXMuaXRlbVdpZHRoICogdGhpcy5jdXJyZW50KSArIHRoaXMubWFyZ2luQ29ycmVjdCxcbiAgICAgIHdpZHRoOiAodGhpcy5vcHRzLnN1cnBsdXMgKiAyICsgMSkgKiB0aGlzLml0ZW1zV2lkdGhcbiAgICB9KTtcbiAgXG4gIHRoaXMuc2V0VG91Y2hUaHJlc2hvbGQoKTtcbn1cblxuXG5cbi8qXG4jIyMgaW5pdFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLiRlbC5hZGRDbGFzcygnbkNhcm91c2VsJyk7XG4gIHRoaXMuJGVsLmh0bWwoXG4gICAgJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3ZpZXdwb3J0XCI+J1xuICAgICsgdGhpcy5iYWNrdXAuaHRtbFxuICAgICsgJzwvZGl2PidcbiAgKTtcbiAgXG4gIHRoaXMuJHZpZXdwb3J0ID0gdGhpcy4kZWwuY2hpbGRyZW4oJy5uQ2Fyb3VzZWxfX3ZpZXdwb3J0Jyk7XG4gIHRoaXMuJGl0ZW1zID0gdGhpcy4kdmlld3BvcnQuY2hpbGRyZW4oKTtcbiAgdGhpcy4kaXRlbSA9IHRoaXMuJGl0ZW1zLmNoaWxkcmVuKCk7XG4gIHRoaXMuJGl0ZW0uYWRkQ2xhc3MoJ25DYXJvdXNlbF9faXRlbScpO1xuICBcbiAgdGhpcy5pdGVtV2lkdGggPSB0aGlzLiRpdGVtLm91dGVyV2lkdGgodHJ1ZSk7XG4gIHRoaXMuaXRlbXNXaWR0aCA9IHRoaXMuaXRlbVdpZHRoICogdGhpcy4kaXRlbS5sZW5ndGg7XG4gIFxuICB0aGlzLm1hcmdpbkNvcnJlY3QgPSBwYXJzZUludCggdGhpcy4kaXRlbS5jc3MoJ21hcmdpbi1sZWZ0JykgKSAqIC0xO1xuICBcbiAgdGhpcy4kaXRlbXNcbiAgICAuY3NzKHtcbiAgICAgIG1hcmdpbkxlZnQ6ICh0aGlzLm9wdHMuc3VycGx1cyAqIC0xICogdGhpcy5pdGVtc1dpZHRoKSArIHRoaXMubWFyZ2luQ29ycmVjdCxcbiAgICAgIHdpZHRoOiAodGhpcy5vcHRzLnN1cnBsdXMgKiAyICsgMSkgKiB0aGlzLml0ZW1zV2lkdGhcbiAgICB9KTtcbiAgXG4gIGZvciggdmFyIGk9MDsgaSA8IHRoaXMub3B0cy5zdXJwbHVzICogMjsgaSsrICl7XG4gICAgdGhpcy4kaXRlbXMuYXBwZW5kKCB0aGlzLiRpdGVtLmNsb25lKCkgKTtcbiAgfVxuICB0aGlzLiRfaXRlbSA9IHRoaXMuJGl0ZW1zLmNoaWxkcmVuKCk7XG4gIFxuICB0aGlzLmN1cnJlbnQgPSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzO1xuICB0aGlzLiRlbC5hZGRDbGFzcyhcImlzLWN1cnJlbnQtXCIgKyAodGhpcy5jdXJyZW50IC0gdGhpcy4kaXRlbS5sZW5ndGggKiB0aGlzLm9wdHMuc3VycGx1cykpO1xuICBcbiAgLy9hcnJvd3NcbiAgdGhpcy4kdmlld3BvcnQuYXBwZW5kKFxuICAgICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX19hcnJvdyBuQ2Fyb3VzZWxfX3ByZXZcIj48L2Rpdj4nICsgXG4gICAgJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX2Fycm93IG5DYXJvdXNlbF9fbmV4dFwiPjwvZGl2PidcbiAgKTtcbiAgdGhpcy4kcHJldiA9IHRoaXMuJHZpZXdwb3J0LmNoaWxkcmVuKCcubkNhcm91c2VsX19wcmV2Jyk7XG4gIHRoaXMuJG5leHQgPSB0aGlzLiR2aWV3cG9ydC5jaGlsZHJlbignLm5DYXJvdXNlbF9fbmV4dCcpO1xuICB0aGlzLmFycm93VmlzaWJpbGl0aWVzKCk7XG4gIFxuICAvL2FkZCBwb2ludGVyc1xuICAvL3ZhciBwb2ludGVyc0hUTUwgPSAodGhpcy5vcHRzLnRodW1ibmFpbCk/JzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3BvaW50ZXJzIGlzLXRodW1ibmFpbFwiPic6JzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3BvaW50ZXJzXCI+JztcbiAgdmFyIHBvaW50ZXJzSFRNTCA9ICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX19wb2ludGVyc1wiPic7XG4gIGZvciggdmFyIGk9MDsgaTx0aGlzLiRpdGVtLmxlbmd0aDsgaSsrICl7XG4gICAgaWYodGhpcy5vcHRzLnRodW1ibmFpbCl7XG4gICAgICBwb2ludGVyc0hUTUwgKz0gJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3BvaW50ZXIgaXMtdGh1bWJuYWlsXCI+JyArIHRoaXMuJGl0ZW0uZXEoaSkuaHRtbCgpICsgJzwvZGl2Pic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvaW50ZXJzSFRNTCArPSAnPGRpdiBjbGFzcz1cIm5DYXJvdXNlbF9fcG9pbnRlclwiPjwvZGl2Pic7XG4gICAgfVxuICB9XG4gIHBvaW50ZXJzSFRNTCArPSAnPC9kaXY+JztcbiAgXG4gIHRoaXMuJGVsLmFwcGVuZChwb2ludGVyc0hUTUwpO1xuICB0aGlzLiRwb2ludGVyID0gdGhpcy4kZWwuZmluZCgnLm5DYXJvdXNlbF9fcG9pbnRlcicpO1xuICB0aGlzLiRwb2ludGVyLmVxKDApLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbiAgdGhpcy4kZWwub24oJ2NsaWNrJywgJy5uQ2Fyb3VzZWxfX3BvaW50ZXInLCBmdW5jdGlvbihlKXtcbiAgICB2YXIgaW5kZXggPSBzZWxmLiRwb2ludGVyLmluZGV4KHRoaXMpLFxuICAgICAgICBuZXh0ICA9IGluZGV4ICsgc2VsZi4kaXRlbS5sZW5ndGggKiBzZWxmLm9wdHMuc3VycGx1cztcbiAgICBzZWxmLmFuaW1hdGlvbiggbmV4dCApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG4gIFxuICB0aGlzLnNldFRvdWNoVGhyZXNob2xkKCk7XG4gIHRoaXMuc2V0U3dpcGVFdmVudCgpO1xufVxuXG5cblxuLypcbiMjIyBhbmltYXRpb25cbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuYW5pbWF0aW9uID0gZnVuY3Rpb24oIG5leHQgKXtcbiAgaWYoIHRoaXMubG9jayApIHJldHVybiBmYWxzZTtcbiAgXG4gIHZhciBzZWxmID0gdGhpcyxcbiAgICAgIHJlc3VsdCA9IHRydWUsXG4gICAgICBkdXJhdGlvbiA9IHRoaXMub3B0cy5kdXJhdGlvbixcbiAgICAgIGVhc2luZyA9IHRoaXMub3B0cy5lYXNpbmc7XG4gIFxuICB0aGlzLmxvY2sgPSB0cnVlO1xuICBcbiAgaWYoIDAgPT09IHRoaXMub3B0cy5zdXJwbHVzICkge1xuICAgIGlmKCBuZXh0IDwgMCB8fCB0aGlzLiRpdGVtLmxlbmd0aCAtIDEgPCBuZXh0ICkgcmVzdWx0ID0gZmFsc2U7XG4gIH1cbiAgXG4gIHRoaXMuJGVsLnJlbW92ZUNsYXNzKFwiaXMtY3VycmVudC1cIiArICh0aGlzLmN1cnJlbnQgLSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzKSk7XG4gIFxuICBpZiggcmVzdWx0ICkge1xuICAgIFxuICAgIHRoaXMuY3VycmVudCA9IG5leHQ7XG4gICAgaWYoIHNlbGYuY3VycmVudCA8IHNlbGYuJGl0ZW0ubGVuZ3RoICogc2VsZi5vcHRzLnN1cnBsdXMgKSB7XG4gICAgICBzZWxmLmN1cnJlbnQgKz0gc2VsZi4kaXRlbS5sZW5ndGg7XG4gICAgfSBlbHNlIGlmKCBzZWxmLmN1cnJlbnQgPj0gc2VsZi4kaXRlbS5sZW5ndGggKiAoc2VsZi5vcHRzLnN1cnBsdXMgKyAxKSApIHtcbiAgICAgIHNlbGYuY3VycmVudCAtPSBzZWxmLiRpdGVtLmxlbmd0aDtcbiAgICB9XG4gICAgXG4gIH0gZWxzZSB7XG4gICAgXG4gICAgaWYoIG5leHQgPCAwICkge1xuICAgICAgbmV4dCA9IDA7XG4gICAgfSBlbHNlIGlmKCB0aGlzLiRpdGVtLmxlbmd0aCAtIDEgPCBuZXh0ICkge1xuICAgICAgbmV4dCA9IHRoaXMuJGl0ZW0ubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgZWFzaW5nID0gJ2xpbmVhcic7XG4gICAgXG4gIH1cbiAgXG4gIHRoaXMuJGVsLmFkZENsYXNzKFwiaXMtY3VycmVudC1cIiArICh0aGlzLmN1cnJlbnQgLSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzKSk7XG4gIFxuICBzZWxmLnBvaW50ZXJBY3RpdmUoKTtcbiAgXG4gIHRoaXMuJGl0ZW1zLnN0b3AodHJ1ZSxmYWxzZSkuYW5pbWF0ZSh7XG4gICAgJ21hcmdpbkxlZnQnOiBzZWxmLml0ZW1XaWR0aCAqIG5leHQgKiAtMSArIHRoaXMubWFyZ2luQ29ycmVjdFxuICB9LCBkdXJhdGlvbiwgZWFzaW5nLCBmdW5jdGlvbigpe1xuICAgIHNlbGYuJGl0ZW1zLmNzcygnbWFyZ2luTGVmdCcsIHNlbGYuaXRlbVdpZHRoICogc2VsZi5jdXJyZW50ICogLTEgKyBzZWxmLm1hcmdpbkNvcnJlY3QpO1xuICAgIHNlbGYubG9jayA9IGZhbHNlO1xuICB9KTtcbiAgXG4gIHRoaXMuYXJyb3dWaXNpYmlsaXRpZXMoKTtcbiAgXG4gIHJldHVybiByZXN1bHQ7XG59XG5cblxuXG4vKlxuIyMjIGFycm93IHZpc2liaWxpdGllc1xuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5hcnJvd1Zpc2liaWxpdGllcyA9IGZ1bmN0aW9uKCl7XG4gIGlmKCAwID09PSB0aGlzLm9wdHMuc3VycGx1cyApIHtcbiAgICBpZiggMCA9PSB0aGlzLmN1cnJlbnQgKSB7XG4gICAgICB0aGlzLiRwcmV2LmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4kcHJldi5jc3MoJ2Rpc3BsYXknLCdibG9jaycpO1xuICAgIH1cbiAgICBpZiggdGhpcy5jdXJyZW50ID09IHRoaXMuJGl0ZW0ubGVuZ3RoIC0gMSApIHtcbiAgICAgIHRoaXMuJG5leHQuY3NzKCdkaXNwbGF5Jywnbm9uZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRuZXh0LmNzcygnZGlzcGxheScsJ2Jsb2NrJyk7XG4gICAgfVxuICB9XG59XG5cblxuXG4vKlxuIyMjIHBvaW50ZXIgYWN0aXZlXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnBvaW50ZXJBY3RpdmUgPSBmdW5jdGlvbigpe1xuICB0aGlzLiRwb2ludGVyLmZpbHRlcignLmlzLWFjdGl2ZScpLnJlbW92ZUNsYXNzKCdpcy1hY3RpdmUnKTtcbiAgdGhpcy4kcG9pbnRlci5lcSh0aGlzLmN1cnJlbnQgLSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XG59XG5cblxuXG4vKlxuIyMjIHN3aXBlXG4qL1xuXG4vKlxuIyMjIyBzZXQgc3dpcGUgZXZlbnRcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc2V0U3dpcGVFdmVudCA9IGZ1bmN0aW9uKCl7XG4gIFxuICB0aGlzLiRpdGVtcy5maW5kKFwiYVwiKS5jbGljayhmdW5jdGlvbigpe3JldHVybiBmYWxzZX0pO1xuICBcbiAgLy9zd2lwZVxuICBpZiggdGhpcy5vcHRzLnN3aXBlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9uKCd0b3VjaHN0YXJ0Lm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZVN0YXJ0LCB0aGlzKSk7XG4gIH1cbiAgXG4gIC8vZHJhZ2dhYmxlXG4gIGlmKCB0aGlzLm9wdHMuZHJhZ2dhYmxlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZWRvd24ubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlU3RhcnQsIHRoaXMpKTtcbiAgfVxufVxuXG4vKlxuIyMjIyBzd2lwZSBzdGFydFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5zd2lwZVN0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpe1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBpZiggdGhpcy5sb2NrICkgcmV0dXJuIGZhbHNlO1xuICBcbiAgdmFyIHBvcyA9IFBvc2l0aW9uKGV2ZW50KTtcbiAgdGhpcy50b3VjaFN0YXJ0WCA9IHBvcy54O1xuICB0aGlzLnRvdWNoTW92ZVggPSBwb3MueDtcbiAgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ID0gcGFyc2VJbnQoIHRoaXMuJGl0ZW1zLmNzcygnbWFyZ2luTGVmdCcpICk7XG4gIFxuICAvL29uIG1vdmUgJiBlbmRcbiAgaWYoIHRoaXMub3B0cy5zd2lwZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbigndG91Y2htb3ZlLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZU1vdmUsIHRoaXMpKTtcbiAgICB0aGlzLiRpdGVtcy5vbigndG91Y2hlbmQubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlRW5kLCB0aGlzKSk7XG4gICAgdGhpcy4kaXRlbXMub24oJ3RvdWNoY2FuY2VsLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICB9XG4gIGlmKCB0aGlzLm9wdHMuZHJhZ2dhYmxlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZW1vdmUubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlTW92ZSwgdGhpcykpO1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZXVwLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZWxlYXZlLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICB9XG59XG5cbi8qXG4jIyMjIHN3aXBlIG1vdmVcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc3dpcGVNb3ZlID0gZnVuY3Rpb24oZXZlbnQpe1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB2YXIgcG9zID0gUG9zaXRpb24oZXZlbnQpO1xuICB0aGlzLnRvdWNoTW92ZVggPSBwb3MueDtcbiAgdmFyIGRpZmZYID0gdGhpcy50b3VjaE1vdmVYIC0gdGhpcy50b3VjaFN0YXJ0WDtcbiAgdGhpcy4kaXRlbXMuY3NzKCdtYXJnaW5MZWZ0JywgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ICsgZGlmZlgpO1xufVxuXG4vKlxuIyMjIyBzd2lwZSBlbmRcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc3dpcGVFbmQgPSBmdW5jdGlvbihldmVudCl7XG4gIC8vb2ZmIG1vdmUgJiBlbmRcbiAgaWYoIHRoaXMub3B0cy5zd2lwZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ3RvdWNobW92ZS5uY2Fyb3VzZWwnKTtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ3RvdWNoZW5kLm5jYXJvdXNlbCcpO1xuICAgIHRoaXMuJGl0ZW1zLm9mZigndG91Y2hjYW5jZWwubmNhcm91c2VsJyk7XG4gIH1cbiAgaWYoIHRoaXMub3B0cy5kcmFnZ2FibGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCdtb3VzZW1vdmUubmNhcm91c2VsJyk7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCdtb3VzZXVwLm5jYXJvdXNlbCcpO1xuICAgIHRoaXMuJGl0ZW1zLm9mZignbW91c2VsZWF2ZS5uY2Fyb3VzZWwnKTtcbiAgfVxuICBcbiAgdmFyIHJlc3VsdCA9IHRoaXMuY3VycmVudDtcbiAgaWYoIHRoaXMudG91Y2hNb3ZlWCAtIHRoaXMudG91Y2hUaHJlc2hvbGQgPiB0aGlzLnRvdWNoU3RhcnRYICkge1xuICAgIHJlc3VsdCA9IHRoaXMuY3VycmVudCAtIDE7XG4gIH0gZWxzZSBpZiggdGhpcy50b3VjaE1vdmVYICsgdGhpcy50b3VjaFRocmVzaG9sZCA8IHRoaXMudG91Y2hTdGFydFggKSB7XG4gICAgcmVzdWx0ID0gdGhpcy5jdXJyZW50ICsgMTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgaHJlZiA9ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KFwiYVwiKS5hdHRyKFwiaHJlZlwiKTtcbiAgICBpZihocmVmICE9IHVuZGVmaW5lZCkge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBocmVmO1xuICAgIH1cbiAgfVxuICB0aGlzLmFuaW1hdGlvbiggcmVzdWx0ICk7XG4gIFxuICAvL3Jlc2V0XG4gIHRoaXMudG91Y2hTdGFydFggPSAtMTtcbiAgdGhpcy50b3VjaE1vdmVYID0gLTE7XG4gIHRoaXMudG91Y2hTdGFydEl0ZW1zTWFyZ2luTGVmdCA9IC0xO1xufVxuIiwifSkoalF1ZXJ5LCB0aGlzLCB0aGlzLmRvY3VtZW50KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
