/*!
  
  jquery.nCarousel.js
  
  Version: 0.1.0
  Author: Nunifuchisaka(nunifuchisaka@gmail.com)
  Website: http://nunifuchisaka.com/w/n-carousel/demo
  Repository: https://github.com/Nunifuchisaka/nCarousel
  
*/
!function(t,i,s,e){"use strict";function h(t){var i=t.pageX?t.pageX:t.originalEvent.touches[0].pageX,s=t.pageY?t.pageY:t.originalEvent.touches[0].pageY;return i=Math.floor(i),s=Math.floor(s),{x:i,y:s}}function o(s){var e=this;this.opts=t.extend({duration:400,easing:"swing",thumbnail:!1,surplus:1,interval:0,swipe:!0,draggable:!0,pointers:!0,touchThresholdMagnification:10,pauseWithMouseenter:!0},s),this.backup={},this.lock=!1,this.activeResponsive=!1,this.mouseenter=!1,this.swiping=!1,this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1,this.touchThreshold=0,this.$window=t(i),this.$el=t(s.el),this.$parent=this.$el.parent(),this.$el.on("click",".nCarousel__prev",function(){return e.animation(e.current-1),!1}).on("click",".nCarousel__next",function(){return e.animation(e.current+1),!1}).on({mouseenter:function(){e.mouseenter=!0},mouseleave:function(){e.mouseenter=!1}}),this.maxWidth=parseInt(this.$el.css("max-width")),this.init(),this.windowResize(),this.resizeTimer=!1,this.$window.resize(function(){e.resizeTimer!==!1&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(t.proxy(e.windowResize,e),0)}),0<this.opts.interval&&this.autoplay()}t.fn.nCarousel=function(i){return this.each(function(s,e){var h=t.extend({i:s,el:e},i);new o(h)})},o.prototype.setTouchThreshold=function(){return this.opts.swipe||this.opts.draggable?void(this.touchThreshold=this.$item.outerWidth(!1)*(this.opts.touchThresholdMagnification/100)):!1},o.prototype.autoplay=function(){var t=this;this.ticker=setInterval(function(){t.opts.pauseWithMouseenter&&t.mouseenter||t.swiping||t.animation(t.current+1)},this.opts.interval)},o.prototype.windowResize=function(){if(this.windowWidth=this.$window.width(),this.maxWidth<this.windowWidth)return void(this.activeResponsive&&(this.activeResponsive=!1,this.resetItemWidth("auto")));this.activeResponsive=!0,this.resetItemWidth(this.$viewport.width())},o.prototype.resetItemWidth=function(t){this.$_item.width(t),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.$items.css({marginLeft:-1*this.opts.surplus*this.itemWidth*this.current+this.marginCorrect}),this.setTouchThreshold()},o.prototype.init=function(){var t=this;this.$el.addClass("nCarousel"),1>this.$el.find(".nCarousel__viewport").length&&(this.backup.html=this.$el.html(),this.$el.empty(),this.$el.html('<div class="nCarousel__viewport">'+this.backup.html+"</div>")),this.$viewport=this.$el.children(".nCarousel__viewport"),this.$items=this.$viewport.children(),this.$items.addClass("nCarousel__items"),this.$item=this.$items.children(),this.$item.addClass("nCarousel__item"),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.marginCorrect=-1*parseInt(this.$item.css("margin-left")),this.$items.css({marginLeft:-1*this.opts.surplus*this.itemsWidth+this.marginCorrect});for(var i=0;i<2*this.opts.surplus;i++)this.$items.append(this.$item.clone());if(this.$_item=this.$items.children(),this.current=this.$item.length*this.opts.surplus,this.$el.addClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),this.$viewport.append('<div class="nCarousel__arrow nCarousel__prev"></div><div class="nCarousel__arrow nCarousel__next"></div>'),this.$prev=this.$viewport.children(".nCarousel__prev"),this.$next=this.$viewport.children(".nCarousel__next"),this.arrowVisibilities(),this.opts.pointers){for(var s='<div class="nCarousel__pointers">',i=0;i<this.$item.length;i++)s+='<div class="nCarousel__pointer"></div>';s+="</div>",this.$el.append(s),this.$pointer=this.$el.find(".nCarousel__pointer"),this.$pointer.eq(0).addClass("is-active"),this.$el.on("click",".nCarousel__pointer",function(i){var s=t.$pointer.index(this),e=s+t.$item.length*t.opts.surplus;return t.animation(e),!1})}this.setTouchThreshold(),this.setSwipeEvent()},o.prototype.animation=function(t){if(this.lock)return!1;var i=this,s=!0,e=this.opts.duration,h=this.opts.easing;return this.lock=!0,0===this.opts.surplus&&(0>t||this.$item.length-1<t)&&(s=!1),this.$el.removeClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),s?(this.current=t,i.current<i.$item.length*i.opts.surplus?i.current+=i.$item.length:i.current>=i.$item.length*(i.opts.surplus+1)&&(i.current-=i.$item.length)):(0>t?t=0:this.$item.length-1<t&&(t=this.$item.length-1),h="linear"),this.opts.pointers&&i.pointerActive(),this.$items.stop(!0,!1).animate({marginLeft:i.itemWidth*t*-1+this.marginCorrect},e,h,function(){i.$items.css("marginLeft",i.itemWidth*i.current*-1+i.marginCorrect),i.lock=!1}),this.arrowVisibilities(),s},o.prototype.arrowVisibilities=function(){0===this.opts.surplus&&(0==this.current?this.$prev.css("display","none"):this.$prev.css("display","block"),this.current==this.$item.length-1?this.$next.css("display","none"):this.$next.css("display","block"))},o.prototype.pointerActive=function(){this.$pointer.filter(".is-active").removeClass("is-active"),this.$pointer.eq(this.current-this.$item.length*this.opts.surplus).addClass("is-active")},o.prototype.setSwipeEvent=function(){this.$items.find("a").click(function(){return!1}),this.opts.swipe&&this.$items.on("touchstart.ncarousel",t.proxy(this.swipeStart,this)),this.opts.draggable&&this.$items.on("mousedown.ncarousel",t.proxy(this.swipeStart,this))},o.prototype.swipeStart=function(i){if(i.preventDefault(),this.lock)return!1;this.swiping=!0;var s=h(i);this.touchStartX=s.x,this.touchMoveX=s.x,this.touchStartItemsMarginLeft=parseInt(this.$items.css("marginLeft")),this.opts.swipe&&(this.$items.on("touchmove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("touchend.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("touchcancel.ncarousel",t.proxy(this.swipeEnd,this))),this.opts.draggable&&(this.$items.on("mousemove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("mouseup.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("mouseleave.ncarousel",t.proxy(this.swipeEnd,this)))},o.prototype.swipeMove=function(t){t.preventDefault();var i=h(t);this.touchMoveX=i.x;var s=this.touchMoveX-this.touchStartX;this.$items.css("marginLeft",this.touchStartItemsMarginLeft+s)},o.prototype.swipeEnd=function(s){this.swiping=!1,this.opts.swipe&&(this.$items.off("touchmove.ncarousel"),this.$items.off("touchend.ncarousel"),this.$items.off("touchcancel.ncarousel")),this.opts.draggable&&(this.$items.off("mousemove.ncarousel"),this.$items.off("mouseup.ncarousel"),this.$items.off("mouseleave.ncarousel"));var h=this.current;if(this.touchMoveX-this.touchThreshold>this.touchStartX)h=this.current-1;else if(this.touchMoveX+this.touchThreshold<this.touchStartX)h=this.current+1;else{var o=t(s.target).closest("a").attr("href");o!=e&&(i.location.href=o)}this.animation(h),this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1}}(jQuery,this,this.document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjExMF9oZWFkZXIuanMiLCI0MTBfVmlldy5qcyIsIjk5MF9mb290ZXIuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiUG9zaXRpb24iLCJlIiwieCIsInBhZ2VYIiwib3JpZ2luYWxFdmVudCIsInRvdWNoZXMiLCJ5IiwicGFnZVkiLCJNYXRoIiwiZmxvb3IiLCJuQ2Fyb3VzZWwiLCJvcHRzIiwic2VsZiIsInRoaXMiLCJleHRlbmQiLCJkdXJhdGlvbiIsImVhc2luZyIsInRodW1ibmFpbCIsInN1cnBsdXMiLCJpbnRlcnZhbCIsInN3aXBlIiwiZHJhZ2dhYmxlIiwicG9pbnRlcnMiLCJ0b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb24iLCJwYXVzZVdpdGhNb3VzZWVudGVyIiwiYmFja3VwIiwibG9jayIsImFjdGl2ZVJlc3BvbnNpdmUiLCJtb3VzZWVudGVyIiwic3dpcGluZyIsInRvdWNoU3RhcnRYIiwidG91Y2hNb3ZlWCIsInRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQiLCJ0b3VjaFRocmVzaG9sZCIsIiR3aW5kb3ciLCIkZWwiLCJlbCIsIiRwYXJlbnQiLCJwYXJlbnQiLCJvbiIsImFuaW1hdGlvbiIsImN1cnJlbnQiLCJtb3VzZWxlYXZlIiwibWF4V2lkdGgiLCJwYXJzZUludCIsImNzcyIsImluaXQiLCJ3aW5kb3dSZXNpemUiLCJyZXNpemVUaW1lciIsInJlc2l6ZSIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJwcm94eSIsImF1dG9wbGF5IiwiZm4iLCJlYWNoIiwiaSIsIl9vcHRzIiwicHJvdG90eXBlIiwic2V0VG91Y2hUaHJlc2hvbGQiLCIkaXRlbSIsIm91dGVyV2lkdGgiLCJ0aWNrZXIiLCJzZXRJbnRlcnZhbCIsIndpbmRvd1dpZHRoIiwid2lkdGgiLCJyZXNldEl0ZW1XaWR0aCIsIiR2aWV3cG9ydCIsIiRfaXRlbSIsIml0ZW1XaWR0aCIsIml0ZW1zV2lkdGgiLCJsZW5ndGgiLCIkaXRlbXMiLCJtYXJnaW5MZWZ0IiwibWFyZ2luQ29ycmVjdCIsImFkZENsYXNzIiwiZmluZCIsImh0bWwiLCJlbXB0eSIsImNoaWxkcmVuIiwiYXBwZW5kIiwiY2xvbmUiLCIkcHJldiIsIiRuZXh0IiwiYXJyb3dWaXNpYmlsaXRpZXMiLCJwb2ludGVyc0hUTUwiLCIkcG9pbnRlciIsImVxIiwiaW5kZXgiLCJuZXh0Iiwic2V0U3dpcGVFdmVudCIsInJlc3VsdCIsInJlbW92ZUNsYXNzIiwicG9pbnRlckFjdGl2ZSIsInN0b3AiLCJhbmltYXRlIiwiZmlsdGVyIiwiY2xpY2siLCJzd2lwZVN0YXJ0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInBvcyIsInN3aXBlTW92ZSIsInN3aXBlRW5kIiwiZGlmZlgiLCJvZmYiLCJocmVmIiwidGFyZ2V0IiwiY2xvc2VzdCIsImF0dHIiLCJsb2NhdGlvbiIsImpRdWVyeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztDQVVBLFNBQUFBLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsWUNNQSxTQUFBQyxHQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUEsTUFBQUEsRUFBQUUsTUFBQUYsRUFBQUcsY0FBQUMsUUFBQSxHQUFBRixNQUNBRyxFQUFBTCxFQUFBLE1BQUFBLEVBQUFNLE1BQUFOLEVBQUFHLGNBQUFDLFFBQUEsR0FBQUUsS0FHQSxPQUZBTCxHQUFBTSxLQUFBQyxNQUFBUCxHQUNBSSxFQUFBRSxLQUFBQyxNQUFBSCxJQUNBSixFQUFBQSxFQUFBSSxFQUFBQSxHQVNBLFFBQUFJLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsSUFDQUEsTUFBQUYsS0FBQWYsRUFBQWtCLFFBQ0FDLFNBQUEsSUFDQUMsT0FBQSxRQUNBQyxXQUFBLEVBQ0FDLFFBQUEsRUFDQUMsU0FBQSxFQUNBQyxPQUFBLEVBQ0FDLFdBQUEsRUFDQUMsVUFBQSxFQUNBQyw0QkFBQSxHQUNBQyxxQkFBQSxHQUNBYixHQU1BRSxLQUFBWSxVQUNBWixLQUFBYSxNQUFBLEVBQ0FiLEtBQUFjLGtCQUFBLEVB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LDBCQUVBNUYsS0FBQUYsS0FBQVUsWUFDQVIsS0FBQTJELE9BQUFpQyxJQUFBLHVCQUNBNUYsS0FBQTJELE9BQUFpQyxJQUFBLHFCQUNBNUYsS0FBQTJELE9BQUFpQyxJQUFBLHdCQUdBLElBQUFkLEdBQUE5RSxLQUFBNEIsT0FDQSxJQUFBNUIsS0FBQWtCLFdBQUFsQixLQUFBb0IsZUFBQXBCLEtBQUFpQixZQUNBNkQsRUFBQTlFLEtBQUE0QixRQUFBLE1BQ0EsSUFBQTVCLEtBQUFrQixXQUFBbEIsS0FBQW9CLGVBQUFwQixLQUFBaUIsWUFDQTZELEVBQUE5RSxLQUFBNEIsUUFBQSxNQUNBLENBQ0EsR0FBQWlFLEdBQUE5RyxFQUFBdUcsRUFBQVEsUUFBQUMsUUFBQSxLQUFBQyxLQUFBLE9BQ0FILElBQUEzRyxJQUNBRixFQUFBaUgsU0FBQUosS0FBQUEsR0FHQTdGLEtBQUEyQixVQUFBbUQsR0FHQTlFLEtBQUFpQixZQUFBLEdBQ0FqQixLQUFBa0IsV0FBQSxHQUNBbEIsS0FBQW1CLDBCQUFBLEtDdmFBK0UsT0FBQWxHLEtBQUFBLEtBQUFmIiwiZmlsZSI6ImpxdWVyeS5uQ2Fyb3VzZWwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gIFxuICBqcXVlcnkubkNhcm91c2VsLmpzXG4gIFxuICBWZXJzaW9uOiAwLjEuMFxuICBBdXRob3I6IE51bmlmdWNoaXNha2EobnVuaWZ1Y2hpc2FrYUBnbWFpbC5jb20pXG4gIFdlYnNpdGU6IGh0dHA6Ly9udW5pZnVjaGlzYWthLmNvbS93L24tY2Fyb3VzZWwvZGVtb1xuICBSZXBvc2l0b3J5OiBodHRwczovL2dpdGh1Yi5jb20vTnVuaWZ1Y2hpc2FrYS9uQ2Fyb3VzZWxcbiAgXG4qL1xuOyhmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpe1xuJ3VzZSBzdHJpY3QnO1xuIiwiLy9cbiQuZm4ubkNhcm91c2VsID0gZnVuY3Rpb24oIG9wdHMgKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpLCBlbCApe1xuICAgIHZhciBfb3B0cyA9ICQuZXh0ZW5kKHtcbiAgICAgIGk6IGksXG4gICAgICBlbDogZWxcbiAgICB9LCBvcHRzKTtcbiAgICBuZXcgbkNhcm91c2VsKF9vcHRzKTtcbiAgfSk7XG59XG5cblxuLypcbiMjIGZ1bmN0aW9uc1xuKi9cblxuZnVuY3Rpb24gUG9zaXRpb24oZSl7XG4gIHZhciB4ID0gKGUucGFnZVgpP2UucGFnZVg6ZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7XG4gIHZhciB5ID0gKGUucGFnZVkpP2UucGFnZVk6ZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVk7XG4gIHggPSBNYXRoLmZsb29yKHgpO1xuICB5ID0gTWF0aC5mbG9vcih5KTtcbiAgcmV0dXJuIHsneCc6eCAsICd5Jzp5fTtcbn1cblxuXG5cbi8qXG4jIyBuQ2Fyb3VzZWxcbiovXG5cbmZ1bmN0aW9uIG5DYXJvdXNlbCggb3B0cyApIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLm9wdHMgPSAkLmV4dGVuZCh7XG4gICAgZHVyYXRpb246IDQwMCxcbiAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICB0aHVtYm5haWw6IGZhbHNlLFxuICAgIHN1cnBsdXM6IDEsXG4gICAgaW50ZXJ2YWw6IDAsXG4gICAgc3dpcGU6IHRydWUsXG4gICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgIHBvaW50ZXJzOiB0cnVlLFxuICAgIHRvdWNoVGhyZXNob2xkTWFnbmlmaWNhdGlvbjogMTAsXG4gICAgcGF1c2VXaXRoTW91c2VlbnRlcjogdHJ1ZVxuICB9LCBvcHRzKTtcbiAgXG4gIC8qXG4gIHBhdXNlV2l0aE1vdXNlZW50ZXLvvJrjg57jgqbjgrnjgqjjg7Pjgr/jg7zjgafkuIDmmYLlgZzmraJcbiAgKi9cbiAgXG4gIHRoaXMuYmFja3VwID0ge307XG4gIHRoaXMubG9jayA9IGZhbHNlO1xuICB0aGlzLmFjdGl2ZVJlc3BvbnNpdmUgPSBmYWxzZTtcbiAgXG4gIHRoaXMubW91c2VlbnRlciA9IGZhbHNlO1xuICB0aGlzLnN3aXBpbmcgPSBmYWxzZTtcbiAgdGhpcy50b3VjaFN0YXJ0WCA9IC0xO1xuICB0aGlzLnRvdWNoTW92ZVggPSAtMTtcbiAgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ID0gLTE7XG4gIHRoaXMudG91Y2hUaHJlc2hvbGQgPSAwO1xuICBcbiAgdGhpcy4kd2luZG93ID0gJCh3aW5kb3cpO1xuICB0aGlzLiRlbCA9ICQob3B0cy5lbCk7XG4gIHRoaXMuJHBhcmVudCA9IHRoaXMuJGVsLnBhcmVudCgpO1xuICBcbiAgdGhpcy4kZWxcbiAgICAub24oJ2NsaWNrJywgJy5uQ2Fyb3VzZWxfX3ByZXYnLCBmdW5jdGlvbigpe1xuICAgICAgc2VsZi5hbmltYXRpb24oIHNlbGYuY3VycmVudCAtIDEgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KVxuICAgIC5vbignY2xpY2snLCAnLm5DYXJvdXNlbF9fbmV4dCcsIGZ1bmN0aW9uKCl7XG4gICAgICBzZWxmLmFuaW1hdGlvbiggc2VsZi5jdXJyZW50ICsgMSApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pXG4gICAgLm9uKHtcbiAgICAgICdtb3VzZWVudGVyJzogZnVuY3Rpb24oKXsgc2VsZi5tb3VzZWVudGVyID0gdHJ1ZSB9LFxuICAgICAgJ21vdXNlbGVhdmUnOiBmdW5jdGlvbigpeyBzZWxmLm1vdXNlZW50ZXIgPSBmYWxzZSB9XG4gICAgfSk7XG4gIFxuICB0aGlzLm1heFdpZHRoID0gcGFyc2VJbnQoIHRoaXMuJGVsLmNzcygnbWF4LXdpZHRoJykgKTtcbiAgXG4gIHRoaXMuaW5pdCgpO1xuICBcbiAgLy9yZXNpemVcbiAgdGhpcy53aW5kb3dSZXNpemUoKTtcbiAgdGhpcy5yZXNpemVUaW1lciA9IGZhbHNlO1xuICB0aGlzLiR3aW5kb3cucmVzaXplKGZ1bmN0aW9uKCl7XG4gICAgaWYoIHNlbGYucmVzaXplVGltZXIgIT09IGZhbHNlICl7XG4gICAgICBjbGVhclRpbWVvdXQoc2VsZi5yZXNpemVUaW1lcik7XG4gICAgfVxuICAgIHNlbGYucmVzaXplVGltZXIgPSBzZXRUaW1lb3V0KCQucHJveHkoc2VsZi53aW5kb3dSZXNpemUsIHNlbGYpLCAwKTtcbiAgfSk7XG4gIFxuICAvL2F1dG9wbGF5XG4gIGlmKCAwIDwgdGhpcy5vcHRzLmludGVydmFsICl7XG4gICAgdGhpcy5hdXRvcGxheSgpO1xuICB9XG59XG5cblxubkNhcm91c2VsLnByb3RvdHlwZS5zZXRUb3VjaFRocmVzaG9sZCA9IGZ1bmN0aW9uKCl7XG4gIGlmKCAhdGhpcy5vcHRzLnN3aXBlICYmICF0aGlzLm9wdHMuZHJhZ2dhYmxlICkgcmV0dXJuIGZhbHNlO1xuICB0aGlzLnRvdWNoVGhyZXNob2xkID0gdGhpcy4kaXRlbS5vdXRlcldpZHRoKGZhbHNlKSAqICh0aGlzLm9wdHMudG91Y2hUaHJlc2hvbGRNYWduaWZpY2F0aW9uIC8gMTAwKTtcbn1cblxuXG5cbi8qXG4jIyBhdXRvcGxheVxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5hdXRvcGxheSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy50aWNrZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xuICAgIGlmKCAoIXNlbGYub3B0cy5wYXVzZVdpdGhNb3VzZWVudGVyIHx8ICFzZWxmLm1vdXNlZW50ZXIpICYmICFzZWxmLnN3aXBpbmcgKXtcbiAgICAgIHNlbGYuYW5pbWF0aW9uKCBzZWxmLmN1cnJlbnQgKyAxICk7XG4gICAgfVxuICB9LCB0aGlzLm9wdHMuaW50ZXJ2YWwpO1xufVxuXG5cblxuLypcbiMjIyB3aW5kb3cgcmVzaXplXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLndpbmRvd1Jlc2l6ZSA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMud2luZG93V2lkdGggPSB0aGlzLiR3aW5kb3cud2lkdGgoKTtcbiAgaWYoIHRoaXMubWF4V2lkdGggPCB0aGlzLndpbmRvd1dpZHRoICl7XG4gICAgaWYoIHRoaXMuYWN0aXZlUmVzcG9uc2l2ZSApIHtcbiAgICAgIHRoaXMuYWN0aXZlUmVzcG9uc2l2ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5yZXNldEl0ZW1XaWR0aCgnYXV0bycpO1xuICAgIH1cbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLmFjdGl2ZVJlc3BvbnNpdmUgPSB0cnVlO1xuICB0aGlzLnJlc2V0SXRlbVdpZHRoKCB0aGlzLiR2aWV3cG9ydC53aWR0aCgpICk7XG59XG5cblxuXG4vKlxuIyMjIHJlc2V0SXRlbVdpZHRoXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnJlc2V0SXRlbVdpZHRoID0gZnVuY3Rpb24oIHdpZHRoICl7XG4gIHRoaXMuJF9pdGVtLndpZHRoKHdpZHRoKTtcbiAgdGhpcy5pdGVtV2lkdGggPSB0aGlzLiRpdGVtLm91dGVyV2lkdGgodHJ1ZSk7XG4gIHRoaXMuaXRlbXNXaWR0aCA9IHRoaXMuaXRlbVdpZHRoICogdGhpcy4kaXRlbS5sZW5ndGg7XG4gIFxuICB0aGlzLiRpdGVtc1xuICAgIC5jc3Moe1xuICAgICAgbWFyZ2luTGVmdDogKHRoaXMub3B0cy5zdXJwbHVzICogLTEgKiB0aGlzLml0ZW1XaWR0aCAqIHRoaXMuY3VycmVudCkgKyB0aGlzLm1hcmdpbkNvcnJlY3RcbiAgICB9KTtcbiAgXG4gIHRoaXMuc2V0VG91Y2hUaHJlc2hvbGQoKTtcbn1cblxuXG5cbi8qXG4jIyMgaW5pdFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLiRlbC5hZGRDbGFzcygnbkNhcm91c2VsJyk7XG4gIFxuICBpZiggMSA+IHRoaXMuJGVsLmZpbmQoJy5uQ2Fyb3VzZWxfX3ZpZXdwb3J0JykubGVuZ3RoICl7XG4gICAgdGhpcy5iYWNrdXAuaHRtbCA9IHRoaXMuJGVsLmh0bWwoKTtcbiAgICB0aGlzLiRlbC5lbXB0eSgpO1xuICAgIHRoaXMuJGVsLmh0bWwoXG4gICAgICAnPGRpdiBjbGFzcz1cIm5DYXJvdXNlbF9fdmlld3BvcnRcIj4nXG4gICAgICArIHRoaXMuYmFja3VwLmh0bWxcbiAgICAgICsgJzwvZGl2PidcbiAgICApO1xuICB9XG4gIFxuICB0aGlzLiR2aWV3cG9ydCA9IHRoaXMuJGVsLmNoaWxkcmVuKCcubkNhcm91c2VsX192aWV3cG9ydCcpO1xuICB0aGlzLiRpdGVtcyA9IHRoaXMuJHZpZXdwb3J0LmNoaWxkcmVuKCk7XG4gIHRoaXMuJGl0ZW1zLmFkZENsYXNzKCduQ2Fyb3VzZWxfX2l0ZW1zJyk7XG4gIHRoaXMuJGl0ZW0gPSB0aGlzLiRpdGVtcy5jaGlsZHJlbigpO1xuICB0aGlzLiRpdGVtLmFkZENsYXNzKCduQ2Fyb3VzZWxfX2l0ZW0nKTtcbiAgXG4gIHRoaXMuaXRlbVdpZHRoID0gdGhpcy4kaXRlbS5vdXRlcldpZHRoKHRydWUpO1xuICB0aGlzLml0ZW1zV2lkdGggPSB0aGlzLml0ZW1XaWR0aCAqIHRoaXMuJGl0ZW0ubGVuZ3RoO1xuICBcbiAgdGhpcy5tYXJnaW5Db3JyZWN0ID0gcGFyc2VJbnQoIHRoaXMuJGl0ZW0uY3NzKCdtYXJnaW4tbGVmdCcpICkgKiAtMTtcbiAgXG4gIHRoaXMuJGl0ZW1zXG4gICAgLmNzcyh7XG4gICAgICBtYXJnaW5MZWZ0OiAodGhpcy5vcHRzLnN1cnBsdXMgKiAtMSAqIHRoaXMuaXRlbXNXaWR0aCkgKyB0aGlzLm1hcmdpbkNvcnJlY3RcbiAgICB9KTtcbiAgXG4gIGZvciggdmFyIGk9MDsgaSA8IHRoaXMub3B0cy5zdXJwbHVzICogMjsgaSsrICl7XG4gICAgdGhpcy4kaXRlbXMuYXBwZW5kKCB0aGlzLiRpdGVtLmNsb25lKCkgKTtcbiAgfVxuICB0aGlzLiRfaXRlbSA9IHRoaXMuJGl0ZW1zLmNoaWxkcmVuKCk7XG4gIFxuICB0aGlzLmN1cnJlbnQgPSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzO1xuICB0aGlzLiRlbC5hZGRDbGFzcyhcImlzLWN1cnJlbnQtXCIgKyAodGhpcy5jdXJyZW50IC0gdGhpcy4kaXRlbS5sZW5ndGggKiB0aGlzLm9wdHMuc3VycGx1cykpO1xuICBcbiAgLy9hcnJvd3NcbiAgdGhpcy4kdmlld3BvcnQuYXBwZW5kKFxuICAgICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX19hcnJvdyBuQ2Fyb3VzZWxfX3ByZXZcIj48L2Rpdj4nICsgXG4gICAgJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX2Fycm93IG5DYXJvdXNlbF9fbmV4dFwiPjwvZGl2PidcbiAgKTtcbiAgdGhpcy4kcHJldiA9IHRoaXMuJHZpZXdwb3J0LmNoaWxkcmVuKCcubkNhcm91c2VsX19wcmV2Jyk7XG4gIHRoaXMuJG5leHQgPSB0aGlzLiR2aWV3cG9ydC5jaGlsZHJlbignLm5DYXJvdXNlbF9fbmV4dCcpO1xuICB0aGlzLmFycm93VmlzaWJpbGl0aWVzKCk7XG4gIFxuICAvL2FkZCBwb2ludGVyc1xuICBpZih0aGlzLm9wdHMucG9pbnRlcnMpe1xuICAgIHZhciBwb2ludGVyc0hUTUwgPSAnPGRpdiBjbGFzcz1cIm5DYXJvdXNlbF9fcG9pbnRlcnNcIj4nO1xuICAgIGZvciggdmFyIGk9MDsgaTx0aGlzLiRpdGVtLmxlbmd0aDsgaSsrICl7XG4gICAgICBwb2ludGVyc0hUTUwgKz0gJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3BvaW50ZXJcIj48L2Rpdj4nXG4gICAgfVxuICAgIHBvaW50ZXJzSFRNTCArPSAnPC9kaXY+JztcbiAgICB0aGlzLiRlbC5hcHBlbmQocG9pbnRlcnNIVE1MKTtcbiAgICB0aGlzLiRwb2ludGVyID0gdGhpcy4kZWwuZmluZCgnLm5DYXJvdXNlbF9fcG9pbnRlcicpO1xuICAgIHRoaXMuJHBvaW50ZXIuZXEoMCkuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICAgIHRoaXMuJGVsLm9uKCdjbGljaycsICcubkNhcm91c2VsX19wb2ludGVyJywgZnVuY3Rpb24oZSl7XG4gICAgICB2YXIgaW5kZXggPSBzZWxmLiRwb2ludGVyLmluZGV4KHRoaXMpLFxuICAgICAgICAgIG5leHQgID0gaW5kZXggKyBzZWxmLiRpdGVtLmxlbmd0aCAqIHNlbGYub3B0cy5zdXJwbHVzO1xuICAgICAgc2VsZi5hbmltYXRpb24oIG5leHQgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgfVxuICBcbiAgdGhpcy5zZXRUb3VjaFRocmVzaG9sZCgpO1xuICB0aGlzLnNldFN3aXBlRXZlbnQoKTtcbn1cblxuXG5cbi8qXG4jIyMgYW5pbWF0aW9uXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLmFuaW1hdGlvbiA9IGZ1bmN0aW9uKCBuZXh0ICl7XG4gIGlmKCB0aGlzLmxvY2sgKSByZXR1cm4gZmFsc2U7XG4gIFxuICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICByZXN1bHQgPSB0cnVlLFxuICAgICAgZHVyYXRpb24gPSB0aGlzLm9wdHMuZHVyYXRpb24sXG4gICAgICBlYXNpbmcgPSB0aGlzLm9wdHMuZWFzaW5nO1xuICBcbiAgdGhpcy5sb2NrID0gdHJ1ZTtcbiAgXG4gIGlmKCAwID09PSB0aGlzLm9wdHMuc3VycGx1cyApIHtcbiAgICBpZiggbmV4dCA8IDAgfHwgdGhpcy4kaXRlbS5sZW5ndGggLSAxIDwgbmV4dCApIHJlc3VsdCA9IGZhbHNlO1xuICB9XG4gIFxuICB0aGlzLiRlbC5yZW1vdmVDbGFzcyhcImlzLWN1cnJlbnQtXCIgKyAodGhpcy5jdXJyZW50IC0gdGhpcy4kaXRlbS5sZW5ndGggKiB0aGlzLm9wdHMuc3VycGx1cykpO1xuICBcbiAgaWYoIHJlc3VsdCApIHtcbiAgICBcbiAgICB0aGlzLmN1cnJlbnQgPSBuZXh0O1xuICAgIGlmKCBzZWxmLmN1cnJlbnQgPCBzZWxmLiRpdGVtLmxlbmd0aCAqIHNlbGYub3B0cy5zdXJwbHVzICkge1xuICAgICAgc2VsZi5jdXJyZW50ICs9IHNlbGYuJGl0ZW0ubGVuZ3RoO1xuICAgIH0gZWxzZSBpZiggc2VsZi5jdXJyZW50ID49IHNlbGYuJGl0ZW0ubGVuZ3RoICogKHNlbGYub3B0cy5zdXJwbHVzICsgMSkgKSB7XG4gICAgICBzZWxmLmN1cnJlbnQgLT0gc2VsZi4kaXRlbS5sZW5ndGg7XG4gICAgfVxuICAgIFxuICB9IGVsc2Uge1xuICAgIFxuICAgIGlmKCBuZXh0IDwgMCApIHtcbiAgICAgIG5leHQgPSAwO1xuICAgIH0gZWxzZSBpZiggdGhpcy4kaXRlbS5sZW5ndGggLSAxIDwgbmV4dCApIHtcbiAgICAgIG5leHQgPSB0aGlzLiRpdGVtLmxlbmd0aCAtIDE7XG4gICAgfVxuICAgIGVhc2luZyA9ICdsaW5lYXInO1xuICAgIFxuICB9XG4gIFxuICBpZih0aGlzLm9wdHMucG9pbnRlcnMpe1xuICAgIHNlbGYucG9pbnRlckFjdGl2ZSgpO1xuICB9XG4gIFxuICB0aGlzLiRpdGVtcy5zdG9wKHRydWUsZmFsc2UpLmFuaW1hdGUoe1xuICAgICdtYXJnaW5MZWZ0Jzogc2VsZi5pdGVtV2lkdGggKiBuZXh0ICogLTEgKyB0aGlzLm1hcmdpbkNvcnJlY3RcbiAgfSwgZHVyYXRpb24sIGVhc2luZywgZnVuY3Rpb24oKXtcbiAgICBzZWxmLiRpdGVtcy5jc3MoJ21hcmdpbkxlZnQnLCBzZWxmLml0ZW1XaWR0aCAqIHNlbGYuY3VycmVudCAqIC0xICsgc2VsZi5tYXJnaW5Db3JyZWN0KTtcbiAgICBzZWxmLmxvY2sgPSBmYWxzZTtcbiAgfSk7XG4gIFxuICB0aGlzLmFycm93VmlzaWJpbGl0aWVzKCk7XG4gIFxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5cblxuLypcbiMjIyBhcnJvdyB2aXNpYmlsaXRpZXNcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuYXJyb3dWaXNpYmlsaXRpZXMgPSBmdW5jdGlvbigpe1xuICBpZiggMCA9PT0gdGhpcy5vcHRzLnN1cnBsdXMgKSB7XG4gICAgaWYoIDAgPT0gdGhpcy5jdXJyZW50ICkge1xuICAgICAgdGhpcy4kcHJldi5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuJHByZXYuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICB9XG4gICAgaWYoIHRoaXMuY3VycmVudCA9PSB0aGlzLiRpdGVtLmxlbmd0aCAtIDEgKSB7XG4gICAgICB0aGlzLiRuZXh0LmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4kbmV4dC5jc3MoJ2Rpc3BsYXknLCdibG9jaycpO1xuICAgIH1cbiAgfVxufVxuXG5cblxuLypcbiMjIyBwb2ludGVyIGFjdGl2ZVxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5wb2ludGVyQWN0aXZlID0gZnVuY3Rpb24oKXtcbiAgdGhpcy4kcG9pbnRlci5maWx0ZXIoJy5pcy1hY3RpdmUnKS5yZW1vdmVDbGFzcygnaXMtYWN0aXZlJyk7XG4gIHRoaXMuJHBvaW50ZXIuZXEodGhpcy5jdXJyZW50IC0gdGhpcy4kaXRlbS5sZW5ndGggKiB0aGlzLm9wdHMuc3VycGx1cykuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpO1xufVxuXG5cblxuLypcbiMjIyBzd2lwZVxuKi9cblxuLypcbiMjIyMgc2V0IHN3aXBlIGV2ZW50XG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnNldFN3aXBlRXZlbnQgPSBmdW5jdGlvbigpe1xuICBcbiAgdGhpcy4kaXRlbXMuZmluZChcImFcIikuY2xpY2soZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2V9KTtcbiAgXG4gIC8vc3dpcGVcbiAgaWYoIHRoaXMub3B0cy5zd2lwZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbigndG91Y2hzdGFydC5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVTdGFydCwgdGhpcykpO1xuICB9XG4gIFxuICAvL2RyYWdnYWJsZVxuICBpZiggdGhpcy5vcHRzLmRyYWdnYWJsZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2Vkb3duLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZVN0YXJ0LCB0aGlzKSk7XG4gIH1cbn1cblxuLypcbiMjIyMgc3dpcGUgc3RhcnRcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc3dpcGVTdGFydCA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgaWYoIHRoaXMubG9jayApIHJldHVybiBmYWxzZTtcbiAgdGhpcy5zd2lwaW5nID0gdHJ1ZTtcbiAgXG4gIHZhciBwb3MgPSBQb3NpdGlvbihldmVudCk7XG4gIHRoaXMudG91Y2hTdGFydFggPSBwb3MueDtcbiAgdGhpcy50b3VjaE1vdmVYID0gcG9zLng7XG4gIHRoaXMudG91Y2hTdGFydEl0ZW1zTWFyZ2luTGVmdCA9IHBhcnNlSW50KCB0aGlzLiRpdGVtcy5jc3MoJ21hcmdpbkxlZnQnKSApO1xuICBcbiAgLy9vbiBtb3ZlICYgZW5kXG4gIGlmKCB0aGlzLm9wdHMuc3dpcGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub24oJ3RvdWNobW92ZS5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVNb3ZlLCB0aGlzKSk7XG4gICAgdGhpcy4kaXRlbXMub24oJ3RvdWNoZW5kLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICAgIHRoaXMuJGl0ZW1zLm9uKCd0b3VjaGNhbmNlbC5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVFbmQsIHRoaXMpKTtcbiAgfVxuICBpZiggdGhpcy5vcHRzLmRyYWdnYWJsZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2Vtb3ZlLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZU1vdmUsIHRoaXMpKTtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2V1cC5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVFbmQsIHRoaXMpKTtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2VsZWF2ZS5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVFbmQsIHRoaXMpKTtcbiAgfVxufVxuXG4vKlxuIyMjIyBzd2lwZSBtb3ZlXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnN3aXBlTW92ZSA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgdmFyIHBvcyA9IFBvc2l0aW9uKGV2ZW50KTtcbiAgdGhpcy50b3VjaE1vdmVYID0gcG9zLng7XG4gIHZhciBkaWZmWCA9IHRoaXMudG91Y2hNb3ZlWCAtIHRoaXMudG91Y2hTdGFydFg7XG4gIHRoaXMuJGl0ZW1zLmNzcygnbWFyZ2luTGVmdCcsIHRoaXMudG91Y2hTdGFydEl0ZW1zTWFyZ2luTGVmdCArIGRpZmZYKTtcbn1cblxuLypcbiMjIyMgc3dpcGUgZW5kXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnN3aXBlRW5kID0gZnVuY3Rpb24oZXZlbnQpe1xuICB0aGlzLnN3aXBpbmcgPSBmYWxzZTtcbiAgXG4gIC8vb2ZmIG1vdmUgJiBlbmRcbiAgaWYoIHRoaXMub3B0cy5zd2lwZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ3RvdWNobW92ZS5uY2Fyb3VzZWwnKTtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ3RvdWNoZW5kLm5jYXJvdXNlbCcpO1xuICAgIHRoaXMuJGl0ZW1zLm9mZigndG91Y2hjYW5jZWwubmNhcm91c2VsJyk7XG4gIH1cbiAgaWYoIHRoaXMub3B0cy5kcmFnZ2FibGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCdtb3VzZW1vdmUubmNhcm91c2VsJyk7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCdtb3VzZXVwLm5jYXJvdXNlbCcpO1xuICAgIHRoaXMuJGl0ZW1zLm9mZignbW91c2VsZWF2ZS5uY2Fyb3VzZWwnKTtcbiAgfVxuICBcbiAgdmFyIHJlc3VsdCA9IHRoaXMuY3VycmVudDtcbiAgaWYoIHRoaXMudG91Y2hNb3ZlWCAtIHRoaXMudG91Y2hUaHJlc2hvbGQgPiB0aGlzLnRvdWNoU3RhcnRYICkge1xuICAgIHJlc3VsdCA9IHRoaXMuY3VycmVudCAtIDE7XG4gIH0gZWxzZSBpZiggdGhpcy50b3VjaE1vdmVYICsgdGhpcy50b3VjaFRocmVzaG9sZCA8IHRoaXMudG91Y2hTdGFydFggKSB7XG4gICAgcmVzdWx0ID0gdGhpcy5jdXJyZW50ICsgMTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgaHJlZiA9ICQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KFwiYVwiKS5hdHRyKFwiaHJlZlwiKTtcbiAgICBpZihocmVmICE9IHVuZGVmaW5lZCkge1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBocmVmO1xuICAgIH1cbiAgfVxuICB0aGlzLmFuaW1hdGlvbiggcmVzdWx0ICk7XG4gIFxuICAvL3Jlc2V0XG4gIHRoaXMudG91Y2hTdGFydFggPSAtMTtcbiAgdGhpcy50b3VjaE1vdmVYID0gLTE7XG4gIHRoaXMudG91Y2hTdGFydEl0ZW1zTWFyZ2luTGVmdCA9IC0xO1xufVxuIiwifSkoalF1ZXJ5LCB0aGlzLCB0aGlzLmRvY3VtZW50KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
