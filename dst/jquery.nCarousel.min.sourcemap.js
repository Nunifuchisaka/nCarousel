/*!
  
  jquery.nCarousel.js
  
  Version: 0.1.0
  Author: Nunifuchisaka(nunifuchisaka@gmail.com)
  Website: http://nunifuchisaka.com/w/n-carousel/demo
  Repository: https://github.com/Nunifuchisaka/nCarousel
  
*/
!function(t,i,s,e){"use strict";function h(t){var i=t.pageX?t.pageX:t.originalEvent.touches[0].pageX,s=t.pageY?t.pageY:t.originalEvent.touches[0].pageY;return i=Math.floor(i),s=Math.floor(s),{x:i,y:s}}function o(s){var e=this;this.opts=t.extend({duration:400,easing:"swing",surplus:1,interval:0,swipe:!0,draggable:!0,pointers:!0,touchThresholdMagnification:10},s),this.backup={},this.lock=!1,this.activeResponsive=!1,this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1,this.touchThreshold=0,this.$window=t(i),this.$el=t(s.el),this.backup.html=this.$el.html(),this.$el.empty(),this.$parent=this.$el.parent(),this.$el.on("click",".nCarousel__prev",function(){return e.animation(e.current-1),!1}).on("click",".nCarousel__next",function(){return e.animation(e.current+1),!1}),this.maxWidth=parseInt(this.$el.css("max-width")),this.init(),this.windowResize(),this.resizeTimer=!1,this.$window.resize(function(){e.resizeTimer!==!1&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(t.proxy(e.windowResize,e),100)}),0<this.opts.interval&&(this.ticker=setInterval(function(){e.animation(e.current+1)},this.opts.interval))}t.fn.nCarousel=function(i){return this.each(function(s,e){i=t.extend({i:s,el:e},i),new o(i)})},o.prototype.setTouchThreshold=function(){return!(!this.opts.swipe&&!this.opts.draggable)&&void(this.touchThreshold=this.$item.outerWidth(!1)*(this.opts.touchThresholdMagnification/100))},o.prototype.windowResize=function(){if(this.windowWidth=this.$window.width(),this.maxWidth<this.$window.width())return void(this.activeResponsive&&(this.activeResponsive=!1,this.resetItemWidth("auto")));this.activeResponsive=!0,this.resetItemWidth(this.$parent.width())},o.prototype.resetItemWidth=function(t){this.$_item.width(t),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.$items.css({marginLeft:this.opts.surplus*-1*this.itemWidth*this.current+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth}),this.setTouchThreshold()},o.prototype.init=function(){var t=this;this.$el.addClass("nCarousel"),this.$el.html('<div class="nCarousel__viewport"><div class="nCarousel__items">'+this.backup.html+"</div></div>"),this.$viewport=this.$el.children(".nCarousel__viewport"),this.$items=this.$viewport.children(".nCarousel__items"),this.$item=this.$items.children(),this.$item.addClass("nCarousel__item"),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.marginCorrect=parseInt(this.$item.css("margin-left"))*-1,this.$items.css({marginLeft:this.opts.surplus*-1*this.itemsWidth+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth});for(var i=0;i<2*this.opts.surplus;i++)this.$items.append(this.$item.clone());if(this.$_item=this.$items.children(),this.current=this.$item.length*this.opts.surplus,this.$viewport.append('<div class="nCarousel__arrow nCarousel__prev"></div><div class="nCarousel__arrow nCarousel__next"></div>'),this.$prev=this.$viewport.children(".nCarousel__prev"),this.$next=this.$viewport.children(".nCarousel__next"),this.arrowVisibilities(),this.opts.pointers){for(var s='<div class="nCarousel__pointers">',i=0;i<this.$item.length;i++)s+='<div class="nCarousel__pointer"></div>';s+="</div>",this.$el.append(s),this.$pointer=this.$el.find(".nCarousel__pointer"),this.$pointer.eq(0).addClass("is-active"),this.$el.on("click",".nCarousel__pointer",function(i){var s=t.$pointer.index(this),e=s+t.$item.length*t.opts.surplus;return t.animation(e),!1})}this.setTouchThreshold(),this.setSwipeEvent()},o.prototype.animation=function(t){if(this.lock)return!1;var i=this,s=!0,e=this.opts.duration,h=this.opts.easing;return this.lock=!0,0===this.opts.surplus&&(t<0||this.$item.length-1<t)&&(s=!1),s?(this.current=t,i.current<i.$item.length*i.opts.surplus?i.current+=i.$item.length:i.current>=i.$item.length*(i.opts.surplus+1)&&(i.current-=i.$item.length)):(t<0?t=0:this.$item.length-1<t&&(t=this.$item.length-1),h="linear"),this.opts.pointers&&i.pointerActive(),this.$items.stop(!0,!1).animate({marginLeft:i.itemWidth*t*-1+this.marginCorrect},e,h,function(){i.$items.css("marginLeft",i.itemWidth*i.current*-1+i.marginCorrect),i.lock=!1}),this.arrowVisibilities(),s},o.prototype.arrowVisibilities=function(){0===this.opts.surplus&&(0==this.current?this.$prev.css("display","none"):this.$prev.css("display","block"),this.current==this.$item.length-1?this.$next.css("display","none"):this.$next.css("display","block"))},o.prototype.pointerActive=function(){this.$pointer.filter(".is-active").removeClass("is-active"),this.$pointer.eq(this.current-this.$item.length*this.opts.surplus).addClass("is-active")},o.prototype.setSwipeEvent=function(){this.opts.swipe&&this.$items.on("touchstart.ncarousel",t.proxy(this.swipeStart,this)),this.opts.draggable&&this.$items.on("mousedown.ncarousel",t.proxy(this.swipeStart,this))},o.prototype.swipeStart=function(i){if(i.preventDefault(),this.lock)return!1;var s=h(i);this.touchStartX=s.x,this.touchMoveX=s.x,this.touchStartItemsMarginLeft=parseInt(this.$items.css("marginLeft")),this.opts.swipe&&(this.$items.on("touchmove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("touchend.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("touchcancel.ncarousel",t.proxy(this.swipeEnd,this))),this.opts.draggable&&(this.$items.on("mousemove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("mouseup.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("mouseleave.ncarousel",t.proxy(this.swipeEnd,this)))},o.prototype.swipeMove=function(t){t.preventDefault();var i=h(t);this.touchMoveX=i.x;var s=this.touchMoveX-this.touchStartX;this.$items.css("marginLeft",this.touchStartItemsMarginLeft+s)},o.prototype.swipeEnd=function(t){this.opts.swipe&&(this.$items.off("touchmove.ncarousel"),this.$items.off("touchend.ncarousel"),this.$items.off("touchcancel.ncarousel")),this.opts.draggable&&(this.$items.off("mousemove.ncarousel"),this.$items.off("mouseup.ncarousel"),this.$items.off("mouseleave.ncarousel"));var i=this.current;this.touchMoveX-this.touchThreshold>this.touchStartX?i=this.current-1:this.touchMoveX+this.touchThreshold<this.touchStartX&&(i=this.current+1),this.animation(i),this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1}}(jQuery,this,this.document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjExMF9oZWFkZXIuanMiLCI0MTBfVmlldy5qcyIsIjk5MF9mb290ZXIuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiUG9zaXRpb24iLCJlIiwieCIsInBhZ2VYIiwib3JpZ2luYWxFdmVudCIsInRvdWNoZXMiLCJ5IiwicGFnZVkiLCJNYXRoIiwiZmxvb3IiLCJuQ2Fyb3VzZWwiLCJvcHRzIiwic2VsZiIsInRoaXMiLCJleHRlbmQiLCJkdXJhdGlvbiIsImVhc2luZyIsInN1cnBsdXMiLCJpbnRlcnZhbCIsInN3aXBlIiwiZHJhZ2dhYmxlIiwicG9pbnRlcnMiLCJ0b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb24iLCJiYWNrdXAiLCJsb2NrIiwiYWN0aXZlUmVzcG9uc2l2ZSIsInRvdWNoU3RhcnRYIiwidG91Y2hNb3ZlWCIsInRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQiLCJ0b3VjaFRocmVzaG9sZCIsIiR3aW5kb3ciLCIkZWwiLCJlbCIsImh0bWwiLCJlbXB0eSIsIiRwYXJlbnQiLCJwYXJlbnQiLCJvbiIsImFuaW1hdGlvbiIsImN1cnJlbnQiLCJtYXhXaWR0aCIsInBhcnNlSW50IiwiY3NzIiwiaW5pdCIsIndpbmRvd1Jlc2l6ZSIsInJlc2l6ZVRpbWVyIiwicmVzaXplIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInByb3h5IiwidGlja2VyIiwic2V0SW50ZXJ2YWwiLCJmbiIsImVhY2giLCJpIiwicHJvdG90eXBlIiwic2V0VG91Y2hUaHJlc2hvbGQiLCIkaXRlbSIsIm91dGVyV2lkdGgiLCJ3aW5kb3dXaWR0aCIsIndpZHRoIiwicmVzZXRJdGVtV2lkdGgiLCIkX2l0ZW0iLCJpdGVtV2lkdGgiLCJpdGVtc1dpZHRoIiwibGVuZ3RoIiwiJGl0ZW1zIiwibWFyZ2luTGVmdCIsIm1hcmdpbkNvcnJlY3QiLCJhZGRDbGFzcyIsIiR2aWV3cG9ydCIsImNoaWxkcmVuIiwiYXBwZW5kIiwiY2xvbmUiLCIkcHJldiIsIiRuZXh0IiwiYXJyb3dWaXNpYmlsaXRpZXMiLCJwb2ludGVyc0hUTUwiLCIkcG9pbnRlciIsImZpbmQiLCJlcSIsImluZGV4IiwibmV4dCIsInNldFN3aXBlRXZlbnQiLCJyZXN1bHQiLCJwb2ludGVyQWN0aXZlIiwic3RvcCIsImFuaW1hdGUiLCJmaWx0ZXIiLCJyZW1vdmVDbGFzcyIsInN3aXBlU3RhcnQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwicG9zIiwic3dpcGVNb3ZlIiwic3dpcGVFbmQiLCJkaWZmWCIsIm9mZiIsImpRdWVyeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztDQVVBLFNBQUFBLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsWUNPQSxTQUFBQyxHQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUEsTUFBQUEsRUFBQUUsTUFBQUYsRUFBQUcsY0FBQUMsUUFBQSxHQUFBRixNQUNBRyxFQUFBTCxFQUFBLE1BQUFBLEVBQUFNLE1BQUFOLEVBQUFHLGNBQUFDLFFBQUEsR0FBQUUsS0FHQSxPQUZBTCxHQUFBTSxLQUFBQyxNQUFBUCxHQUNBSSxFQUFBRSxLQUFBQyxNQUFBSCxJQUNBSixFQUFBQSxFQUFBSSxFQUFBQSxHQVNBLFFBQUFJLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsSUFDQUEsTUFBQUYsS0FBQWYsRUFBQWtCLFFBQ0FDLFNBQUEsSUFDQUMsT0FBQSxRQUNBQyxRQUFBLEVBQ0FDLFNBQUEsRUFDQUMsT0FBQSxFQUNBQyxXQUFBLEVBQ0FDLFVBQUEsRUFDQUMsNEJBQUEsSUFDQVgsR0FFQUUsS0FBQVUsVUFDQVYsS0FBQVcsTUFBQSxFQUNBWCxLQUFBWSxrQkFBQSxFQUVBWixLQUFBYSxlQUNBYixLQUFBYyxjQUNBZCxLQUFBZSw2QkFDQWYsS0FBQWdCLGVBQUEsRUFFQWhCLEtBQUFpQixRQUFBbEMsRUFBQUMsR0FDQWdCLEtBQUFrQixJQUFBbkMsRUFBQWUsRUFBQXFCLElBQ0FuQixLQUFBVSxPQUFBVSxLQUFBcEIsS0FBQWtCLElBQUFFLE9BQ0FwQixLQUFB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Z0JBQ0EsSUFBQUMsR0FBQTdGLEVBQUEyRixFQUNBOUUsTUFBQWMsV0FBQWtFLEVBQUEzRixDQUNBLElBQUE4RixHQUFBbkYsS0FBQWMsV0FBQWQsS0FBQWEsV0FDQWIsTUFBQXFELE9BQUF4QixJQUFBLGFBQUE3QixLQUFBZSwwQkFBQW9FLElBT0F0RixFQUFBNkMsVUFBQXdDLFNBQUEsU0FBQUosR0FFQTlFLEtBQUFGLEtBQUFRLFFBQ0FOLEtBQUFxRCxPQUFBK0IsSUFBQSx1QkFDQXBGLEtBQUFxRCxPQUFBK0IsSUFBQSxzQkFDQXBGLEtBQUFxRCxPQUFBK0IsSUFBQSwwQkFFQXBGLEtBQUFGLEtBQUFTLFlBQ0FQLEtBQUFxRCxPQUFBK0IsSUFBQSx1QkFDQXBGLEtBQUFxRCxPQUFBK0IsSUFBQSxxQkFDQXBGLEtBQUFxRCxPQUFBK0IsSUFBQSx3QkFHQSxJQUFBYixHQUFBdkUsS0FBQTBCLE9BQ0ExQixNQUFBYyxXQUFBZCxLQUFBZ0IsZUFBQWhCLEtBQUFhLFlBQ0EwRCxFQUFBdkUsS0FBQTBCLFFBQUEsRUFDQTFCLEtBQUFjLFdBQUFkLEtBQUFnQixlQUFBaEIsS0FBQWEsY0FDQTBELEVBQUF2RSxLQUFBMEIsUUFBQSxHQUVBMUIsS0FBQXlCLFVBQUE4QyxHQUdBdkUsS0FBQWEsZUFDQWIsS0FBQWMsY0FDQWQsS0FBQWUsK0JDcFlBc0UsT0FBQXJGLEtBQUFBLEtBQUFmIiwiZmlsZSI6ImpxdWVyeS5uQ2Fyb3VzZWwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gIFxuICBqcXVlcnkubkNhcm91c2VsLmpzXG4gIFxuICBWZXJzaW9uOiAwLjEuMFxuICBBdXRob3I6IE51bmlmdWNoaXNha2EobnVuaWZ1Y2hpc2FrYUBnbWFpbC5jb20pXG4gIFdlYnNpdGU6IGh0dHA6Ly9udW5pZnVjaGlzYWthLmNvbS93L24tY2Fyb3VzZWwvZGVtb1xuICBSZXBvc2l0b3J5OiBodHRwczovL2dpdGh1Yi5jb20vTnVuaWZ1Y2hpc2FrYS9uQ2Fyb3VzZWxcbiAgXG4qL1xuOyhmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpe1xuJ3VzZSBzdHJpY3QnO1xuIiwiLy9cbiQuZm4ubkNhcm91c2VsID0gZnVuY3Rpb24oIG9wdHMgKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBcbiAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiggaSwgZWwgKXtcbiAgICBvcHRzID0gJC5leHRlbmQoe1xuICAgICAgaTogaSxcbiAgICAgIGVsOiBlbFxuICAgIH0sIG9wdHMpO1xuICAgIG5ldyBuQ2Fyb3VzZWwob3B0cyk7XG4gIH0pO1xufVxuXG5cbi8qXG4jIyBmdW5jdGlvbnNcbiovXG5cbmZ1bmN0aW9uIFBvc2l0aW9uKGUpe1xuICB2YXIgeCA9IChlLnBhZ2VYKT9lLnBhZ2VYOmUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VYO1xuICB2YXIgeSA9IChlLnBhZ2VZKT9lLnBhZ2VZOmUub3JpZ2luYWxFdmVudC50b3VjaGVzWzBdLnBhZ2VZO1xuICB4ID0gTWF0aC5mbG9vcih4KTtcbiAgeSA9IE1hdGguZmxvb3IoeSk7XG4gIHJldHVybiB7J3gnOnggLCAneSc6eX07XG59XG5cblxuXG4vKlxuIyMgbkNhcm91c2VsXG4qL1xuXG5mdW5jdGlvbiBuQ2Fyb3VzZWwoIG9wdHMgKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5vcHRzID0gJC5leHRlbmQoe1xuICAgIGR1cmF0aW9uOiA0MDAsXG4gICAgZWFzaW5nOiAnc3dpbmcnLFxuICAgIHN1cnBsdXM6IDEsXG4gICAgaW50ZXJ2YWw6IDAsXG4gICAgc3dpcGU6IHRydWUsXG4gICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgIHBvaW50ZXJzOiB0cnVlLFxuICAgIHRvdWNoVGhyZXNob2xkTWFnbmlmaWNhdGlvbjogMTBcbiAgfSwgb3B0cyk7XG4gIFxuICB0aGlzLmJhY2t1cCA9IHt9O1xuICB0aGlzLmxvY2sgPSBmYWxzZTtcbiAgdGhpcy5hY3RpdmVSZXNwb25zaXZlID0gZmFsc2U7XG4gIFxuICB0aGlzLnRvdWNoU3RhcnRYID0gLTE7XG4gIHRoaXMudG91Y2hNb3ZlWCA9IC0xO1xuICB0aGlzLnRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQgPSAtMTtcbiAgdGhpcy50b3VjaFRocmVzaG9sZCA9IDA7XG4gIFxuICB0aGlzLiR3aW5kb3cgPSAkKHdpbmRvdyk7XG4gIHRoaXMuJGVsID0gJChvcHRzLmVsKTtcbiAgdGhpcy5iYWNrdXAuaHRtbCA9IHRoaXMuJGVsLmh0bWwoKTtcbiAgdGhpcy4kZWwuZW1wdHkoKTtcbiAgXG4gIHRoaXMuJHBhcmVudCA9IHRoaXMuJGVsLnBhcmVudCgpO1xuICBcbiAgdGhpcy4kZWxcbiAgICAub24oJ2NsaWNrJywgJy5uQ2Fyb3VzZWxfX3ByZXYnLCBmdW5jdGlvbigpe1xuICAgICAgc2VsZi5hbmltYXRpb24oIHNlbGYuY3VycmVudCAtIDEgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KVxuICAgIC5vbignY2xpY2snLCAnLm5DYXJvdXNlbF9fbmV4dCcsIGZ1bmN0aW9uKCl7XG4gICAgICBzZWxmLmFuaW1hdGlvbiggc2VsZi5jdXJyZW50ICsgMSApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICBcbiAgdGhpcy5tYXhXaWR0aCA9IHBhcnNlSW50KCB0aGlzLiRlbC5jc3MoJ21heC13aWR0aCcpICk7XG4gIFxuICB0aGlzLmluaXQoKTtcbiAgXG4gIC8vcmVzaXplXG4gIHRoaXMud2luZG93UmVzaXplKCk7XG4gIHRoaXMucmVzaXplVGltZXIgPSBmYWxzZTtcbiAgdGhpcy4kd2luZG93LnJlc2l6ZShmdW5jdGlvbigpe1xuICAgIGlmKCBzZWxmLnJlc2l6ZVRpbWVyICE9PSBmYWxzZSApe1xuICAgICAgY2xlYXJUaW1lb3V0KHNlbGYucmVzaXplVGltZXIpO1xuICAgIH1cbiAgICBzZWxmLnJlc2l6ZVRpbWVyID0gc2V0VGltZW91dCgkLnByb3h5KHNlbGYud2luZG93UmVzaXplLCBzZWxmKSwgMTAwKTtcbiAgfSk7XG4gIFxuICAvL2F1dG9wbGF5XG4gIGlmKCAwIDwgdGhpcy5vcHRzLmludGVydmFsICkge1xuICAgIHRoaXMudGlja2VyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcbiAgICAgIHNlbGYuYW5pbWF0aW9uKCBzZWxmLmN1cnJlbnQgKyAxICk7XG4gICAgfSwgdGhpcy5vcHRzLmludGVydmFsKTtcbiAgfVxufVxuXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc2V0VG91Y2hUaHJlc2hvbGQgPSBmdW5jdGlvbigpe1xuICBpZiggIXRoaXMub3B0cy5zd2lwZSAmJiAhdGhpcy5vcHRzLmRyYWdnYWJsZSApIHJldHVybiBmYWxzZTtcbiAgXG4gIHRoaXMudG91Y2hUaHJlc2hvbGQgPSB0aGlzLiRpdGVtLm91dGVyV2lkdGgoZmFsc2UpICogKHRoaXMub3B0cy50b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb24gLyAxMDApO1xufVxuXG5cblxuLypcbiMjIyB3aW5kb3cgcmVzaXplXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLndpbmRvd1Jlc2l6ZSA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMud2luZG93V2lkdGggPSB0aGlzLiR3aW5kb3cud2lkdGgoKTtcbiAgaWYoIHRoaXMubWF4V2lkdGggPCB0aGlzLiR3aW5kb3cud2lkdGgoKSApe1xuICAgIGlmKCB0aGlzLmFjdGl2ZVJlc3BvbnNpdmUgKSB7XG4gICAgICB0aGlzLmFjdGl2ZVJlc3BvbnNpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMucmVzZXRJdGVtV2lkdGgoJ2F1dG8nKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5hY3RpdmVSZXNwb25zaXZlID0gdHJ1ZTtcbiAgdGhpcy5yZXNldEl0ZW1XaWR0aCggdGhpcy4kcGFyZW50LndpZHRoKCkgKTtcbn1cblxuXG5cbi8qXG4jIyMgcmVzZXRJdGVtV2lkdGhcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUucmVzZXRJdGVtV2lkdGggPSBmdW5jdGlvbiggd2lkdGggKXtcbiAgdGhpcy4kX2l0ZW0ud2lkdGgod2lkdGgpO1xuICB0aGlzLml0ZW1XaWR0aCA9IHRoaXMuJGl0ZW0ub3V0ZXJXaWR0aCh0cnVlKTtcbiAgdGhpcy5pdGVtc1dpZHRoID0gdGhpcy5pdGVtV2lkdGggKiB0aGlzLiRpdGVtLmxlbmd0aDtcbiAgXG4gIHRoaXMuJGl0ZW1zXG4gICAgLmNzcyh7XG4gICAgICBtYXJnaW5MZWZ0OiAodGhpcy5vcHRzLnN1cnBsdXMgKiAtMSAqIHRoaXMuaXRlbVdpZHRoICogdGhpcy5jdXJyZW50KSArIHRoaXMubWFyZ2luQ29ycmVjdCxcbiAgICAgIHdpZHRoOiAodGhpcy5vcHRzLnN1cnBsdXMgKiAyICsgMSkgKiB0aGlzLml0ZW1zV2lkdGhcbiAgICB9KTtcbiAgXG4gIHRoaXMuc2V0VG91Y2hUaHJlc2hvbGQoKTtcbn1cblxuXG5cbi8qXG4jIyMgaW5pdFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLiRlbC5hZGRDbGFzcygnbkNhcm91c2VsJyk7XG4gIHRoaXMuJGVsLmh0bWwoXG4gICAgJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3ZpZXdwb3J0XCI+J1xuICAgICsgJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX2l0ZW1zXCI+J1xuICAgICsgdGhpcy5iYWNrdXAuaHRtbFxuICAgICsgJzwvZGl2PidcbiAgICArICc8L2Rpdj4nXG4gICk7XG4gIFxuICB0aGlzLiR2aWV3cG9ydCA9IHRoaXMuJGVsLmNoaWxkcmVuKCcubkNhcm91c2VsX192aWV3cG9ydCcpO1xuICB0aGlzLiRpdGVtcyA9IHRoaXMuJHZpZXdwb3J0LmNoaWxkcmVuKCcubkNhcm91c2VsX19pdGVtcycpO1xuICB0aGlzLiRpdGVtID0gdGhpcy4kaXRlbXMuY2hpbGRyZW4oKTtcbiAgdGhpcy4kaXRlbS5hZGRDbGFzcygnbkNhcm91c2VsX19pdGVtJyk7XG4gIFxuICB0aGlzLml0ZW1XaWR0aCA9IHRoaXMuJGl0ZW0ub3V0ZXJXaWR0aCh0cnVlKTtcbiAgdGhpcy5pdGVtc1dpZHRoID0gdGhpcy5pdGVtV2lkdGggKiB0aGlzLiRpdGVtLmxlbmd0aDtcbiAgXG4gIHRoaXMubWFyZ2luQ29ycmVjdCA9IHBhcnNlSW50KCB0aGlzLiRpdGVtLmNzcygnbWFyZ2luLWxlZnQnKSApICogLTE7XG4gIFxuICB0aGlzLiRpdGVtc1xuICAgIC5jc3Moe1xuICAgICAgbWFyZ2luTGVmdDogKHRoaXMub3B0cy5zdXJwbHVzICogLTEgKiB0aGlzLml0ZW1zV2lkdGgpICsgdGhpcy5tYXJnaW5Db3JyZWN0LFxuICAgICAgd2lkdGg6ICh0aGlzLm9wdHMuc3VycGx1cyAqIDIgKyAxKSAqIHRoaXMuaXRlbXNXaWR0aFxuICAgIH0pO1xuICBcbiAgZm9yKCB2YXIgaT0wOyBpIDwgdGhpcy5vcHRzLnN1cnBsdXMgKiAyOyBpKysgKXtcbiAgICB0aGlzLiRpdGVtcy5hcHBlbmQoIHRoaXMuJGl0ZW0uY2xvbmUoKSApO1xuICB9XG4gIHRoaXMuJF9pdGVtID0gdGhpcy4kaXRlbXMuY2hpbGRyZW4oKTtcbiAgXG4gIHRoaXMuY3VycmVudCA9IHRoaXMuJGl0ZW0ubGVuZ3RoICogdGhpcy5vcHRzLnN1cnBsdXM7XG4gIFxuICAvL2Fycm93c1xuICB0aGlzLiR2aWV3cG9ydC5hcHBlbmQoXG4gICAgJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX2Fycm93IG5DYXJvdXNlbF9fcHJldlwiPjwvZGl2PicgKyBcbiAgICAnPGRpdiBjbGFzcz1cIm5DYXJvdXNlbF9fYXJyb3cgbkNhcm91c2VsX19uZXh0XCI+PC9kaXY+J1xuICApO1xuICB0aGlzLiRwcmV2ID0gdGhpcy4kdmlld3BvcnQuY2hpbGRyZW4oJy5uQ2Fyb3VzZWxfX3ByZXYnKTtcbiAgdGhpcy4kbmV4dCA9IHRoaXMuJHZpZXdwb3J0LmNoaWxkcmVuKCcubkNhcm91c2VsX19uZXh0Jyk7XG4gIHRoaXMuYXJyb3dWaXNpYmlsaXRpZXMoKTtcbiAgXG4gIC8vYWRkIHBvaW50ZXJzXG4gIGlmKHRoaXMub3B0cy5wb2ludGVycyl7XG4gICAgdmFyIHBvaW50ZXJzSFRNTCA9ICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX19wb2ludGVyc1wiPic7XG4gICAgZm9yKCB2YXIgaT0wOyBpPHRoaXMuJGl0ZW0ubGVuZ3RoOyBpKysgKXtcbiAgICAgIHBvaW50ZXJzSFRNTCArPSAnPGRpdiBjbGFzcz1cIm5DYXJvdXNlbF9fcG9pbnRlclwiPjwvZGl2PidcbiAgICB9XG4gICAgcG9pbnRlcnNIVE1MICs9ICc8L2Rpdj4nO1xuICAgIHRoaXMuJGVsLmFwcGVuZChwb2ludGVyc0hUTUwpO1xuICAgIHRoaXMuJHBvaW50ZXIgPSB0aGlzLiRlbC5maW5kKCcubkNhcm91c2VsX19wb2ludGVyJyk7XG4gICAgdGhpcy4kcG9pbnRlci5lcSgwKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgdGhpcy4kZWwub24oJ2NsaWNrJywgJy5uQ2Fyb3VzZWxfX3BvaW50ZXInLCBmdW5jdGlvbihlKXtcbiAgICAgIHZhciBpbmRleCA9IHNlbGYuJHBvaW50ZXIuaW5kZXgodGhpcyksXG4gICAgICAgICAgbmV4dCAgPSBpbmRleCArIHNlbGYuJGl0ZW0ubGVuZ3RoICogc2VsZi5vcHRzLnN1cnBsdXM7XG4gICAgICBzZWxmLmFuaW1hdGlvbiggbmV4dCApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICB9XG4gIFxuICB0aGlzLnNldFRvdWNoVGhyZXNob2xkKCk7XG4gIHRoaXMuc2V0U3dpcGVFdmVudCgpO1xufVxuXG5cblxuLypcbiMjIyBhbmltYXRpb25cbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuYW5pbWF0aW9uID0gZnVuY3Rpb24oIG5leHQgKXtcbiAgaWYoIHRoaXMubG9jayApIHJldHVybiBmYWxzZTtcbiAgXG4gIHZhciBzZWxmID0gdGhpcyxcbiAgICAgIHJlc3VsdCA9IHRydWUsXG4gICAgICBkdXJhdGlvbiA9IHRoaXMub3B0cy5kdXJhdGlvbixcbiAgICAgIGVhc2luZyA9IHRoaXMub3B0cy5lYXNpbmc7XG4gIFxuICB0aGlzLmxvY2sgPSB0cnVlO1xuICBcbiAgaWYoIDAgPT09IHRoaXMub3B0cy5zdXJwbHVzICkge1xuICAgIGlmKCBuZXh0IDwgMCB8fCB0aGlzLiRpdGVtLmxlbmd0aCAtIDEgPCBuZXh0ICkgcmVzdWx0ID0gZmFsc2U7XG4gIH1cbiAgXG4gIGlmKCByZXN1bHQgKSB7XG4gICAgXG4gICAgdGhpcy5jdXJyZW50ID0gbmV4dDtcbiAgICBpZiggc2VsZi5jdXJyZW50IDwgc2VsZi4kaXRlbS5sZW5ndGggKiBzZWxmLm9wdHMuc3VycGx1cyApIHtcbiAgICAgIHNlbGYuY3VycmVudCArPSBzZWxmLiRpdGVtLmxlbmd0aDtcbiAgICB9IGVsc2UgaWYoIHNlbGYuY3VycmVudCA+PSBzZWxmLiRpdGVtLmxlbmd0aCAqIChzZWxmLm9wdHMuc3VycGx1cyArIDEpICkge1xuICAgICAgc2VsZi5jdXJyZW50IC09IHNlbGYuJGl0ZW0ubGVuZ3RoO1xuICAgIH1cbiAgICBcbiAgfSBlbHNlIHtcbiAgICBcbiAgICBpZiggbmV4dCA8IDAgKSB7XG4gICAgICBuZXh0ID0gMDtcbiAgICB9IGVsc2UgaWYoIHRoaXMuJGl0ZW0ubGVuZ3RoIC0gMSA8IG5leHQgKSB7XG4gICAgICBuZXh0ID0gdGhpcy4kaXRlbS5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBlYXNpbmcgPSAnbGluZWFyJztcbiAgICBcbiAgfVxuICBcbiAgaWYodGhpcy5vcHRzLnBvaW50ZXJzKXtcbiAgICBzZWxmLnBvaW50ZXJBY3RpdmUoKTtcbiAgfVxuICBcbiAgdGhpcy4kaXRlbXMuc3RvcCh0cnVlLGZhbHNlKS5hbmltYXRlKHtcbiAgICAnbWFyZ2luTGVmdCc6IHNlbGYuaXRlbVdpZHRoICogbmV4dCAqIC0xICsgdGhpcy5tYXJnaW5Db3JyZWN0XG4gIH0sIGR1cmF0aW9uLCBlYXNpbmcsIGZ1bmN0aW9uKCl7XG4gICAgc2VsZi4kaXRlbXMuY3NzKCdtYXJnaW5MZWZ0Jywgc2VsZi5pdGVtV2lkdGggKiBzZWxmLmN1cnJlbnQgKiAtMSArIHNlbGYubWFyZ2luQ29ycmVjdCk7XG4gICAgc2VsZi5sb2NrID0gZmFsc2U7XG4gIH0pO1xuICBcbiAgdGhpcy5hcnJvd1Zpc2liaWxpdGllcygpO1xuICBcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG5cbi8qXG4jIyMgYXJyb3cgdmlzaWJpbGl0aWVzXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLmFycm93VmlzaWJpbGl0aWVzID0gZnVuY3Rpb24oKXtcbiAgaWYoIDAgPT09IHRoaXMub3B0cy5zdXJwbHVzICkge1xuICAgIGlmKCAwID09IHRoaXMuY3VycmVudCApIHtcbiAgICAgIHRoaXMuJHByZXYuY3NzKCdkaXNwbGF5Jywnbm9uZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRwcmV2LmNzcygnZGlzcGxheScsJ2Jsb2NrJyk7XG4gICAgfVxuICAgIGlmKCB0aGlzLmN1cnJlbnQgPT0gdGhpcy4kaXRlbS5sZW5ndGggLSAxICkge1xuICAgICAgdGhpcy4kbmV4dC5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuJG5leHQuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICB9XG4gIH1cbn1cblxuXG5cbi8qXG4jIyMgcG9pbnRlciBhY3RpdmVcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUucG9pbnRlckFjdGl2ZSA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMuJHBvaW50ZXIuZmlsdGVyKCcuaXMtYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICB0aGlzLiRwb2ludGVyLmVxKHRoaXMuY3VycmVudCAtIHRoaXMuJGl0ZW0ubGVuZ3RoICogdGhpcy5vcHRzLnN1cnBsdXMpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbn1cblxuXG5cbi8qXG4jIyMgc3dpcGVcbiovXG5cbi8qXG4jIyMjIHNldCBzd2lwZSBldmVudFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5zZXRTd2lwZUV2ZW50ID0gZnVuY3Rpb24oKXtcbiAgXG4gIC8vc3dpcGVcbiAgaWYoIHRoaXMub3B0cy5zd2lwZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbigndG91Y2hzdGFydC5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVTdGFydCwgdGhpcykpO1xuICB9XG4gIFxuICAvL2RyYWdnYWJsZVxuICBpZiggdGhpcy5vcHRzLmRyYWdnYWJsZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2Vkb3duLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZVN0YXJ0LCB0aGlzKSk7XG4gIH1cbn1cblxuLypcbiMjIyMgc3dpcGUgc3RhcnRcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc3dpcGVTdGFydCA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgaWYoIHRoaXMubG9jayApIHJldHVybiBmYWxzZTtcbiAgXG4gIHZhciBwb3MgPSBQb3NpdGlvbihldmVudCk7XG4gIHRoaXMudG91Y2hTdGFydFggPSBwb3MueDtcbiAgdGhpcy50b3VjaE1vdmVYID0gcG9zLng7XG4gIHRoaXMudG91Y2hTdGFydEl0ZW1zTWFyZ2luTGVmdCA9IHBhcnNlSW50KCB0aGlzLiRpdGVtcy5jc3MoJ21hcmdpbkxlZnQnKSApO1xuICBcbiAgLy9vbiBtb3ZlICYgZW5kXG4gIGlmKCB0aGlzLm9wdHMuc3dpcGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub24oJ3RvdWNobW92ZS5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVNb3ZlLCB0aGlzKSk7XG4gICAgdGhpcy4kaXRlbXMub24oJ3RvdWNoZW5kLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICAgIHRoaXMuJGl0ZW1zLm9uKCd0b3VjaGNhbmNlbC5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVFbmQsIHRoaXMpKTtcbiAgfVxuICBpZiggdGhpcy5vcHRzLmRyYWdnYWJsZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2Vtb3ZlLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZU1vdmUsIHRoaXMpKTtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2V1cC5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVFbmQsIHRoaXMpKTtcbiAgICB0aGlzLiRpdGVtcy5vbignbW91c2VsZWF2ZS5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVFbmQsIHRoaXMpKTtcbiAgfVxufVxuXG4vKlxuIyMjIyBzd2lwZSBtb3ZlXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnN3aXBlTW92ZSA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgdmFyIHBvcyA9IFBvc2l0aW9uKGV2ZW50KTtcbiAgdGhpcy50b3VjaE1vdmVYID0gcG9zLng7XG4gIHZhciBkaWZmWCA9IHRoaXMudG91Y2hNb3ZlWCAtIHRoaXMudG91Y2hTdGFydFg7XG4gIHRoaXMuJGl0ZW1zLmNzcygnbWFyZ2luTGVmdCcsIHRoaXMudG91Y2hTdGFydEl0ZW1zTWFyZ2luTGVmdCArIGRpZmZYKTtcbn1cblxuLypcbiMjIyMgc3dpcGUgZW5kXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnN3aXBlRW5kID0gZnVuY3Rpb24oZXZlbnQpe1xuICAvL29mZiBtb3ZlICYgZW5kXG4gIGlmKCB0aGlzLm9wdHMuc3dpcGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCd0b3VjaG1vdmUubmNhcm91c2VsJyk7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCd0b3VjaGVuZC5uY2Fyb3VzZWwnKTtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ3RvdWNoY2FuY2VsLm5jYXJvdXNlbCcpO1xuICB9XG4gIGlmKCB0aGlzLm9wdHMuZHJhZ2dhYmxlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9mZignbW91c2Vtb3ZlLm5jYXJvdXNlbCcpO1xuICAgIHRoaXMuJGl0ZW1zLm9mZignbW91c2V1cC5uY2Fyb3VzZWwnKTtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ21vdXNlbGVhdmUubmNhcm91c2VsJyk7XG4gIH1cbiAgXG4gIHZhciByZXN1bHQgPSB0aGlzLmN1cnJlbnQ7XG4gIGlmKCB0aGlzLnRvdWNoTW92ZVggLSB0aGlzLnRvdWNoVGhyZXNob2xkID4gdGhpcy50b3VjaFN0YXJ0WCApIHtcbiAgICByZXN1bHQgPSB0aGlzLmN1cnJlbnQgLSAxO1xuICB9IGVsc2UgaWYoIHRoaXMudG91Y2hNb3ZlWCArIHRoaXMudG91Y2hUaHJlc2hvbGQgPCB0aGlzLnRvdWNoU3RhcnRYICkge1xuICAgIHJlc3VsdCA9IHRoaXMuY3VycmVudCArIDE7XG4gIH1cbiAgdGhpcy5hbmltYXRpb24oIHJlc3VsdCApO1xuICBcbiAgLy9yZXNldFxuICB0aGlzLnRvdWNoU3RhcnRYID0gLTE7XG4gIHRoaXMudG91Y2hNb3ZlWCA9IC0xO1xuICB0aGlzLnRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQgPSAtMTtcbn1cbiIsIn0pKGpRdWVyeSwgdGhpcywgdGhpcy5kb2N1bWVudCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
