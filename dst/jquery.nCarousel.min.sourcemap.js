/*!
  
  jquery.nCarousel.js
  
  Version: 0.1.0
  Author: Nunifuchisaka(nunifuchisaka@gmail.com)
  Website: http://nunifuchisaka.com/w/n-carousel/demo
  Repository: https://github.com/Nunifuchisaka/nCarousel
  
*/
!function(t,i,s,e){"use strict";function h(t){var i=t.pageX?t.pageX:t.originalEvent.touches[0].pageX,s=t.pageY?t.pageY:t.originalEvent.touches[0].pageY;return i=Math.floor(i),s=Math.floor(s),{x:i,y:s}}function o(s){var e=this;this.opts=t.extend({duration:400,easing:"swing",thumbnail:!1,surplus:1,interval:0,swipe:!0,draggable:!0,pointers:!0,touchThresholdMagnification:10,pauseWithMouseenter:!0},s),this.backup={},this.lock=!1,this.activeResponsive=!1,this.mouseenter=!1,this.swiping=!1,this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1,this.touchThreshold=0,this.$window=t(i),this.$el=t(s.el),this.$parent=this.$el.parent(),this.$el.on("click",".nCarousel__prev",function(){return e.animation(e.current-1),!1}).on("click",".nCarousel__next",function(){return e.animation(e.current+1),!1}).on({mouseenter:function(){e.mouseenter=!0},mouseleave:function(){e.mouseenter=!1}}),this.maxWidth=parseInt(this.$el.css("max-width")),this.init(),this.windowResize(),this.resizeTimer=!1,this.$window.resize(function(){e.resizeTimer!==!1&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(t.proxy(e.windowResize,e),0)}),0<this.opts.interval&&this.autoplay()}t.fn.nCarousel=function(i){return this.each(function(s,e){var h=t.extend({i:s,el:e},i);new o(h)})},o.prototype.setTouchThreshold=function(){return!(!this.opts.swipe&&!this.opts.draggable)&&void(this.touchThreshold=this.$item.outerWidth(!1)*(this.opts.touchThresholdMagnification/100))},o.prototype.autoplay=function(){var t=this;this.ticker=setInterval(function(){t.opts.pauseWithMouseenter&&t.mouseenter||t.swiping||t.animation(t.current+1)},this.opts.interval)},o.prototype.windowResize=function(){if(this.windowWidth=this.$window.width(),this.maxWidth<this.windowWidth)return void(this.activeResponsive&&(this.activeResponsive=!1,this.resetItemWidth("auto")));this.activeResponsive=!0,this.resetItemWidth(this.$viewport.width())},o.prototype.resetItemWidth=function(t){this.$_item.width(t),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.$items.css({marginLeft:this.opts.surplus*-1*this.itemWidth*this.current+this.marginCorrect}),this.setTouchThreshold()},o.prototype.init=function(){var t=this;this.$el.addClass("nCarousel"),1>this.$el.find(".nCarousel__viewport").length&&(this.backup.html=this.$el.html(),this.$el.empty(),this.$el.html('<div class="nCarousel__viewport">'+this.backup.html+"</div>")),this.$viewport=this.$el.children(".nCarousel__viewport"),this.$items=this.$viewport.children(),this.$items.addClass("nCarousel__items"),this.$item=this.$items.children(),this.$item.addClass("nCarousel__item"),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.marginCorrect=parseInt(this.$item.css("margin-left"))*-1,this.$items.css({marginLeft:this.opts.surplus*-1*this.itemsWidth+this.marginCorrect});for(var i=0;i<2*this.opts.surplus;i++)this.$items.append(this.$item.clone());if(this.$_item=this.$items.children(),this.current=this.$item.length*this.opts.surplus,this.$el.addClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),this.$viewport.append('<div class="nCarousel__arrow nCarousel__prev"></div><div class="nCarousel__arrow nCarousel__next"></div>'),this.$prev=this.$viewport.children(".nCarousel__prev"),this.$next=this.$viewport.children(".nCarousel__next"),this.arrowVisibilities(),this.opts.pointers){for(var s='<div class="nCarousel__pointers">',i=1;i<=this.$item.length;i++)s+='<div class="nCarousel__pointer">'+i+"</div>";s+="</div>",this.$el.append(s),this.$pointer=this.$el.find(".nCarousel__pointer"),this.$pointer.eq(0).addClass("is-active"),this.$el.on("click",".nCarousel__pointer",function(i){var s=t.$pointer.index(this),e=s+t.$item.length*t.opts.surplus;return t.animation(e),!1})}this.setTouchThreshold(),this.setSwipeEvent()},o.prototype.animation=function(t){if(this.lock)return!1;var i=this,s=!0,e=this.opts.duration,h=this.opts.easing;return this.lock=!0,0===this.opts.surplus&&(t<0||this.$item.length-1<t)&&(s=!1),this.$el.removeClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),s?(this.current=t,i.current<i.$item.length*i.opts.surplus?i.current+=i.$item.length:i.current>=i.$item.length*(i.opts.surplus+1)&&(i.current-=i.$item.length)):(t<0?t=0:this.$item.length-1<t&&(t=this.$item.length-1),h="linear"),this.opts.pointers&&i.pointerActive(),this.$items.stop(!0,!1).animate({marginLeft:i.itemWidth*t*-1+this.marginCorrect},e,h,function(){i.$items.css("marginLeft",i.itemWidth*i.current*-1+i.marginCorrect),i.lock=!1}),this.arrowVisibilities(),s},o.prototype.arrowVisibilities=function(){0===this.opts.surplus&&(0==this.current?this.$prev.css("display","none"):this.$prev.css("display","block"),this.current==this.$item.length-1?this.$next.css("display","none"):this.$next.css("display","block"))},o.prototype.pointerActive=function(){this.$pointer.filter(".is-active").removeClass("is-active"),this.$pointer.eq(this.current-this.$item.length*this.opts.surplus).addClass("is-active")},o.prototype.setSwipeEvent=function(){this.$items.find("a").click(function(){return!1}),this.opts.swipe&&this.$items.on("touchstart.ncarousel",t.proxy(this.swipeStart,this)),this.opts.draggable&&this.$items.on("mousedown.ncarousel",t.proxy(this.swipeStart,this))},o.prototype.swipeStart=function(i){if(i.preventDefault(),this.lock)return!1;this.swiping=!0;var s=h(i);this.touchStartX=s.x,this.touchMoveX=s.x,this.touchStartItemsMarginLeft=parseInt(this.$items.css("marginLeft")),this.opts.swipe&&(this.$items.on("touchmove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("touchend.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("touchcancel.ncarousel",t.proxy(this.swipeEnd,this))),this.opts.draggable&&(this.$items.on("mousemove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("mouseup.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("mouseleave.ncarousel",t.proxy(this.swipeEnd,this)))},o.prototype.swipeMove=function(t){t.preventDefault();var i=h(t);this.touchMoveX=i.x;var s=this.touchMoveX-this.touchStartX;this.$items.css("marginLeft",this.touchStartItemsMarginLeft+s)},o.prototype.swipeEnd=function(s){this.swiping=!1,this.opts.swipe&&(this.$items.off("touchmove.ncarousel"),this.$items.off("touchend.ncarousel"),this.$items.off("touchcancel.ncarousel")),this.opts.draggable&&(this.$items.off("mousemove.ncarousel"),this.$items.off("mouseup.ncarousel"),this.$items.off("mouseleave.ncarousel"));var h=this.current;if(this.touchMoveX-this.touchThreshold>this.touchStartX)h=this.current-1;else if(this.touchMoveX+this.touchThreshold<this.touchStartX)h=this.current+1;else{var o=t(s.target).closest("a").attr("href");o!=e&&(i.location.href=o)}this.animation(h),this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1}}(jQuery,this,this.document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjExMF9oZWFkZXIuanMiLCI0MTBfVmlldy5qcyIsIjk5MF9mb290ZXIuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiUG9zaXRpb24iLCJlIiwieCIsInBhZ2VYIiwib3JpZ2luYWxFdmVudCIsInRvdWNoZXMiLCJ5IiwicGFnZVkiLCJNYXRoIiwiZmxvb3IiLCJuQ2Fyb3VzZWwiLCJvcHRzIiwic2VsZiIsInRoaXMiLCJleHRlbmQiLCJkdXJhdGlvbiIsImVhc2luZyIsInRodW1ibmFpbCIsInN1cnBsdXMiLCJpbnRlcnZhbCIsInN3aXBlIiwiZHJhZ2dhYmxlIiwicG9pbnRlcnMiLCJ0b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb24iLCJwYXVzZVdpdGhNb3VzZWVudGVyIiwiYmFja3VwIiwibG9jayIsImFjdGl2ZVJlc3BvbnNpdmUiLCJtb3VzZWVudGVyIiwic3dpcGluZyIsInRvdWNoU3RhcnRYIiwidG91Y2hNb3ZlWCIsInRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQiLCJ0b3VjaFRocmVzaG9sZCIsIiR3aW5kb3ciLCIkZWwiLCJlbCIsIiRwYXJlbnQiLCJwYXJlbnQiLCJvbiIsImFuaW1hdGlvbiIsImN1cnJlbnQiLCJtb3VzZWxlYXZlIiwibWF4V2lkdGgiLCJwYXJzZUludCIsImNzcyIsImluaXQiLCJ3aW5kb3dSZXNpemUiLCJyZXNpemVUaW1lciIsInJlc2l6ZSIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJwcm94eSIsImF1dG9wbGF5IiwiZm4iLCJlYWNoIiwiaSIsIl9vcHRzIiwicHJvdG90eXBlIiwic2V0VG91Y2hUaHJlc2hvbGQiLCIkaXRlbSIsIm91dGVyV2lkdGgiLCJ0aWNrZXIiLCJzZXRJbnRlcnZhbCIsIndpbmRvd1dpZHRoIiwid2lkdGgiLCJyZXNldEl0ZW1XaWR0aCIsIiR2aWV3cG9ydCIsIiRfaXRlbSIsIml0ZW1XaWR0aCIsIml0ZW1zV2lkdGgiLCJsZW5ndGgiLCIkaXRlbXMiLCJtYXJnaW5MZWZ0IiwibWFyZ2luQ29ycmVjdCIsImFkZENsYXNzIiwiZmluZCIsImh0bWwiLCJlbXB0eSIsImNoaWxkcmVuIiwiYXBwZW5kIiwiY2xvbmUiLCIkcHJldiIsIiRuZXh0IiwiYXJyb3dWaXNpYmlsaXRpZXMiLCJwb2ludGVyc0hUTUwiLCIkcG9pbnRlciIsImVxIiwiaW5kZXgiLCJuZXh0Iiwic2V0U3dpcGVFdmVudCIsInJlc3VsdCIsInJlbW92ZUNsYXNzIiwicG9pbnRlckFjdGl2ZSIsInN0b3AiLCJhbmltYXRlIiwiZmlsdGVyIiwiY2xpY2siLCJzd2lwZVN0YXJ0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInBvcyIsInN3aXBlTW92ZSIsInN3aXBlRW5kIiwiZGlmZlgiLCJvZmYiLCJocmVmIiwidGFyZ2V0IiwiY2xvc2VzdCIsImF0dHIiLCJsb2NhdGlvbiIsImpRdWVyeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztDQVVBLFNBQUFBLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsWUNNQSxTQUFBQyxHQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUEsTUFBQUEsRUFBQUUsTUFBQUYsRUFBQUcsY0FBQUMsUUFBQSxHQUFBRixNQUNBRyxFQUFBTCxFQUFBLE1BQUFBLEVBQUFNLE1BQUFOLEVBQUFHLGNBQUFDLFFBQUEsR0FBQUUsS0FHQSxPQUZBTCxHQUFBTSxLQUFBQyxNQUFBUCxHQUNBSSxFQUFBRSxLQUFBQyxNQUFBSCxJQUNBSixFQUFBQSxFQUFBSSxFQUFBQSxHQVNBLFFBQUFJLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsSUFDQUEsTUFBQUYsS0FBQWYsRUFBQWtCLFFBQ0FDLFNBQUEsSUFDQUMsT0FBQSxRQUNBQyxXQUFBLEVBQ0FDLFFBQUEsRUFDQUMsU0FBQSxFQUNBQyxPQUFBLEVBQ0FDLFdBQUEsRUFDQUMsVUFBQSxFQUNBQyw0QkFBQSxHQUNBQyxxQkFBQSxHQUNBYixHQU1BRSxLQUFBWSxVQUNBWixLQUFBYSxNQUFBLEVBQ0FiLEtBQUFjLGtCQUFBLEVB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MkQsT0FBQWlDLElBQUEsdUJBQ0E1RixLQUFBMkQsT0FBQWlDLElBQUEscUJBQ0E1RixLQUFBMkQsT0FBQWlDLElBQUEsd0JBR0EsSUFBQWQsR0FBQTlFLEtBQUE0QixPQUNBLElBQUE1QixLQUFBa0IsV0FBQWxCLEtBQUFvQixlQUFBcEIsS0FBQWlCLFlBQ0E2RCxFQUFBOUUsS0FBQTRCLFFBQUEsTUFDQSxJQUFBNUIsS0FBQWtCLFdBQUFsQixLQUFBb0IsZUFBQXBCLEtBQUFpQixZQUNBNkQsRUFBQTlFLEtBQUE0QixRQUFBLE1BQ0EsQ0FDQSxHQUFBaUUsR0FBQTlHLEVBQUF1RyxFQUFBUSxRQUFBQyxRQUFBLEtBQUFDLEtBQUEsT0FDQUgsSUFBQTNHLElBQ0FGLEVBQUFpSCxTQUFBSixLQUFBQSxHQUdBN0YsS0FBQTJCLFVBQUFtRCxHQUdBOUUsS0FBQWlCLGVBQ0FqQixLQUFBa0IsY0FDQWxCLEtBQUFtQiwrQkN2YUErRSxPQUFBbEcsS0FBQUEsS0FBQWYiLCJmaWxlIjoianF1ZXJ5Lm5DYXJvdXNlbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAgXG4gIGpxdWVyeS5uQ2Fyb3VzZWwuanNcbiAgXG4gIFZlcnNpb246IDAuMS4wXG4gIEF1dGhvcjogTnVuaWZ1Y2hpc2FrYShudW5pZnVjaGlzYWthQGdtYWlsLmNvbSlcbiAgV2Vic2l0ZTogaHR0cDovL251bmlmdWNoaXNha2EuY29tL3cvbi1jYXJvdXNlbC9kZW1vXG4gIFJlcG9zaXRvcnk6IGh0dHBzOi8vZ2l0aHViLmNvbS9OdW5pZnVjaGlzYWthL25DYXJvdXNlbFxuICBcbiovXG47KGZ1bmN0aW9uKCQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCl7XG4ndXNlIHN0cmljdCc7XG4iLCIvL1xuJC5mbi5uQ2Fyb3VzZWwgPSBmdW5jdGlvbiggb3B0cyApe1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oIGksIGVsICl7XG4gICAgdmFyIF9vcHRzID0gJC5leHRlbmQoe1xuICAgICAgaTogaSxcbiAgICAgIGVsOiBlbFxuICAgIH0sIG9wdHMpO1xuICAgIG5ldyBuQ2Fyb3VzZWwoX29wdHMpO1xuICB9KTtcbn1cblxuXG4vKlxuIyMgZnVuY3Rpb25zXG4qL1xuXG5mdW5jdGlvbiBQb3NpdGlvbihlKXtcbiAgdmFyIHggPSAoZS5wYWdlWCk/ZS5wYWdlWDplLm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXS5wYWdlWDtcbiAgdmFyIHkgPSAoZS5wYWdlWSk/ZS5wYWdlWTplLm9yaWdpbmFsRXZlbnQudG91Y2hlc1swXS5wYWdlWTtcbiAgeCA9IE1hdGguZmxvb3IoeCk7XG4gIHkgPSBNYXRoLmZsb29yKHkpO1xuICByZXR1cm4geyd4Jzp4ICwgJ3knOnl9O1xufVxuXG5cblxuLypcbiMjIG5DYXJvdXNlbFxuKi9cblxuZnVuY3Rpb24gbkNhcm91c2VsKCBvcHRzICkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMub3B0cyA9ICQuZXh0ZW5kKHtcbiAgICBkdXJhdGlvbjogNDAwLFxuICAgIGVhc2luZzogXCJzd2luZ1wiLFxuICAgIHRodW1ibmFpbDogZmFsc2UsXG4gICAgc3VycGx1czogMSxcbiAgICBpbnRlcnZhbDogMCxcbiAgICBzd2lwZTogdHJ1ZSxcbiAgICBkcmFnZ2FibGU6IHRydWUsXG4gICAgcG9pbnRlcnM6IHRydWUsXG4gICAgdG91Y2hUaHJlc2hvbGRNYWduaWZpY2F0aW9uOiAxMCxcbiAgICBwYXVzZVdpdGhNb3VzZWVudGVyOiB0cnVlXG4gIH0sIG9wdHMpO1xuICBcbiAgLypcbiAgcGF1c2VXaXRoTW91c2VlbnRlcu+8muODnuOCpuOCueOCqOODs+OCv+ODvOOBp+S4gOaZguWBnOatolxuICAqL1xuICBcbiAgdGhpcy5iYWNrdXAgPSB7fTtcbiAgdGhpcy5sb2NrID0gZmFsc2U7XG4gIHRoaXMuYWN0aXZlUmVzcG9uc2l2ZSA9IGZhbHNlO1xuICBcbiAgdGhpcy5tb3VzZWVudGVyID0gZmFsc2U7XG4gIHRoaXMuc3dpcGluZyA9IGZhbHNlO1xuICB0aGlzLnRvdWNoU3RhcnRYID0gLTE7XG4gIHRoaXMudG91Y2hNb3ZlWCA9IC0xO1xuICB0aGlzLnRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQgPSAtMTtcbiAgdGhpcy50b3VjaFRocmVzaG9sZCA9IDA7XG4gIFxuICB0aGlzLiR3aW5kb3cgPSAkKHdpbmRvdyk7XG4gIHRoaXMuJGVsID0gJChvcHRzLmVsKTtcbiAgdGhpcy4kcGFyZW50ID0gdGhpcy4kZWwucGFyZW50KCk7XG4gIFxuICB0aGlzLiRlbFxuICAgIC5vbignY2xpY2snLCAnLm5DYXJvdXNlbF9fcHJldicsIGZ1bmN0aW9uKCl7XG4gICAgICBzZWxmLmFuaW1hdGlvbiggc2VsZi5jdXJyZW50IC0gMSApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pXG4gICAgLm9uKCdjbGljaycsICcubkNhcm91c2VsX19uZXh0JywgZnVuY3Rpb24oKXtcbiAgICAgIHNlbGYuYW5pbWF0aW9uKCBzZWxmLmN1cnJlbnQgKyAxICk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSlcbiAgICAub24oe1xuICAgICAgJ21vdXNlZW50ZXInOiBmdW5jdGlvbigpeyBzZWxmLm1vdXNlZW50ZXIgPSB0cnVlIH0sXG4gICAgICAnbW91c2VsZWF2ZSc6IGZ1bmN0aW9uKCl7IHNlbGYubW91c2VlbnRlciA9IGZhbHNlIH1cbiAgICB9KTtcbiAgXG4gIHRoaXMubWF4V2lkdGggPSBwYXJzZUludCggdGhpcy4kZWwuY3NzKCdtYXgtd2lkdGgnKSApO1xuICBcbiAgdGhpcy5pbml0KCk7XG4gIFxuICAvL3Jlc2l6ZVxuICB0aGlzLndpbmRvd1Jlc2l6ZSgpO1xuICB0aGlzLnJlc2l6ZVRpbWVyID0gZmFsc2U7XG4gIHRoaXMuJHdpbmRvdy5yZXNpemUoZnVuY3Rpb24oKXtcbiAgICBpZiggc2VsZi5yZXNpemVUaW1lciAhPT0gZmFsc2UgKXtcbiAgICAgIGNsZWFyVGltZW91dChzZWxmLnJlc2l6ZVRpbWVyKTtcbiAgICB9XG4gICAgc2VsZi5yZXNpemVUaW1lciA9IHNldFRpbWVvdXQoJC5wcm94eShzZWxmLndpbmRvd1Jlc2l6ZSwgc2VsZiksIDApO1xuICB9KTtcbiAgXG4gIC8vYXV0b3BsYXlcbiAgaWYoIDAgPCB0aGlzLm9wdHMuaW50ZXJ2YWwgKXtcbiAgICB0aGlzLmF1dG9wbGF5KCk7XG4gIH1cbn1cblxuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnNldFRvdWNoVGhyZXNob2xkID0gZnVuY3Rpb24oKXtcbiAgaWYoICF0aGlzLm9wdHMuc3dpcGUgJiYgIXRoaXMub3B0cy5kcmFnZ2FibGUgKSByZXR1cm4gZmFsc2U7XG4gIHRoaXMudG91Y2hUaHJlc2hvbGQgPSB0aGlzLiRpdGVtLm91dGVyV2lkdGgoZmFsc2UpICogKHRoaXMub3B0cy50b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb24gLyAxMDApO1xufVxuXG5cblxuLypcbiMjIGF1dG9wbGF5XG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLmF1dG9wbGF5ID0gZnVuY3Rpb24oKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLnRpY2tlciA9IHNldEludGVydmFsKGZ1bmN0aW9uKCl7XG4gICAgaWYoICghc2VsZi5vcHRzLnBhdXNlV2l0aE1vdXNlZW50ZXIgfHwgIXNlbGYubW91c2VlbnRlcikgJiYgIXNlbGYuc3dpcGluZyApe1xuICAgICAgc2VsZi5hbmltYXRpb24oIHNlbGYuY3VycmVudCArIDEgKTtcbiAgICB9XG4gIH0sIHRoaXMub3B0cy5pbnRlcnZhbCk7XG59XG5cblxuXG4vKlxuIyMjIHdpbmRvdyByZXNpemVcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUud2luZG93UmVzaXplID0gZnVuY3Rpb24oKXtcbiAgdGhpcy53aW5kb3dXaWR0aCA9IHRoaXMuJHdpbmRvdy53aWR0aCgpO1xuICBpZiggdGhpcy5tYXhXaWR0aCA8IHRoaXMud2luZG93V2lkdGggKXtcbiAgICBpZiggdGhpcy5hY3RpdmVSZXNwb25zaXZlICkge1xuICAgICAgdGhpcy5hY3RpdmVSZXNwb25zaXZlID0gZmFsc2U7XG4gICAgICB0aGlzLnJlc2V0SXRlbVdpZHRoKCdhdXRvJyk7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMuYWN0aXZlUmVzcG9uc2l2ZSA9IHRydWU7XG4gIHRoaXMucmVzZXRJdGVtV2lkdGgoIHRoaXMuJHZpZXdwb3J0LndpZHRoKCkgKTtcbn1cblxuXG5cbi8qXG4jIyMgcmVzZXRJdGVtV2lkdGhcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUucmVzZXRJdGVtV2lkdGggPSBmdW5jdGlvbiggd2lkdGggKXtcbiAgdGhpcy4kX2l0ZW0ud2lkdGgod2lkdGgpO1xuICB0aGlzLml0ZW1XaWR0aCA9IHRoaXMuJGl0ZW0ub3V0ZXJXaWR0aCh0cnVlKTtcbiAgdGhpcy5pdGVtc1dpZHRoID0gdGhpcy5pdGVtV2lkdGggKiB0aGlzLiRpdGVtLmxlbmd0aDtcbiAgXG4gIHRoaXMuJGl0ZW1zXG4gICAgLmNzcyh7XG4gICAgICBtYXJnaW5MZWZ0OiAodGhpcy5vcHRzLnN1cnBsdXMgKiAtMSAqIHRoaXMuaXRlbVdpZHRoICogdGhpcy5jdXJyZW50KSArIHRoaXMubWFyZ2luQ29ycmVjdFxuICAgIH0pO1xuICBcbiAgdGhpcy5zZXRUb3VjaFRocmVzaG9sZCgpO1xufVxuXG5cblxuLypcbiMjIyBpbml0XG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpe1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMuJGVsLmFkZENsYXNzKCduQ2Fyb3VzZWwnKTtcbiAgXG4gIGlmKCAxID4gdGhpcy4kZWwuZmluZCgnLm5DYXJvdXNlbF9fdmlld3BvcnQnKS5sZW5ndGggKXtcbiAgICB0aGlzLmJhY2t1cC5odG1sID0gdGhpcy4kZWwuaHRtbCgpO1xuICAgIHRoaXMuJGVsLmVtcHR5KCk7XG4gICAgdGhpcy4kZWwuaHRtbChcbiAgICAgICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX192aWV3cG9ydFwiPidcbiAgICAgICsgdGhpcy5iYWNrdXAuaHRtbFxuICAgICAgKyAnPC9kaXY+J1xuICAgICk7XG4gIH1cbiAgXG4gIHRoaXMuJHZpZXdwb3J0ID0gdGhpcy4kZWwuY2hpbGRyZW4oJy5uQ2Fyb3VzZWxfX3ZpZXdwb3J0Jyk7XG4gIHRoaXMuJGl0ZW1zID0gdGhpcy4kdmlld3BvcnQuY2hpbGRyZW4oKTtcbiAgdGhpcy4kaXRlbXMuYWRkQ2xhc3MoJ25DYXJvdXNlbF9faXRlbXMnKTtcbiAgdGhpcy4kaXRlbSA9IHRoaXMuJGl0ZW1zLmNoaWxkcmVuKCk7XG4gIHRoaXMuJGl0ZW0uYWRkQ2xhc3MoJ25DYXJvdXNlbF9faXRlbScpO1xuICBcbiAgdGhpcy5pdGVtV2lkdGggPSB0aGlzLiRpdGVtLm91dGVyV2lkdGgodHJ1ZSk7XG4gIHRoaXMuaXRlbXNXaWR0aCA9IHRoaXMuaXRlbVdpZHRoICogdGhpcy4kaXRlbS5sZW5ndGg7XG4gIFxuICB0aGlzLm1hcmdpbkNvcnJlY3QgPSBwYXJzZUludCggdGhpcy4kaXRlbS5jc3MoJ21hcmdpbi1sZWZ0JykgKSAqIC0xO1xuICBcbiAgdGhpcy4kaXRlbXNcbiAgICAuY3NzKHtcbiAgICAgIG1hcmdpbkxlZnQ6ICh0aGlzLm9wdHMuc3VycGx1cyAqIC0xICogdGhpcy5pdGVtc1dpZHRoKSArIHRoaXMubWFyZ2luQ29ycmVjdFxuICAgIH0pO1xuICBcbiAgZm9yKCB2YXIgaT0wOyBpIDwgdGhpcy5vcHRzLnN1cnBsdXMgKiAyOyBpKysgKXtcbiAgICB0aGlzLiRpdGVtcy5hcHBlbmQoIHRoaXMuJGl0ZW0uY2xvbmUoKSApO1xuICB9XG4gIHRoaXMuJF9pdGVtID0gdGhpcy4kaXRlbXMuY2hpbGRyZW4oKTtcbiAgXG4gIHRoaXMuY3VycmVudCA9IHRoaXMuJGl0ZW0ubGVuZ3RoICogdGhpcy5vcHRzLnN1cnBsdXM7XG4gIHRoaXMuJGVsLmFkZENsYXNzKFwiaXMtY3VycmVudC1cIiArICh0aGlzLmN1cnJlbnQgLSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzKSk7XG4gIFxuICAvL2Fycm93c1xuICB0aGlzLiR2aWV3cG9ydC5hcHBlbmQoXG4gICAgJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX2Fycm93IG5DYXJvdXNlbF9fcHJldlwiPjwvZGl2PicgKyBcbiAgICAnPGRpdiBjbGFzcz1cIm5DYXJvdXNlbF9fYXJyb3cgbkNhcm91c2VsX19uZXh0XCI+PC9kaXY+J1xuICApO1xuICB0aGlzLiRwcmV2ID0gdGhpcy4kdmlld3BvcnQuY2hpbGRyZW4oJy5uQ2Fyb3VzZWxfX3ByZXYnKTtcbiAgdGhpcy4kbmV4dCA9IHRoaXMuJHZpZXdwb3J0LmNoaWxkcmVuKCcubkNhcm91c2VsX19uZXh0Jyk7XG4gIHRoaXMuYXJyb3dWaXNpYmlsaXRpZXMoKTtcbiAgXG4gIC8vYWRkIHBvaW50ZXJzXG4gIGlmKHRoaXMub3B0cy5wb2ludGVycyl7XG4gICAgdmFyIHBvaW50ZXJzSFRNTCA9ICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX19wb2ludGVyc1wiPic7XG4gICAgZm9yKCB2YXIgaT0xOyBpPD10aGlzLiRpdGVtLmxlbmd0aDsgaSsrICl7XG4gICAgICBwb2ludGVyc0hUTUwgKz0gJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3BvaW50ZXJcIj4nKyBpICsnPC9kaXY+JztcbiAgICB9XG4gICAgcG9pbnRlcnNIVE1MICs9ICc8L2Rpdj4nO1xuICAgIHRoaXMuJGVsLmFwcGVuZChwb2ludGVyc0hUTUwpO1xuICAgIHRoaXMuJHBvaW50ZXIgPSB0aGlzLiRlbC5maW5kKCcubkNhcm91c2VsX19wb2ludGVyJyk7XG4gICAgdGhpcy4kcG9pbnRlci5lcSgwKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XG4gICAgdGhpcy4kZWwub24oJ2NsaWNrJywgJy5uQ2Fyb3VzZWxfX3BvaW50ZXInLCBmdW5jdGlvbihlKXtcbiAgICAgIHZhciBpbmRleCA9IHNlbGYuJHBvaW50ZXIuaW5kZXgodGhpcyksXG4gICAgICAgICAgbmV4dCAgPSBpbmRleCArIHNlbGYuJGl0ZW0ubGVuZ3RoICogc2VsZi5vcHRzLnN1cnBsdXM7XG4gICAgICBzZWxmLmFuaW1hdGlvbiggbmV4dCApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICB9XG4gIFxuICB0aGlzLnNldFRvdWNoVGhyZXNob2xkKCk7XG4gIHRoaXMuc2V0U3dpcGVFdmVudCgpO1xufVxuXG5cblxuLypcbiMjIyBhbmltYXRpb25cbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuYW5pbWF0aW9uID0gZnVuY3Rpb24oIG5leHQgKXtcbiAgaWYoIHRoaXMubG9jayApIHJldHVybiBmYWxzZTtcbiAgXG4gIHZhciBzZWxmID0gdGhpcyxcbiAgICAgIHJlc3VsdCA9IHRydWUsXG4gICAgICBkdXJhdGlvbiA9IHRoaXMub3B0cy5kdXJhdGlvbixcbiAgICAgIGVhc2luZyA9IHRoaXMub3B0cy5lYXNpbmc7XG4gIFxuICB0aGlzLmxvY2sgPSB0cnVlO1xuICBcbiAgaWYoIDAgPT09IHRoaXMub3B0cy5zdXJwbHVzICkge1xuICAgIGlmKCBuZXh0IDwgMCB8fCB0aGlzLiRpdGVtLmxlbmd0aCAtIDEgPCBuZXh0ICkgcmVzdWx0ID0gZmFsc2U7XG4gIH1cbiAgXG4gIHRoaXMuJGVsLnJlbW92ZUNsYXNzKFwiaXMtY3VycmVudC1cIiArICh0aGlzLmN1cnJlbnQgLSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzKSk7XG4gIFxuICBpZiggcmVzdWx0ICkge1xuICAgIFxuICAgIHRoaXMuY3VycmVudCA9IG5leHQ7XG4gICAgaWYoIHNlbGYuY3VycmVudCA8IHNlbGYuJGl0ZW0ubGVuZ3RoICogc2VsZi5vcHRzLnN1cnBsdXMgKSB7XG4gICAgICBzZWxmLmN1cnJlbnQgKz0gc2VsZi4kaXRlbS5sZW5ndGg7XG4gICAgfSBlbHNlIGlmKCBzZWxmLmN1cnJlbnQgPj0gc2VsZi4kaXRlbS5sZW5ndGggKiAoc2VsZi5vcHRzLnN1cnBsdXMgKyAxKSApIHtcbiAgICAgIHNlbGYuY3VycmVudCAtPSBzZWxmLiRpdGVtLmxlbmd0aDtcbiAgICB9XG4gICAgXG4gIH0gZWxzZSB7XG4gICAgXG4gICAgaWYoIG5leHQgPCAwICkge1xuICAgICAgbmV4dCA9IDA7XG4gICAgfSBlbHNlIGlmKCB0aGlzLiRpdGVtLmxlbmd0aCAtIDEgPCBuZXh0ICkge1xuICAgICAgbmV4dCA9IHRoaXMuJGl0ZW0ubGVuZ3RoIC0gMTtcbiAgICB9XG4gICAgZWFzaW5nID0gJ2xpbmVhcic7XG4gICAgXG4gIH1cbiAgXG4gIGlmKHRoaXMub3B0cy5wb2ludGVycyl7XG4gICAgc2VsZi5wb2ludGVyQWN0aXZlKCk7XG4gIH1cbiAgXG4gIHRoaXMuJGl0ZW1zLnN0b3AodHJ1ZSxmYWxzZSkuYW5pbWF0ZSh7XG4gICAgJ21hcmdpbkxlZnQnOiBzZWxmLml0ZW1XaWR0aCAqIG5leHQgKiAtMSArIHRoaXMubWFyZ2luQ29ycmVjdFxuICB9LCBkdXJhdGlvbiwgZWFzaW5nLCBmdW5jdGlvbigpe1xuICAgIHNlbGYuJGl0ZW1zLmNzcygnbWFyZ2luTGVmdCcsIHNlbGYuaXRlbVdpZHRoICogc2VsZi5jdXJyZW50ICogLTEgKyBzZWxmLm1hcmdpbkNvcnJlY3QpO1xuICAgIHNlbGYubG9jayA9IGZhbHNlO1xuICB9KTtcbiAgXG4gIHRoaXMuYXJyb3dWaXNpYmlsaXRpZXMoKTtcbiAgXG4gIHJldHVybiByZXN1bHQ7XG59XG5cblxuXG4vKlxuIyMjIGFycm93IHZpc2liaWxpdGllc1xuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5hcnJvd1Zpc2liaWxpdGllcyA9IGZ1bmN0aW9uKCl7XG4gIGlmKCAwID09PSB0aGlzLm9wdHMuc3VycGx1cyApIHtcbiAgICBpZiggMCA9PSB0aGlzLmN1cnJlbnQgKSB7XG4gICAgICB0aGlzLiRwcmV2LmNzcygnZGlzcGxheScsJ25vbmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy4kcHJldi5jc3MoJ2Rpc3BsYXknLCdibG9jaycpO1xuICAgIH1cbiAgICBpZiggdGhpcy5jdXJyZW50ID09IHRoaXMuJGl0ZW0ubGVuZ3RoIC0gMSApIHtcbiAgICAgIHRoaXMuJG5leHQuY3NzKCdkaXNwbGF5Jywnbm9uZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRuZXh0LmNzcygnZGlzcGxheScsJ2Jsb2NrJyk7XG4gICAgfVxuICB9XG59XG5cblxuXG4vKlxuIyMjIHBvaW50ZXIgYWN0aXZlXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnBvaW50ZXJBY3RpdmUgPSBmdW5jdGlvbigpe1xuICB0aGlzLiRwb2ludGVyLmZpbHRlcignLmlzLWFjdGl2ZScpLnJlbW92ZUNsYXNzKCdpcy1hY3RpdmUnKTtcbiAgdGhpcy4kcG9pbnRlci5lcSh0aGlzLmN1cnJlbnQgLSB0aGlzLiRpdGVtLmxlbmd0aCAqIHRoaXMub3B0cy5zdXJwbHVzKS5hZGRDbGFzcygnaXMtYWN0aXZlJyk7XG59XG5cblxuXG4vKlxuIyMjIHN3aXBlXG4qL1xuXG4vKlxuIyMjIyBzZXQgc3dpcGUgZXZlbnRcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc2V0U3dpcGVFdmVudCA9IGZ1bmN0aW9uKCl7XG4gIFxuICB0aGlzLiRpdGVtcy5maW5kKFwiYVwiKS5jbGljayhmdW5jdGlvbigpe3JldHVybiBmYWxzZX0pO1xuICBcbiAgLy9zd2lwZVxuICBpZiggdGhpcy5vcHRzLnN3aXBlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9uKCd0b3VjaHN0YXJ0Lm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZVN0YXJ0LCB0aGlzKSk7XG4gIH1cbiAgXG4gIC8vZHJhZ2dhYmxlXG4gIGlmKCB0aGlzLm9wdHMuZHJhZ2dhYmxlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZWRvd24ubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlU3RhcnQsIHRoaXMpKTtcbiAgfVxufVxuXG4vKlxuIyMjIyBzd2lwZSBzdGFydFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5zd2lwZVN0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpe1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBpZiggdGhpcy5sb2NrICkgcmV0dXJuIGZhbHNlO1xuICB0aGlzLnN3aXBpbmcgPSB0cnVlO1xuICBcbiAgdmFyIHBvcyA9IFBvc2l0aW9uKGV2ZW50KTtcbiAgdGhpcy50b3VjaFN0YXJ0WCA9IHBvcy54O1xuICB0aGlzLnRvdWNoTW92ZVggPSBwb3MueDtcbiAgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ID0gcGFyc2VJbnQoIHRoaXMuJGl0ZW1zLmNzcygnbWFyZ2luTGVmdCcpICk7XG4gIFxuICAvL29uIG1vdmUgJiBlbmRcbiAgaWYoIHRoaXMub3B0cy5zd2lwZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vbigndG91Y2htb3ZlLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZU1vdmUsIHRoaXMpKTtcbiAgICB0aGlzLiRpdGVtcy5vbigndG91Y2hlbmQubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlRW5kLCB0aGlzKSk7XG4gICAgdGhpcy4kaXRlbXMub24oJ3RvdWNoY2FuY2VsLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICB9XG4gIGlmKCB0aGlzLm9wdHMuZHJhZ2dhYmxlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZW1vdmUubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlTW92ZSwgdGhpcykpO1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZXVwLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICAgIHRoaXMuJGl0ZW1zLm9uKCdtb3VzZWxlYXZlLm5jYXJvdXNlbCcsICQucHJveHkodGhpcy5zd2lwZUVuZCwgdGhpcykpO1xuICB9XG59XG5cbi8qXG4jIyMjIHN3aXBlIG1vdmVcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc3dpcGVNb3ZlID0gZnVuY3Rpb24oZXZlbnQpe1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB2YXIgcG9zID0gUG9zaXRpb24oZXZlbnQpO1xuICB0aGlzLnRvdWNoTW92ZVggPSBwb3MueDtcbiAgdmFyIGRpZmZYID0gdGhpcy50b3VjaE1vdmVYIC0gdGhpcy50b3VjaFN0YXJ0WDtcbiAgdGhpcy4kaXRlbXMuY3NzKCdtYXJnaW5MZWZ0JywgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ICsgZGlmZlgpO1xufVxuXG4vKlxuIyMjIyBzd2lwZSBlbmRcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc3dpcGVFbmQgPSBmdW5jdGlvbihldmVudCl7XG4gIHRoaXMuc3dpcGluZyA9IGZhbHNlO1xuICBcbiAgLy9vZmYgbW92ZSAmIGVuZFxuICBpZiggdGhpcy5vcHRzLnN3aXBlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9mZigndG91Y2htb3ZlLm5jYXJvdXNlbCcpO1xuICAgIHRoaXMuJGl0ZW1zLm9mZigndG91Y2hlbmQubmNhcm91c2VsJyk7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCd0b3VjaGNhbmNlbC5uY2Fyb3VzZWwnKTtcbiAgfVxuICBpZiggdGhpcy5vcHRzLmRyYWdnYWJsZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ21vdXNlbW92ZS5uY2Fyb3VzZWwnKTtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ21vdXNldXAubmNhcm91c2VsJyk7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCdtb3VzZWxlYXZlLm5jYXJvdXNlbCcpO1xuICB9XG4gIFxuICB2YXIgcmVzdWx0ID0gdGhpcy5jdXJyZW50O1xuICBpZiggdGhpcy50b3VjaE1vdmVYIC0gdGhpcy50b3VjaFRocmVzaG9sZCA+IHRoaXMudG91Y2hTdGFydFggKSB7XG4gICAgcmVzdWx0ID0gdGhpcy5jdXJyZW50IC0gMTtcbiAgfSBlbHNlIGlmKCB0aGlzLnRvdWNoTW92ZVggKyB0aGlzLnRvdWNoVGhyZXNob2xkIDwgdGhpcy50b3VjaFN0YXJ0WCApIHtcbiAgICByZXN1bHQgPSB0aGlzLmN1cnJlbnQgKyAxO1xuICB9IGVsc2Uge1xuICAgIHZhciBocmVmID0gJChldmVudC50YXJnZXQpLmNsb3Nlc3QoXCJhXCIpLmF0dHIoXCJocmVmXCIpO1xuICAgIGlmKGhyZWYgIT0gdW5kZWZpbmVkKSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGhyZWY7XG4gICAgfVxuICB9XG4gIHRoaXMuYW5pbWF0aW9uKCByZXN1bHQgKTtcbiAgXG4gIC8vcmVzZXRcbiAgdGhpcy50b3VjaFN0YXJ0WCA9IC0xO1xuICB0aGlzLnRvdWNoTW92ZVggPSAtMTtcbiAgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ID0gLTE7XG59XG4iLCJ9KShqUXVlcnksIHRoaXMsIHRoaXMuZG9jdW1lbnQpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
