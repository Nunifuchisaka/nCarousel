/*!
  
  jquery.nCarousel.js
  
  Version: 0.1.0
  Author: Nunifuchisaka(nunifuchisaka@gmail.com)
  Website: http://nunifuchisaka.com/w/n-carousel/demo
  Repository: https://github.com/Nunifuchisaka/nCarousel
  
*/
!function(t,i,s,e){"use strict";function h(t){var i=t.pageX?t.pageX:t.originalEvent.touches[0].pageX,s=t.pageY?t.pageY:t.originalEvent.touches[0].pageY;return i=Math.floor(i),s=Math.floor(s),{x:i,y:s}}function r(s){var e=this;this.opts=t.extend({duration:400,easing:"swing",thumbnail:!1,surplus:1,interval:0,swipe:!0,draggable:!0,pointers:!0,touchThresholdMagnification:10},s),this.backup={},this.lock=!1,this.activeResponsive=!1,this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1,this.touchThreshold=0,this.$window=t(i),this.$el=t(s.el),this.backup.html=this.$el.html(),this.$el.empty(),this.$parent=this.$el.parent(),this.$el.on("click",".nCarousel__prev",function(){return e.animation(e.current-1),!1}).on("click",".nCarousel__next",function(){return e.animation(e.current+1),!1}),this.maxWidth=parseInt(this.$el.css("max-width")),this.init(),this.windowResize(),this.resizeTimer=!1,this.$window.resize(function(){e.resizeTimer!==!1&&clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(t.proxy(e.windowResize,e),100)}),0<this.opts.interval&&(this.ticker=setInterval(function(){e.animation(e.current+1)},this.opts.interval))}t.fn.nCarousel=function(i){return this.each(function(s,e){var h=t.extend({i:s,el:e},i);new r(h)})},r.prototype.setTouchThreshold=function(){return this.opts.swipe||this.opts.draggable?void(this.touchThreshold=this.$item.outerWidth(!1)*(this.opts.touchThresholdMagnification/100)):!1},r.prototype.windowResize=function(){if(this.windowWidth=this.$window.width(),this.maxWidth<this.$window.width())return void(this.activeResponsive&&(this.activeResponsive=!1,this.resetItemWidth("auto")));this.activeResponsive=!0,this.resetItemWidth(this.$viewport.width())},r.prototype.resetItemWidth=function(t){this.$_item.width(t),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.$items.css({marginLeft:-1*this.opts.surplus*this.itemWidth*this.current+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth}),this.setTouchThreshold()},r.prototype.init=function(){var t=this;this.$el.addClass("nCarousel"),this.$el.html('<div class="nCarousel__viewport">'+this.backup.html+"</div>"),this.$viewport=this.$el.children(".nCarousel__viewport"),this.$items=this.$viewport.children(),this.$item=this.$items.children(),this.$item.addClass("nCarousel__item"),this.itemWidth=this.$item.outerWidth(!0),this.itemsWidth=this.itemWidth*this.$item.length,this.marginCorrect=-1*parseInt(this.$item.css("margin-left")),this.$items.css({marginLeft:-1*this.opts.surplus*this.itemsWidth+this.marginCorrect,width:(2*this.opts.surplus+1)*this.itemsWidth});for(var i=0;i<2*this.opts.surplus;i++)this.$items.append(this.$item.clone());if(this.$_item=this.$items.children(),this.current=this.$item.length*this.opts.surplus,this.$el.addClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),this.$viewport.append('<div class="nCarousel__arrow nCarousel__prev"></div><div class="nCarousel__arrow nCarousel__next"></div>'),this.$prev=this.$viewport.children(".nCarousel__prev"),this.$next=this.$viewport.children(".nCarousel__next"),this.arrowVisibilities(),this.opts.pointers){for(var s='<div class="nCarousel__pointers">',i=0;i<this.$item.length;i++)s+='<div class="nCarousel__pointer"></div>';s+="</div>",this.$el.append(s),this.$pointer=this.$el.find(".nCarousel__pointer"),this.$pointer.eq(0).addClass("is-active"),this.$el.on("click",".nCarousel__pointer",function(i){var s=t.$pointer.index(this),e=s+t.$item.length*t.opts.surplus;return t.animation(e),!1})}this.setTouchThreshold(),this.setSwipeEvent()},r.prototype.animation=function(t){if(this.lock)return!1;var i=this,s=!0,e=this.opts.duration,h=this.opts.easing;return this.lock=!0,0===this.opts.surplus&&(0>t||this.$item.length-1<t)&&(s=!1),this.$el.removeClass("is-current-"+(this.current-this.$item.length*this.opts.surplus)),s?(this.current=t,i.current<i.$item.length*i.opts.surplus?i.current+=i.$item.length:i.current>=i.$item.length*(i.opts.surplus+1)&&(i.current-=i.$item.length)):(0>t?t=0:this.$item.length-1<t&&(t=this.$item.length-1),h="linear"),this.opts.pointers&&i.pointerActive(),this.$items.stop(!0,!1).animate({marginLeft:i.itemWidth*t*-1+this.marginCorrect},e,h,function(){i.$items.css("marginLeft",i.itemWidth*i.current*-1+i.marginCorrect),i.lock=!1}),this.arrowVisibilities(),s},r.prototype.arrowVisibilities=function(){0===this.opts.surplus&&(0==this.current?this.$prev.css("display","none"):this.$prev.css("display","block"),this.current==this.$item.length-1?this.$next.css("display","none"):this.$next.css("display","block"))},r.prototype.pointerActive=function(){this.$pointer.filter(".is-active").removeClass("is-active"),this.$pointer.eq(this.current-this.$item.length*this.opts.surplus).addClass("is-active")},r.prototype.setSwipeEvent=function(){this.$items.find("a").click(function(){return!1}),this.opts.swipe&&this.$items.on("touchstart.ncarousel",t.proxy(this.swipeStart,this)),this.opts.draggable&&this.$items.on("mousedown.ncarousel",t.proxy(this.swipeStart,this))},r.prototype.swipeStart=function(i){if(i.preventDefault(),this.lock)return!1;var s=h(i);this.touchStartX=s.x,this.touchMoveX=s.x,this.touchStartItemsMarginLeft=parseInt(this.$items.css("marginLeft")),this.opts.swipe&&(this.$items.on("touchmove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("touchend.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("touchcancel.ncarousel",t.proxy(this.swipeEnd,this))),this.opts.draggable&&(this.$items.on("mousemove.ncarousel",t.proxy(this.swipeMove,this)),this.$items.on("mouseup.ncarousel",t.proxy(this.swipeEnd,this)),this.$items.on("mouseleave.ncarousel",t.proxy(this.swipeEnd,this)))},r.prototype.swipeMove=function(t){t.preventDefault();var i=h(t);this.touchMoveX=i.x;var s=this.touchMoveX-this.touchStartX;this.$items.css("marginLeft",this.touchStartItemsMarginLeft+s)},r.prototype.swipeEnd=function(s){this.opts.swipe&&(this.$items.off("touchmove.ncarousel"),this.$items.off("touchend.ncarousel"),this.$items.off("touchcancel.ncarousel")),this.opts.draggable&&(this.$items.off("mousemove.ncarousel"),this.$items.off("mouseup.ncarousel"),this.$items.off("mouseleave.ncarousel"));var h=this.current;if(this.touchMoveX-this.touchThreshold>this.touchStartX)h=this.current-1;else if(this.touchMoveX+this.touchThreshold<this.touchStartX)h=this.current+1;else{var r=t(s.target).closest("a").attr("href");r!=e&&(i.location.href=r)}this.animation(h),this.touchStartX=-1,this.touchMoveX=-1,this.touchStartItemsMarginLeft=-1}}(jQuery,this,this.document);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjExMF9oZWFkZXIuanMiLCI0MTBfVmlldy5qcyIsIjk5MF9mb290ZXIuanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiUG9zaXRpb24iLCJlIiwieCIsInBhZ2VYIiwib3JpZ2luYWxFdmVudCIsInRvdWNoZXMiLCJ5IiwicGFnZVkiLCJNYXRoIiwiZmxvb3IiLCJuQ2Fyb3VzZWwiLCJvcHRzIiwic2VsZiIsInRoaXMiLCJleHRlbmQiLCJkdXJhdGlvbiIsImVhc2luZyIsInRodW1ibmFpbCIsInN1cnBsdXMiLCJpbnRlcnZhbCIsInN3aXBlIiwiZHJhZ2dhYmxlIiwicG9pbnRlcnMiLCJ0b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb24iLCJiYWNrdXAiLCJsb2NrIiwiYWN0aXZlUmVzcG9uc2l2ZSIsInRvdWNoU3RhcnRYIiwidG91Y2hNb3ZlWCIsInRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQiLCJ0b3VjaFRocmVzaG9sZCIsIiR3aW5kb3ciLCIkZWwiLCJlbCIsImh0bWwiLCJlbXB0eSIsIiRwYXJlbnQiLCJwYXJlbnQiLCJvbiIsImFuaW1hdGlvbiIsImN1cnJlbnQiLCJtYXhXaWR0aCIsInBhcnNlSW50IiwiY3NzIiwiaW5pdCIsIndpbmRvd1Jlc2l6ZSIsInJlc2l6ZVRpbWVyIiwicmVzaXplIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsInByb3h5IiwidGlja2VyIiwic2V0SW50ZXJ2YWwiLCJmbiIsImVhY2giLCJpIiwiX29wdHMiLCJwcm90b3R5cGUiLCJzZXRUb3VjaFRocmVzaG9sZCIsIiRpdGVtIiwib3V0ZXJXaWR0aCIsIndpbmRvd1dpZHRoIiwid2lkdGgiLCJyZXNldEl0ZW1XaWR0aCIsIiR2aWV3cG9ydCIsIiRfaXRlbSIsIml0ZW1XaWR0aCIsIml0ZW1zV2lkdGgiLCJsZW5ndGgiLCIkaXRlbXMiLCJtYXJnaW5MZWZ0IiwibWFyZ2luQ29ycmVjdCIsImFkZENsYXNzIiwiY2hpbGRyZW4iLCJhcHBlbmQiLCJjbG9uZSIsIiRwcmV2IiwiJG5leHQiLCJhcnJvd1Zpc2liaWxpdGllcyIsInBvaW50ZXJzSFRNTCIsIiRwb2ludGVyIiwiZmluZCIsImVxIiwiaW5kZXgiLCJuZXh0Iiwic2V0U3dpcGVFdmVudCIsInJlc3VsdCIsInJlbW92ZUNsYXNzIiwicG9pbnRlckFjdGl2ZSIsInN0b3AiLCJhbmltYXRlIiwiZmlsdGVyIiwiY2xpY2siLCJzd2lwZVN0YXJ0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInBvcyIsInN3aXBlTW92ZSIsInN3aXBlRW5kIiwiZGlmZlgiLCJvZmYiLCJocmVmIiwidGFyZ2V0IiwiY2xvc2VzdCIsImF0dHIiLCJsb2NhdGlvbiIsImpRdWVyeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztDQVVBLFNBQUFBLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsWUNNQSxTQUFBQyxHQUFBQyxHQUNBLEdBQUFDLEdBQUFELEVBQUEsTUFBQUEsRUFBQUUsTUFBQUYsRUFBQUcsY0FBQUMsUUFBQSxHQUFBRixNQUNBRyxFQUFBTCxFQUFBLE1BQUFBLEVBQUFNLE1BQUFOLEVBQUFHLGNBQUFDLFFBQUEsR0FBQUUsS0FHQSxPQUZBTCxHQUFBTSxLQUFBQyxNQUFBUCxHQUNBSSxFQUFBRSxLQUFBQyxNQUFBSCxJQUNBSixFQUFBQSxFQUFBSSxFQUFBQSxHQVNBLFFBQUFJLEdBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsSUFDQUEsTUFBQUYsS0FBQWYsRUFBQWtCLFFBQ0FDLFNBQUEsSUFDQUMsT0FBQSxRQUNBQyxXQUFBLEVBQ0FDLFFBQUEsRUFDQUMsU0FBQSxFQUNBQyxPQUFBLEVBQ0FDLFdBQUEsRUFDQUMsVUFBQSxFQUNBQyw0QkFBQSxJQUNBWixHQUVBRSxLQUFBVyxVQUNBWCxLQUFBWSxNQUFBLEVBQ0FaLEtBQUFhLGtCQUFBLEVBRUFiLEtBQUFjLFlBQUEsR0FDQWQsS0FBQWUsV0FBQSxHQUNBZixLQUFBZ0IsMEJBQUEsR0FDQWhCLEtBQUFpQixlQUFBLEVBRUFqQixLQUFB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QUFRLFFBQUFDLFFBQUEsS0FBQUMsS0FBQSxPQUNBSCxJQUFBdEcsSUFDQUYsRUFBQTRHLFNBQUFKLEtBQUFBLEdBR0F4RixLQUFBMEIsVUFBQStDLEdBR0F6RSxLQUFBYyxZQUFBLEdBQ0FkLEtBQUFlLFdBQUEsR0FDQWYsS0FBQWdCLDBCQUFBLEtDN1lBNkUsT0FBQTdGLEtBQUFBLEtBQUFmIiwiZmlsZSI6ImpxdWVyeS5uQ2Fyb3VzZWwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gIFxuICBqcXVlcnkubkNhcm91c2VsLmpzXG4gIFxuICBWZXJzaW9uOiAwLjEuMFxuICBBdXRob3I6IE51bmlmdWNoaXNha2EobnVuaWZ1Y2hpc2FrYUBnbWFpbC5jb20pXG4gIFdlYnNpdGU6IGh0dHA6Ly9udW5pZnVjaGlzYWthLmNvbS93L24tY2Fyb3VzZWwvZGVtb1xuICBSZXBvc2l0b3J5OiBodHRwczovL2dpdGh1Yi5jb20vTnVuaWZ1Y2hpc2FrYS9uQ2Fyb3VzZWxcbiAgXG4qL1xuOyhmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpe1xuJ3VzZSBzdHJpY3QnO1xuIiwiLy9cbiQuZm4ubkNhcm91c2VsID0gZnVuY3Rpb24oIG9wdHMgKXtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCBpLCBlbCApe1xuICAgIHZhciBfb3B0cyA9ICQuZXh0ZW5kKHtcbiAgICAgIGk6IGksXG4gICAgICBlbDogZWxcbiAgICB9LCBvcHRzKTtcbiAgICBuZXcgbkNhcm91c2VsKF9vcHRzKTtcbiAgfSk7XG59XG5cblxuLypcbiMjIGZ1bmN0aW9uc1xuKi9cblxuZnVuY3Rpb24gUG9zaXRpb24oZSl7XG4gIHZhciB4ID0gKGUucGFnZVgpP2UucGFnZVg6ZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVg7XG4gIHZhciB5ID0gKGUucGFnZVkpP2UucGFnZVk6ZS5vcmlnaW5hbEV2ZW50LnRvdWNoZXNbMF0ucGFnZVk7XG4gIHggPSBNYXRoLmZsb29yKHgpO1xuICB5ID0gTWF0aC5mbG9vcih5KTtcbiAgcmV0dXJuIHsneCc6eCAsICd5Jzp5fTtcbn1cblxuXG5cbi8qXG4jIyBuQ2Fyb3VzZWxcbiovXG5cbmZ1bmN0aW9uIG5DYXJvdXNlbCggb3B0cyApIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLm9wdHMgPSAkLmV4dGVuZCh7XG4gICAgZHVyYXRpb246IDQwMCxcbiAgICBlYXNpbmc6IFwic3dpbmdcIixcbiAgICB0aHVtYm5haWw6IGZhbHNlLFxuICAgIHN1cnBsdXM6IDEsXG4gICAgaW50ZXJ2YWw6IDAsXG4gICAgc3dpcGU6IHRydWUsXG4gICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgIHBvaW50ZXJzOiB0cnVlLFxuICAgIHRvdWNoVGhyZXNob2xkTWFnbmlmaWNhdGlvbjogMTBcbiAgfSwgb3B0cyk7XG4gIFxuICB0aGlzLmJhY2t1cCA9IHt9O1xuICB0aGlzLmxvY2sgPSBmYWxzZTtcbiAgdGhpcy5hY3RpdmVSZXNwb25zaXZlID0gZmFsc2U7XG4gIFxuICB0aGlzLnRvdWNoU3RhcnRYID0gLTE7XG4gIHRoaXMudG91Y2hNb3ZlWCA9IC0xO1xuICB0aGlzLnRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQgPSAtMTtcbiAgdGhpcy50b3VjaFRocmVzaG9sZCA9IDA7XG4gIFxuICB0aGlzLiR3aW5kb3cgPSAkKHdpbmRvdyk7XG4gIHRoaXMuJGVsID0gJChvcHRzLmVsKTtcbiAgdGhpcy5iYWNrdXAuaHRtbCA9IHRoaXMuJGVsLmh0bWwoKTtcbiAgdGhpcy4kZWwuZW1wdHkoKTtcbiAgXG4gIHRoaXMuJHBhcmVudCA9IHRoaXMuJGVsLnBhcmVudCgpO1xuICBcbiAgdGhpcy4kZWxcbiAgICAub24oJ2NsaWNrJywgJy5uQ2Fyb3VzZWxfX3ByZXYnLCBmdW5jdGlvbigpe1xuICAgICAgc2VsZi5hbmltYXRpb24oIHNlbGYuY3VycmVudCAtIDEgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KVxuICAgIC5vbignY2xpY2snLCAnLm5DYXJvdXNlbF9fbmV4dCcsIGZ1bmN0aW9uKCl7XG4gICAgICBzZWxmLmFuaW1hdGlvbiggc2VsZi5jdXJyZW50ICsgMSApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuICBcbiAgdGhpcy5tYXhXaWR0aCA9IHBhcnNlSW50KCB0aGlzLiRlbC5jc3MoJ21heC13aWR0aCcpICk7XG4gIFxuICB0aGlzLmluaXQoKTtcbiAgXG4gIC8vcmVzaXplXG4gIHRoaXMud2luZG93UmVzaXplKCk7XG4gIHRoaXMucmVzaXplVGltZXIgPSBmYWxzZTtcbiAgdGhpcy4kd2luZG93LnJlc2l6ZShmdW5jdGlvbigpe1xuICAgIGlmKCBzZWxmLnJlc2l6ZVRpbWVyICE9PSBmYWxzZSApe1xuICAgICAgY2xlYXJUaW1lb3V0KHNlbGYucmVzaXplVGltZXIpO1xuICAgIH1cbiAgICBzZWxmLnJlc2l6ZVRpbWVyID0gc2V0VGltZW91dCgkLnByb3h5KHNlbGYud2luZG93UmVzaXplLCBzZWxmKSwgMTAwKTtcbiAgfSk7XG4gIFxuICAvL2F1dG9wbGF5XG4gIGlmKCAwIDwgdGhpcy5vcHRzLmludGVydmFsICkge1xuICAgIHRoaXMudGlja2VyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcbiAgICAgIHNlbGYuYW5pbWF0aW9uKCBzZWxmLmN1cnJlbnQgKyAxICk7XG4gICAgfSwgdGhpcy5vcHRzLmludGVydmFsKTtcbiAgfVxufVxuXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuc2V0VG91Y2hUaHJlc2hvbGQgPSBmdW5jdGlvbigpe1xuICBpZiggIXRoaXMub3B0cy5zd2lwZSAmJiAhdGhpcy5vcHRzLmRyYWdnYWJsZSApIHJldHVybiBmYWxzZTtcbiAgXG4gIHRoaXMudG91Y2hUaHJlc2hvbGQgPSB0aGlzLiRpdGVtLm91dGVyV2lkdGgoZmFsc2UpICogKHRoaXMub3B0cy50b3VjaFRocmVzaG9sZE1hZ25pZmljYXRpb24gLyAxMDApO1xufVxuXG5cblxuLypcbiMjIyB3aW5kb3cgcmVzaXplXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLndpbmRvd1Jlc2l6ZSA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMud2luZG93V2lkdGggPSB0aGlzLiR3aW5kb3cud2lkdGgoKTtcbiAgaWYoIHRoaXMubWF4V2lkdGggPCB0aGlzLiR3aW5kb3cud2lkdGgoKSApe1xuICAgIGlmKCB0aGlzLmFjdGl2ZVJlc3BvbnNpdmUgKSB7XG4gICAgICB0aGlzLmFjdGl2ZVJlc3BvbnNpdmUgPSBmYWxzZTtcbiAgICAgIHRoaXMucmVzZXRJdGVtV2lkdGgoJ2F1dG8nKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5hY3RpdmVSZXNwb25zaXZlID0gdHJ1ZTtcbiAgdGhpcy5yZXNldEl0ZW1XaWR0aCggdGhpcy4kdmlld3BvcnQud2lkdGgoKSApO1xuICAvL3RoaXMucmVzZXRJdGVtV2lkdGgoIHRoaXMuJHBhcmVudC53aWR0aCgpICk7XG59XG5cblxuXG4vKlxuIyMjIHJlc2V0SXRlbVdpZHRoXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnJlc2V0SXRlbVdpZHRoID0gZnVuY3Rpb24oIHdpZHRoICl7XG4gIHRoaXMuJF9pdGVtLndpZHRoKHdpZHRoKTtcbiAgdGhpcy5pdGVtV2lkdGggPSB0aGlzLiRpdGVtLm91dGVyV2lkdGgodHJ1ZSk7XG4gIHRoaXMuaXRlbXNXaWR0aCA9IHRoaXMuaXRlbVdpZHRoICogdGhpcy4kaXRlbS5sZW5ndGg7XG4gIFxuICB0aGlzLiRpdGVtc1xuICAgIC5jc3Moe1xuICAgICAgbWFyZ2luTGVmdDogKHRoaXMub3B0cy5zdXJwbHVzICogLTEgKiB0aGlzLml0ZW1XaWR0aCAqIHRoaXMuY3VycmVudCkgKyB0aGlzLm1hcmdpbkNvcnJlY3QsXG4gICAgICB3aWR0aDogKHRoaXMub3B0cy5zdXJwbHVzICogMiArIDEpICogdGhpcy5pdGVtc1dpZHRoXG4gICAgfSk7XG4gIFxuICB0aGlzLnNldFRvdWNoVGhyZXNob2xkKCk7XG59XG5cblxuXG4vKlxuIyMjIGluaXRcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCl7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy4kZWwuYWRkQ2xhc3MoJ25DYXJvdXNlbCcpO1xuICB0aGlzLiRlbC5odG1sKFxuICAgICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX192aWV3cG9ydFwiPidcbiAgICArIHRoaXMuYmFja3VwLmh0bWxcbiAgICArICc8L2Rpdj4nXG4gICk7XG4gIFxuICB0aGlzLiR2aWV3cG9ydCA9IHRoaXMuJGVsLmNoaWxkcmVuKCcubkNhcm91c2VsX192aWV3cG9ydCcpO1xuICB0aGlzLiRpdGVtcyA9IHRoaXMuJHZpZXdwb3J0LmNoaWxkcmVuKCk7XG4gIHRoaXMuJGl0ZW0gPSB0aGlzLiRpdGVtcy5jaGlsZHJlbigpO1xuICB0aGlzLiRpdGVtLmFkZENsYXNzKCduQ2Fyb3VzZWxfX2l0ZW0nKTtcbiAgXG4gIHRoaXMuaXRlbVdpZHRoID0gdGhpcy4kaXRlbS5vdXRlcldpZHRoKHRydWUpO1xuICB0aGlzLml0ZW1zV2lkdGggPSB0aGlzLml0ZW1XaWR0aCAqIHRoaXMuJGl0ZW0ubGVuZ3RoO1xuICBcbiAgdGhpcy5tYXJnaW5Db3JyZWN0ID0gcGFyc2VJbnQoIHRoaXMuJGl0ZW0uY3NzKCdtYXJnaW4tbGVmdCcpICkgKiAtMTtcbiAgXG4gIHRoaXMuJGl0ZW1zXG4gICAgLmNzcyh7XG4gICAgICBtYXJnaW5MZWZ0OiAodGhpcy5vcHRzLnN1cnBsdXMgKiAtMSAqIHRoaXMuaXRlbXNXaWR0aCkgKyB0aGlzLm1hcmdpbkNvcnJlY3QsXG4gICAgICB3aWR0aDogKHRoaXMub3B0cy5zdXJwbHVzICogMiArIDEpICogdGhpcy5pdGVtc1dpZHRoXG4gICAgfSk7XG4gIFxuICBmb3IoIHZhciBpPTA7IGkgPCB0aGlzLm9wdHMuc3VycGx1cyAqIDI7IGkrKyApe1xuICAgIHRoaXMuJGl0ZW1zLmFwcGVuZCggdGhpcy4kaXRlbS5jbG9uZSgpICk7XG4gIH1cbiAgdGhpcy4kX2l0ZW0gPSB0aGlzLiRpdGVtcy5jaGlsZHJlbigpO1xuICBcbiAgdGhpcy5jdXJyZW50ID0gdGhpcy4kaXRlbS5sZW5ndGggKiB0aGlzLm9wdHMuc3VycGx1cztcbiAgdGhpcy4kZWwuYWRkQ2xhc3MoXCJpcy1jdXJyZW50LVwiICsgKHRoaXMuY3VycmVudCAtIHRoaXMuJGl0ZW0ubGVuZ3RoICogdGhpcy5vcHRzLnN1cnBsdXMpKTtcbiAgXG4gIC8vYXJyb3dzXG4gIHRoaXMuJHZpZXdwb3J0LmFwcGVuZChcbiAgICAnPGRpdiBjbGFzcz1cIm5DYXJvdXNlbF9fYXJyb3cgbkNhcm91c2VsX19wcmV2XCI+PC9kaXY+JyArIFxuICAgICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX19hcnJvdyBuQ2Fyb3VzZWxfX25leHRcIj48L2Rpdj4nXG4gICk7XG4gIHRoaXMuJHByZXYgPSB0aGlzLiR2aWV3cG9ydC5jaGlsZHJlbignLm5DYXJvdXNlbF9fcHJldicpO1xuICB0aGlzLiRuZXh0ID0gdGhpcy4kdmlld3BvcnQuY2hpbGRyZW4oJy5uQ2Fyb3VzZWxfX25leHQnKTtcbiAgdGhpcy5hcnJvd1Zpc2liaWxpdGllcygpO1xuICBcbiAgLy9hZGQgcG9pbnRlcnNcbiAgaWYodGhpcy5vcHRzLnBvaW50ZXJzKXtcbiAgICB2YXIgcG9pbnRlcnNIVE1MID0gJzxkaXYgY2xhc3M9XCJuQ2Fyb3VzZWxfX3BvaW50ZXJzXCI+JztcbiAgICBmb3IoIHZhciBpPTA7IGk8dGhpcy4kaXRlbS5sZW5ndGg7IGkrKyApe1xuICAgICAgcG9pbnRlcnNIVE1MICs9ICc8ZGl2IGNsYXNzPVwibkNhcm91c2VsX19wb2ludGVyXCI+PC9kaXY+J1xuICAgIH1cbiAgICBwb2ludGVyc0hUTUwgKz0gJzwvZGl2Pic7XG4gICAgdGhpcy4kZWwuYXBwZW5kKHBvaW50ZXJzSFRNTCk7XG4gICAgdGhpcy4kcG9pbnRlciA9IHRoaXMuJGVsLmZpbmQoJy5uQ2Fyb3VzZWxfX3BvaW50ZXInKTtcbiAgICB0aGlzLiRwb2ludGVyLmVxKDApLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbiAgICB0aGlzLiRlbC5vbignY2xpY2snLCAnLm5DYXJvdXNlbF9fcG9pbnRlcicsIGZ1bmN0aW9uKGUpe1xuICAgICAgdmFyIGluZGV4ID0gc2VsZi4kcG9pbnRlci5pbmRleCh0aGlzKSxcbiAgICAgICAgICBuZXh0ICA9IGluZGV4ICsgc2VsZi4kaXRlbS5sZW5ndGggKiBzZWxmLm9wdHMuc3VycGx1cztcbiAgICAgIHNlbGYuYW5pbWF0aW9uKCBuZXh0ICk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gIH1cbiAgXG4gIHRoaXMuc2V0VG91Y2hUaHJlc2hvbGQoKTtcbiAgdGhpcy5zZXRTd2lwZUV2ZW50KCk7XG59XG5cblxuXG4vKlxuIyMjIGFuaW1hdGlvblxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5hbmltYXRpb24gPSBmdW5jdGlvbiggbmV4dCApe1xuICBpZiggdGhpcy5sb2NrICkgcmV0dXJuIGZhbHNlO1xuICBcbiAgdmFyIHNlbGYgPSB0aGlzLFxuICAgICAgcmVzdWx0ID0gdHJ1ZSxcbiAgICAgIGR1cmF0aW9uID0gdGhpcy5vcHRzLmR1cmF0aW9uLFxuICAgICAgZWFzaW5nID0gdGhpcy5vcHRzLmVhc2luZztcbiAgXG4gIHRoaXMubG9jayA9IHRydWU7XG4gIFxuICBpZiggMCA9PT0gdGhpcy5vcHRzLnN1cnBsdXMgKSB7XG4gICAgaWYoIG5leHQgPCAwIHx8IHRoaXMuJGl0ZW0ubGVuZ3RoIC0gMSA8IG5leHQgKSByZXN1bHQgPSBmYWxzZTtcbiAgfVxuICBcbiAgdGhpcy4kZWwucmVtb3ZlQ2xhc3MoXCJpcy1jdXJyZW50LVwiICsgKHRoaXMuY3VycmVudCAtIHRoaXMuJGl0ZW0ubGVuZ3RoICogdGhpcy5vcHRzLnN1cnBsdXMpKTtcbiAgXG4gIGlmKCByZXN1bHQgKSB7XG4gICAgXG4gICAgdGhpcy5jdXJyZW50ID0gbmV4dDtcbiAgICBpZiggc2VsZi5jdXJyZW50IDwgc2VsZi4kaXRlbS5sZW5ndGggKiBzZWxmLm9wdHMuc3VycGx1cyApIHtcbiAgICAgIHNlbGYuY3VycmVudCArPSBzZWxmLiRpdGVtLmxlbmd0aDtcbiAgICB9IGVsc2UgaWYoIHNlbGYuY3VycmVudCA+PSBzZWxmLiRpdGVtLmxlbmd0aCAqIChzZWxmLm9wdHMuc3VycGx1cyArIDEpICkge1xuICAgICAgc2VsZi5jdXJyZW50IC09IHNlbGYuJGl0ZW0ubGVuZ3RoO1xuICAgIH1cbiAgICBcbiAgfSBlbHNlIHtcbiAgICBcbiAgICBpZiggbmV4dCA8IDAgKSB7XG4gICAgICBuZXh0ID0gMDtcbiAgICB9IGVsc2UgaWYoIHRoaXMuJGl0ZW0ubGVuZ3RoIC0gMSA8IG5leHQgKSB7XG4gICAgICBuZXh0ID0gdGhpcy4kaXRlbS5sZW5ndGggLSAxO1xuICAgIH1cbiAgICBlYXNpbmcgPSAnbGluZWFyJztcbiAgICBcbiAgfVxuICBcbiAgaWYodGhpcy5vcHRzLnBvaW50ZXJzKXtcbiAgICBzZWxmLnBvaW50ZXJBY3RpdmUoKTtcbiAgfVxuICBcbiAgdGhpcy4kaXRlbXMuc3RvcCh0cnVlLGZhbHNlKS5hbmltYXRlKHtcbiAgICAnbWFyZ2luTGVmdCc6IHNlbGYuaXRlbVdpZHRoICogbmV4dCAqIC0xICsgdGhpcy5tYXJnaW5Db3JyZWN0XG4gIH0sIGR1cmF0aW9uLCBlYXNpbmcsIGZ1bmN0aW9uKCl7XG4gICAgc2VsZi4kaXRlbXMuY3NzKCdtYXJnaW5MZWZ0Jywgc2VsZi5pdGVtV2lkdGggKiBzZWxmLmN1cnJlbnQgKiAtMSArIHNlbGYubWFyZ2luQ29ycmVjdCk7XG4gICAgc2VsZi5sb2NrID0gZmFsc2U7XG4gIH0pO1xuICBcbiAgdGhpcy5hcnJvd1Zpc2liaWxpdGllcygpO1xuICBcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuXG5cbi8qXG4jIyMgYXJyb3cgdmlzaWJpbGl0aWVzXG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLmFycm93VmlzaWJpbGl0aWVzID0gZnVuY3Rpb24oKXtcbiAgaWYoIDAgPT09IHRoaXMub3B0cy5zdXJwbHVzICkge1xuICAgIGlmKCAwID09IHRoaXMuY3VycmVudCApIHtcbiAgICAgIHRoaXMuJHByZXYuY3NzKCdkaXNwbGF5Jywnbm9uZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLiRwcmV2LmNzcygnZGlzcGxheScsJ2Jsb2NrJyk7XG4gICAgfVxuICAgIGlmKCB0aGlzLmN1cnJlbnQgPT0gdGhpcy4kaXRlbS5sZW5ndGggLSAxICkge1xuICAgICAgdGhpcy4kbmV4dC5jc3MoJ2Rpc3BsYXknLCdub25lJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuJG5leHQuY3NzKCdkaXNwbGF5JywnYmxvY2snKTtcbiAgICB9XG4gIH1cbn1cblxuXG5cbi8qXG4jIyMgcG9pbnRlciBhY3RpdmVcbiovXG5cbm5DYXJvdXNlbC5wcm90b3R5cGUucG9pbnRlckFjdGl2ZSA9IGZ1bmN0aW9uKCl7XG4gIHRoaXMuJHBvaW50ZXIuZmlsdGVyKCcuaXMtYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICB0aGlzLiRwb2ludGVyLmVxKHRoaXMuY3VycmVudCAtIHRoaXMuJGl0ZW0ubGVuZ3RoICogdGhpcy5vcHRzLnN1cnBsdXMpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbn1cblxuXG5cbi8qXG4jIyMgc3dpcGVcbiovXG5cbi8qXG4jIyMjIHNldCBzd2lwZSBldmVudFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5zZXRTd2lwZUV2ZW50ID0gZnVuY3Rpb24oKXtcbiAgXG4gIHRoaXMuJGl0ZW1zLmZpbmQoXCJhXCIpLmNsaWNrKGZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlfSk7XG4gIFxuICAvL3N3aXBlXG4gIGlmKCB0aGlzLm9wdHMuc3dpcGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub24oJ3RvdWNoc3RhcnQubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlU3RhcnQsIHRoaXMpKTtcbiAgfVxuICBcbiAgLy9kcmFnZ2FibGVcbiAgaWYoIHRoaXMub3B0cy5kcmFnZ2FibGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub24oJ21vdXNlZG93bi5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVTdGFydCwgdGhpcykpO1xuICB9XG59XG5cbi8qXG4jIyMjIHN3aXBlIHN0YXJ0XG4qL1xuXG5uQ2Fyb3VzZWwucHJvdG90eXBlLnN3aXBlU3RhcnQgPSBmdW5jdGlvbihldmVudCl7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGlmKCB0aGlzLmxvY2sgKSByZXR1cm4gZmFsc2U7XG4gIFxuICB2YXIgcG9zID0gUG9zaXRpb24oZXZlbnQpO1xuICB0aGlzLnRvdWNoU3RhcnRYID0gcG9zLng7XG4gIHRoaXMudG91Y2hNb3ZlWCA9IHBvcy54O1xuICB0aGlzLnRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQgPSBwYXJzZUludCggdGhpcy4kaXRlbXMuY3NzKCdtYXJnaW5MZWZ0JykgKTtcbiAgXG4gIC8vb24gbW92ZSAmIGVuZFxuICBpZiggdGhpcy5vcHRzLnN3aXBlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9uKCd0b3VjaG1vdmUubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlTW92ZSwgdGhpcykpO1xuICAgIHRoaXMuJGl0ZW1zLm9uKCd0b3VjaGVuZC5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVFbmQsIHRoaXMpKTtcbiAgICB0aGlzLiRpdGVtcy5vbigndG91Y2hjYW5jZWwubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlRW5kLCB0aGlzKSk7XG4gIH1cbiAgaWYoIHRoaXMub3B0cy5kcmFnZ2FibGUgKSB7XG4gICAgdGhpcy4kaXRlbXMub24oJ21vdXNlbW92ZS5uY2Fyb3VzZWwnLCAkLnByb3h5KHRoaXMuc3dpcGVNb3ZlLCB0aGlzKSk7XG4gICAgdGhpcy4kaXRlbXMub24oJ21vdXNldXAubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlRW5kLCB0aGlzKSk7XG4gICAgdGhpcy4kaXRlbXMub24oJ21vdXNlbGVhdmUubmNhcm91c2VsJywgJC5wcm94eSh0aGlzLnN3aXBlRW5kLCB0aGlzKSk7XG4gIH1cbn1cblxuLypcbiMjIyMgc3dpcGUgbW92ZVxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5zd2lwZU1vdmUgPSBmdW5jdGlvbihldmVudCl7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIHZhciBwb3MgPSBQb3NpdGlvbihldmVudCk7XG4gIHRoaXMudG91Y2hNb3ZlWCA9IHBvcy54O1xuICB2YXIgZGlmZlggPSB0aGlzLnRvdWNoTW92ZVggLSB0aGlzLnRvdWNoU3RhcnRYO1xuICB0aGlzLiRpdGVtcy5jc3MoJ21hcmdpbkxlZnQnLCB0aGlzLnRvdWNoU3RhcnRJdGVtc01hcmdpbkxlZnQgKyBkaWZmWCk7XG59XG5cbi8qXG4jIyMjIHN3aXBlIGVuZFxuKi9cblxubkNhcm91c2VsLnByb3RvdHlwZS5zd2lwZUVuZCA9IGZ1bmN0aW9uKGV2ZW50KXtcbiAgLy9vZmYgbW92ZSAmIGVuZFxuICBpZiggdGhpcy5vcHRzLnN3aXBlICkge1xuICAgIHRoaXMuJGl0ZW1zLm9mZigndG91Y2htb3ZlLm5jYXJvdXNlbCcpO1xuICAgIHRoaXMuJGl0ZW1zLm9mZigndG91Y2hlbmQubmNhcm91c2VsJyk7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCd0b3VjaGNhbmNlbC5uY2Fyb3VzZWwnKTtcbiAgfVxuICBpZiggdGhpcy5vcHRzLmRyYWdnYWJsZSApIHtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ21vdXNlbW92ZS5uY2Fyb3VzZWwnKTtcbiAgICB0aGlzLiRpdGVtcy5vZmYoJ21vdXNldXAubmNhcm91c2VsJyk7XG4gICAgdGhpcy4kaXRlbXMub2ZmKCdtb3VzZWxlYXZlLm5jYXJvdXNlbCcpO1xuICB9XG4gIFxuICB2YXIgcmVzdWx0ID0gdGhpcy5jdXJyZW50O1xuICBpZiggdGhpcy50b3VjaE1vdmVYIC0gdGhpcy50b3VjaFRocmVzaG9sZCA+IHRoaXMudG91Y2hTdGFydFggKSB7XG4gICAgcmVzdWx0ID0gdGhpcy5jdXJyZW50IC0gMTtcbiAgfSBlbHNlIGlmKCB0aGlzLnRvdWNoTW92ZVggKyB0aGlzLnRvdWNoVGhyZXNob2xkIDwgdGhpcy50b3VjaFN0YXJ0WCApIHtcbiAgICByZXN1bHQgPSB0aGlzLmN1cnJlbnQgKyAxO1xuICB9IGVsc2Uge1xuICAgIHZhciBocmVmID0gJChldmVudC50YXJnZXQpLmNsb3Nlc3QoXCJhXCIpLmF0dHIoXCJocmVmXCIpO1xuICAgIGlmKGhyZWYgIT0gdW5kZWZpbmVkKSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGhyZWY7XG4gICAgfVxuICB9XG4gIHRoaXMuYW5pbWF0aW9uKCByZXN1bHQgKTtcbiAgXG4gIC8vcmVzZXRcbiAgdGhpcy50b3VjaFN0YXJ0WCA9IC0xO1xuICB0aGlzLnRvdWNoTW92ZVggPSAtMTtcbiAgdGhpcy50b3VjaFN0YXJ0SXRlbXNNYXJnaW5MZWZ0ID0gLTE7XG59XG4iLCJ9KShqUXVlcnksIHRoaXMsIHRoaXMuZG9jdW1lbnQpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
